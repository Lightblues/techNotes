
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="O'ver curious">
      
      
        <meta name="author" content="Easonshi">
      
      
        <link rel="canonical" href="https://lightblues.github.io/techNotes/code/JavaScript/js-note/">
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.0, mkdocs-material-8.5.6">
    
    
      
        <title>js note - techNotes</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.20d9efc8.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.cbb835fc.min.css">
        
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="" data-md-color-accent="">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#javascript-note" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="techNotes" class="md-header__button md-logo" aria-label="techNotes" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            techNotes
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              js note
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="" data-md-color-accent=""  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
            </label>
          
        
          
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="" data-md-color-accent=""  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/lightblues/techNotes" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    lightblues/techNotes
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href="../../.." class="md-tabs__link">
      Home
    </a>
  </li>

      
        
  
  
    
  


  
  
  
    

  
  
  
    <li class="md-tabs__item">
      <a href="../../CS/git-note/" class="md-tabs__link md-tabs__link--active">
        Code
      </a>
    </li>
  

  

      
        
  
  


  
  
  
    

  
  
  
    <li class="md-tabs__item">
      <a href="../../../stat/" class="md-tabs__link">
        Stat
      </a>
    </li>
  

  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../Linux/Linux/" class="md-tabs__link">
        Linux
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../os/EFI/" class="md-tabs__link">
        OS
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../NLP/Lexicon-%E8%AF%8D%E6%B1%87%E5%A2%9E%E5%BC%BA/" class="md-tabs__link">
        NLP
      </a>
    </li>
  

      
        
  
  


  <li class="md-tabs__item">
    <a href="/" class="md-tabs__link">
      Blog
    </a>
  </li>

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="techNotes" class="md-nav__button md-logo" aria-label="techNotes" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    techNotes
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/lightblues/techNotes" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    lightblues/techNotes
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          Code
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Code" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Code
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_1" type="checkbox" id="__nav_2_1" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2_1">
          CS
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="CS" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_1">
          <span class="md-nav__icon md-icon"></span>
          CS
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../CS/git-note/" class="md-nav__link">
        Git
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_2" type="checkbox" id="__nav_2_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2_2">
          Python
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Python" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_2">
          <span class="md-nav__icon md-icon"></span>
          Python
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Python/Python-note/" class="md-nav__link">
        课程笔记
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
    
  
  
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_3" type="checkbox" id="__nav_2_3" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_2_3">
          JavaScripe
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="JavaScripe" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_3">
          <span class="md-nav__icon md-icon"></span>
          JavaScripe
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../js-mindmap/" class="md-nav__link">
        Mindmap
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          js note
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        js note
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#quick-start" class="md-nav__link">
    Quick Start
  </a>
  
    <nav class="md-nav" aria-label="Quick Start">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    数据类型和变量
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    字符串
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#js" class="md-nav__link">
    js 数组
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#js_1" class="md-nav__link">
    js 对象
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    条件判断
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_11" class="md-nav__link">
    循环
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#map-set" class="md-nav__link">
    Map 和 Set
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iterable" class="md-nav__link">
    iterable
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#js_2" class="md-nav__link">
    JS 函数
  </a>
  
    <nav class="md-nav" aria-label="JS 函数">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_12" class="md-nav__link">
    定义和调用
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_13" class="md-nav__link">
    变量作用域
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_17" class="md-nav__link">
    解构赋值
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_19" class="md-nav__link">
    方法
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#higher-order-function" class="md-nav__link">
    高阶函数 Higher-order function
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_21" class="md-nav__link">
    函数闭包
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_23" class="md-nav__link">
    箭头函数
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#generator" class="md-nav__link">
    generator
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_24" class="md-nav__link">
    标准对象
  </a>
  
    <nav class="md-nav" aria-label="标准对象">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#basic" class="md-nav__link">
    对象 basic
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#date" class="md-nav__link">
    Date
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#regexp" class="md-nav__link">
    RegExp
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#json" class="md-nav__link">
    JSON
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_33" class="md-nav__link">
    面向对象编程
  </a>
  
    <nav class="md-nav" aria-label="面向对象编程">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_34" class="md-nav__link">
    创建对象
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_37" class="md-nav__link">
    原型继承
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class" class="md-nav__link">
    class继承
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_38" class="md-nav__link">
    浏览器
  </a>
  
    <nav class="md-nav" aria-label="浏览器">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_39" class="md-nav__link">
    浏览器对象
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dom" class="md-nav__link">
    操作 DOM
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_40" class="md-nav__link">
    操作表单
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_41" class="md-nav__link">
    操作文件
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ajax" class="md-nav__link">
    AJAX
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#promise" class="md-nav__link">
    Promise
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#canvas" class="md-nav__link">
    Canvas
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_42" class="md-nav__link">
    错误处理
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#underscore" class="md-nav__link">
    underscore
  </a>
  
    <nav class="md-nav" aria-label="underscore">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#collections" class="md-nav__link">
    Collections
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#arrays" class="md-nav__link">
    Arrays
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#functions" class="md-nav__link">
    Functions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#object" class="md-nav__link">
    Object
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chaining" class="md-nav__link">
    Chaining
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../jQuery-note/" class="md-nav__link">
        jQuery
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../node-js-note/" class="md-nav__link">
        Node.js
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          Stat
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Stat" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Stat
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_1" type="checkbox" id="__nav_3_1" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3_1">
          高等统计学习
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="高等统计学习" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_1">
          <span class="md-nav__icon md-icon"></span>
          高等统计学习
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../stat/" class="md-nav__link">
        index
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../stat/ASL-mindmap/" class="md-nav__link">
        ASL mindmap
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../stat/ASL-note1/" class="md-nav__link">
        ASL1
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../stat/ASL-note2/" class="md-nav__link">
        ASL2
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../stat/ASL-note3/" class="md-nav__link">
        ASL3
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../stat/ASL-note4/" class="md-nav__link">
        ASL4
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_2" type="checkbox" id="__nav_3_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3_2">
          算法导论
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="算法导论" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_2">
          <span class="md-nav__icon md-icon"></span>
          算法导论
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../stat/Algo-MinCut-2SAT/" class="md-nav__link">
        basic
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../stat/Algo-prob-Markov-Chebyshev-Hoeffding/" class="md-nav__link">
        概率基础
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../stat/Algo-computation-%E8%AE%A1%E7%AE%97%E7%90%86%E8%AE%BA/" class="md-nav__link">
        计算理论
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../stat/Algo-graph-Adjacency-Laplacian/" class="md-nav__link">
        图相关, Laplacian
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../stat/Algo-differential-privacy-%E5%B7%AE%E5%88%86%E9%9A%90%E7%A7%81/" class="md-nav__link">
        差分隐私
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../stat/optimization-%E5%87%B8%E4%BC%98%E5%8C%96/" class="md-nav__link">
        凸优化
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          Linux
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Linux" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Linux
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Linux/Linux/" class="md-nav__link">
        General
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Linux/tutor-%E5%AE%9E%E9%AA%8C%E7%8E%AF%E5%A2%83%E7%9B%B8%E5%85%B3/" class="md-nav__link">
        实验环境相关
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Linux/Linux-maintain/" class="md-nav__link">
        系统维护
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Linux/Linux-configure-make-install-%E7%BC%96%E8%AF%91%E5%AE%89%E8%A3%85/" class="md-nav__link">
        编译安装软件
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_5">
          OS
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="OS" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          OS
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../os/EFI/" class="md-nav__link">
        EFI
      </a>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_2" type="checkbox" id="__nav_5_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_5_2">
          OSs
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="OSs" data-md-level="2">
        <label class="md-nav__title" for="__nav_5_2">
          <span class="md-nav__icon md-icon"></span>
          OSs
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../os/macOS/" class="md-nav__link">
        macOS
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../os/macOS-intro/" class="md-nav__link">
        macOS-intro
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../os/macOS-softwares/" class="md-nav__link">
        macOS 软件列表
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../os/Hackintosh/" class="md-nav__link">
        hackintosh
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../os/Arch/" class="md-nav__link">
        Arch
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../os/CentOS/" class="md-nav__link">
        CentOS
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../os/Ubuntu/" class="md-nav__link">
        Ubuntu
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../os/Windows/" class="md-nav__link">
        Windows
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_3" type="checkbox" id="__nav_5_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_5_3">
          softwares
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="softwares" data-md-level="2">
        <label class="md-nav__title" for="__nav_5_3">
          <span class="md-nav__icon md-icon"></span>
          softwares
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../0s/vscode.md" class="md-nav__link">
        VSCode
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" >
      
      
      
      
        <label class="md-nav__link" for="__nav_6">
          NLP
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="NLP" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          NLP
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../NLP/Lexicon-%E8%AF%8D%E6%B1%87%E5%A2%9E%E5%BC%BA/" class="md-nav__link">
        Lexicon 词汇增强
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../NLP/Prompt-%E6%8F%90%E7%A4%BA%E8%AF%AD%E8%A8%80%E6%A8%A1%E5%9E%8B/" class="md-nav__link">
        Prompt 提示语言模型
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../NLP/ABSA-Sentiment-Analysis-%E5%9F%BA%E4%BA%8E%E6%96%B9%E9%9D%A2%E7%9A%84%E6%83%85%E6%84%9F%E5%88%86%E6%9E%90/" class="md-nav__link">
        ABSA
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="/" class="md-nav__link">
        Blog
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#quick-start" class="md-nav__link">
    Quick Start
  </a>
  
    <nav class="md-nav" aria-label="Quick Start">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    数据类型和变量
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    字符串
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#js" class="md-nav__link">
    js 数组
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#js_1" class="md-nav__link">
    js 对象
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    条件判断
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_11" class="md-nav__link">
    循环
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#map-set" class="md-nav__link">
    Map 和 Set
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iterable" class="md-nav__link">
    iterable
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#js_2" class="md-nav__link">
    JS 函数
  </a>
  
    <nav class="md-nav" aria-label="JS 函数">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_12" class="md-nav__link">
    定义和调用
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_13" class="md-nav__link">
    变量作用域
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_17" class="md-nav__link">
    解构赋值
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_19" class="md-nav__link">
    方法
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#higher-order-function" class="md-nav__link">
    高阶函数 Higher-order function
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_21" class="md-nav__link">
    函数闭包
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_23" class="md-nav__link">
    箭头函数
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#generator" class="md-nav__link">
    generator
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_24" class="md-nav__link">
    标准对象
  </a>
  
    <nav class="md-nav" aria-label="标准对象">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#basic" class="md-nav__link">
    对象 basic
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#date" class="md-nav__link">
    Date
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#regexp" class="md-nav__link">
    RegExp
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#json" class="md-nav__link">
    JSON
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_33" class="md-nav__link">
    面向对象编程
  </a>
  
    <nav class="md-nav" aria-label="面向对象编程">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_34" class="md-nav__link">
    创建对象
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_37" class="md-nav__link">
    原型继承
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class" class="md-nav__link">
    class继承
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_38" class="md-nav__link">
    浏览器
  </a>
  
    <nav class="md-nav" aria-label="浏览器">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_39" class="md-nav__link">
    浏览器对象
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dom" class="md-nav__link">
    操作 DOM
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_40" class="md-nav__link">
    操作表单
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_41" class="md-nav__link">
    操作文件
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ajax" class="md-nav__link">
    AJAX
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#promise" class="md-nav__link">
    Promise
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#canvas" class="md-nav__link">
    Canvas
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_42" class="md-nav__link">
    错误处理
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#underscore" class="md-nav__link">
    underscore
  </a>
  
    <nav class="md-nav" aria-label="underscore">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#collections" class="md-nav__link">
    Collections
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#arrays" class="md-nav__link">
    Arrays
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#functions" class="md-nav__link">
    Functions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#object" class="md-nav__link">
    Object
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chaining" class="md-nav__link">
    Chaining
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  <a href="https://github.com/lightblues/techNotes/edit/main/docs/code/JavaScript/js-note.md" title="Edit this page" class="md-content__button md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"/></svg>
  </a>


<h1 id="javascript-note">JavaScript note<a class="headerlink" href="#javascript-note" title="Permanent link">&para;</a></h1>
<ul>
<li>廖雪峰 <a href="https://www.liaoxuefeng.com/wiki/1022910821149312/1023025235359040">https://www.liaoxuefeng.com/wiki/1022910821149312/1023025235359040</a></li>
<li>RUNOOB <a href="https://www.runoob.com/nodejs/nodejs-tutorial.html">https://www.runoob.com/nodejs/nodejs-tutorial.html</a></li>
</ul>
<p>其他</p>
<ul>
<li>Node.js 入门教程 <a href="http://nodejs.cn/learn">http://nodejs.cn/learn</a></li>
<li>npm 廖雪峰 <a href="http://www.ruanyifeng.com/blog/2016/01/npm-install.html">Npm 模块安装机制</a></li>
</ul>
<h2 id="quick-start">Quick Start<a class="headerlink" href="#quick-start" title="Permanent link">&para;</a></h2>
<ul>
<li>将 js 代码放在网页中, 或者专门的 js 文件中, 引入<ul>
<li>在 script tag 中专门写 type, 例如 <code>&lt;script type="text/javascript"&gt;</code>, 是没有必要的, 因为默认的type就是JavaScript</li>
</ul>
</li>
<li>使用 VSCode 编辑运行, 参见 <a href="https://www.youtube.com/watch?v=fBuNrCv3Irs">here</a></li>
<li>调试: 控制台(Console)<ul>
<li><code>console.log('Hello');</code></li>
</ul>
</li>
</ul>
<h3 id="_1">数据类型和变量<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h3>
<ul>
<li>Number<ul>
<li>JavaScript不区分整数和浮点数，统一用Number表示</li>
<li><code>NaN</code>, <code>Infinity</code></li>
</ul>
</li>
<li>字符串<ul>
<li>字符串是以单引号&rsquo;或双引号&rdquo;括起来的任意文本，比如&rsquo;abc&rsquo;，&rdquo;xyz&rdquo;等等</li>
</ul>
</li>
<li>布尔值<ul>
<li>&amp;&amp;, ||, <code>!</code></li>
</ul>
</li>
<li>比较运算符<ul>
<li><code>==</code> 比较，它会自动转换数据类型再比较</li>
<li><code>===</code> 比较，它不会自动转换数据类型，如果数据类型不一致，返回false，如果一致，再比较</li>
<li>isNaN(NaN)</li>
<li>浮点数比较 <code>Math.abs()</code></li>
</ul>
</li>
<li>null 和  undefined<ul>
<li>大多数情况下，我们都应该用null。undefined仅仅在判断函数参数是否传递的情况下有用。</li>
</ul>
</li>
<li>数组<ul>
<li>出于代码的可读性考虑，强烈建议直接使用[]。</li>
<li>当然也可以用 <code>new Array(1, 2, 3);</code></li>
</ul>
</li>
<li>对象<ul>
<li>JavaScript的对象是一组由键-值组成的无序集合. JavaScript对象的键都是字符串类型</li>
</ul>
</li>
<li>变量<ul>
<li>变量名是大小写英文、数字、$和_的组合，且不能用数字开头</li>
</ul>
</li>
<li>strict模式<ul>
<li>如果一个变量没有通过var申明就被使用，那么该变量就自动被申明为全局变量</li>
<li>为了修补JavaScript这一严重设计缺陷，ECMA 在后续规范中推出了strict模式，在strict模式下运行的JavaScript代码，强制通过var申明变量</li>
<li>尝试在 console 中运行 <code>'use strict';aa = 11;</code> 会报错</li>
</ul>
</li>
<li>类型判断<ul>
<li><code>typeof 76</code> 返回类型, <code>6.7 instanceof Number</code> 判断是否为该类型</li>
</ul>
</li>
<li>位运算<ul>
<li><code>&amp;, |, ^, ~</code></li>
<li><code>&lt;&lt;, &gt;&gt;, &gt;&gt;&gt;</code>, 其中 <code>&gt;&gt;&gt;</code> 为零填充右移, <code>&gt;&gt;</code> 是正常带符号的</li>
</ul>
</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="kd">var</span><span class="w"> </span><span class="nx">length</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">7</span><span class="p">;</span><span class="w">                             </span><span class="c1">// 数字</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">lastName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;Gates&quot;</span><span class="p">;</span><span class="w">                      </span><span class="c1">// 字符串</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">cars</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;Porsche&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Volvo&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;BMW&quot;</span><span class="p">];</span><span class="w">         </span><span class="c1">// 数组</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="nx">firstName</span><span class="o">:</span><span class="s2">&quot;Bill&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">lastName</span><span class="o">:</span><span class="s2">&quot;Gates&quot;</span><span class="p">};</span><span class="w">    </span><span class="c1">// 对象 </span><span class="w"></span>
</code></pre></div>
<h4 id="_2">比较运算符<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="kc">false</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span><span class="w"> </span><span class="c1">// true</span><span class="w"></span>
<span class="kc">false</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span><span class="w"> </span><span class="c1">// false，使用 === 不进行类型转换</span><span class="w"></span>

<span class="c1">// 注意特例 NaN</span><span class="w"></span>
<span class="kc">NaN</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="kc">NaN</span><span class="p">;</span><span class="w"> </span><span class="c1">// false</span><span class="w"></span>
<span class="nb">isNaN</span><span class="p">(</span><span class="kc">NaN</span><span class="p">);</span><span class="w"> </span><span class="c1">// true</span><span class="w"></span>

<span class="c1">// 浮点数比较</span><span class="w"></span>
<span class="mf">1</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">3</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="p">(</span><span class="mf">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">2</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">3</span><span class="p">);</span><span class="w"> </span><span class="c1">// false</span><span class="w"></span>
<span class="nb">Math</span><span class="p">.</span><span class="nx">abs</span><span class="p">(</span><span class="mf">1</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">3</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="mf">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">2</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">3</span><span class="p">))</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">0.0000001</span><span class="p">;</span><span class="w"> </span><span class="c1">// true</span><span class="w"></span>
</code></pre></div>
<h4 id="null-undefined">null, undefined<a class="headerlink" href="#null-undefined" title="Permanent link">&para;</a></h4>
<ul>
<li>null表示一个“空”的值，它和0以及空字符串&rsquo;&lsquo;不同，0是一个数值，&rsquo;&lsquo;表示长度为0的字符串，而null表示“空”。</li>
<li>在其他语言中，也有类似JavaScript的null的表示，例如Java也用null，Swift用nil，Python用None表示。但是，在JavaScript中，还有一个和null类似的undefined，它表示“未定义”。</li>
<li>JavaScript的设计者希望用null表示一个空的值，而<code>undefined</code>表示值未定义。事实证明，这并没有什么卵用，区分两者的意义不大。大多数情况下，我们都应该用n <code>ull</code>。<code>undefined</code> 仅仅在判断函数参数是否传递的情况下有用。</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="ow">typeof</span><span class="w"> </span><span class="kc">undefined</span><span class="w">              </span><span class="c1">// undefined</span><span class="w"></span>
<span class="ow">typeof</span><span class="w"> </span><span class="kc">null</span><span class="w">                   </span><span class="c1">// object</span><span class="w"></span>
<span class="kc">null</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="kc">undefined</span><span class="w">            </span><span class="c1">// false</span><span class="w"></span>
<span class="kc">null</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">undefined</span><span class="w">             </span><span class="c1">// true</span><span class="w"></span>
</code></pre></div>
<h4 id="_3">数组<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="ow">new</span><span class="w"> </span><span class="nb">Array</span><span class="p">(</span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="mf">2</span><span class="p">,</span><span class="w"> </span><span class="mf">3</span><span class="p">);</span><span class="w"> </span><span class="c1">// 创建了数组[1, 2, 3]</span><span class="w"></span>

<span class="kd">var</span><span class="w"> </span><span class="nx">arr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="mf">2</span><span class="p">,</span><span class="w"> </span><span class="mf">3.14</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Hello&#39;</span><span class="p">,</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w"> </span><span class="kc">true</span><span class="p">];</span><span class="w"></span>
<span class="nx">arr</span><span class="p">[</span><span class="mf">0</span><span class="p">];</span><span class="w"> </span><span class="c1">// 返回索引为0的元素，即1</span><span class="w"></span>
<span class="nx">arr</span><span class="p">[</span><span class="mf">5</span><span class="p">];</span><span class="w"> </span><span class="c1">// 返回索引为5的元素，即true</span><span class="w"></span>
<span class="nx">arr</span><span class="p">[</span><span class="mf">6</span><span class="p">];</span><span class="w"> </span><span class="c1">// 索引超出了范围，返回undefined</span><span class="w"></span>
</code></pre></div>
<h4 id="_4">对象<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="kd">var</span><span class="w"> </span><span class="nx">person</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Bob&#39;</span><span class="p">,</span><span class="w"></span>
<span class="w"> </span><span class="nx">age</span><span class="o">:</span><span class="w"> </span><span class="mf">20</span><span class="p">,</span><span class="w"></span>
<span class="w"> </span><span class="nx">tags</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s1">&#39;js&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;web&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;mobile&#39;</span><span class="p">],</span><span class="w"></span>
<span class="w"> </span><span class="nx">city</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Beijing&#39;</span><span class="p">,</span><span class="w"></span>
<span class="w"> </span><span class="nx">hasCar</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w"></span>
<span class="w"> </span><span class="nx">zipcode</span><span class="o">:</span><span class="w"> </span><span class="kc">null</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="nx">person</span><span class="p">.</span><span class="nx">name</span><span class="p">;</span><span class="w"> </span><span class="c1">// &#39;Bob&#39;</span><span class="w"></span>
<span class="nx">person</span><span class="p">.</span><span class="nx">zipcode</span><span class="p">;</span><span class="w"> </span><span class="c1">// null</span><span class="w"></span>
</code></pre></div>
<h4 id="_5">变量<a class="headerlink" href="#_5" title="Permanent link">&para;</a></h4>
<p>变量在JavaScript中就是用一个变量名表示，变量名是大小写英文、数字、$和_的组合，且不能用数字开头。变量名也不能是JavaScript的关键字，如if、while等。申明一个变量用var语句。</p>
<div class="highlight"><pre><span></span><code><span class="kd">var</span><span class="w"> </span><span class="nx">a</span><span class="p">;</span><span class="w"> </span><span class="c1">// 申明了变量a，此时a的值为undefined</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">$b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1</span><span class="p">;</span><span class="w"> </span><span class="c1">// 申明了变量$b，同时给$b赋值，此时$b的值为1</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">s_007</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;007&#39;</span><span class="p">;</span><span class="w"> </span><span class="c1">// s_007是一个字符串</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">Answer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span><span class="w"> </span><span class="c1">// Answer是一个布尔值true</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">t</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span><span class="w"> </span><span class="c1">// t的值是null</span><span class="w"></span>

<span class="c1">// 动态语言（Java 是静态的）</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">123</span><span class="p">;</span><span class="w"> </span><span class="c1">// a的值是整数123</span><span class="w"></span>
<span class="nx">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;ABC&#39;</span><span class="p">;</span><span class="w"> </span><span class="c1">// a变为字符串</span><span class="w"></span>
</code></pre></div>
<h3 id="_6">字符串<a class="headerlink" href="#_6" title="Permanent link">&para;</a></h3>
<p><a href="https://www.w3school.com.cn/jsref/jsref_obj_string.asp">JavaScript 字符串参考手册</a>。</p>
<ul>
<li>JavaScript的字符串就是用&rsquo;&lsquo;或&rdquo;&ldquo;括起来的字符表示<ul>
<li>ASCII字符可以以 <code>\x##</code> 形式的十六进制表示</li>
<li>还可以用 <code>\u####</code> 表示一个Unicode字符</li>
</ul>
</li>
<li>ES6标准新增了一种多行字符串的表示方法，用反引号 `&hellip;` 表示</li>
<li>模板字符串, <code>${name}</code> 引用变量, 注意需要 ES6 的反引号语法</li>
<li>操作字符串<ul>
<li>注意字符串不可变, 也即 <code>s[0] = 'X';</code> 不影响 s</li>
<li>toUpperCase, toLowerCase</li>
<li>indexOf</li>
<li>substring</li>
</ul>
</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="s1">&#39;I\&#39;m \&quot;OK\&quot;!&#39;</span><span class="p">;</span><span class="w"></span>
<span class="s1">&#39;\x41&#39;</span><span class="p">;</span><span class="w"> </span><span class="c1">// 完全等同于 &#39;A&#39;</span><span class="w"></span>
<span class="s1">&#39;\u4e2d\u6587&#39;</span><span class="p">;</span><span class="w"> </span><span class="c1">// 完全等同于 &#39;中文&#39;</span><span class="w"></span>

<span class="c1">// 多行字符串</span><span class="w"></span>
<span class="sb">`这是一个</span>
<span class="sb">多行</span>
<span class="sb">字符串`</span><span class="p">;</span><span class="w"></span>
</code></pre></div>
<h4 id="_7">模板字符串<a class="headerlink" href="#_7" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="kd">var</span><span class="w"> </span><span class="nx">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;小明&#39;</span><span class="p">;</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">age</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">20</span><span class="p">;</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">message</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sb">`你好, </span><span class="si">${</span><span class="nx">name</span><span class="si">}</span><span class="sb">, 你今年</span><span class="si">${</span><span class="nx">age</span><span class="si">}</span><span class="sb">岁了!`</span><span class="p">;</span><span class="w">  </span><span class="c1">// 注意一定要是 `` 格式的字符串才支持</span><span class="w"></span>
<span class="nx">alert</span><span class="p">(</span><span class="nx">message</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1">// str.length 属性</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Hello, world!&#39;</span><span class="p">;</span><span class="w"></span>
<span class="nx">s</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="w"> </span><span class="c1">// 13</span><span class="w"></span>

<span class="c1">//引用</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Hello, world!&#39;</span><span class="p">;</span><span class="w"></span>
<span class="nx">s</span><span class="p">[</span><span class="mf">0</span><span class="p">];</span><span class="w"> </span><span class="c1">// &#39;H&#39;</span><span class="w"></span>
<span class="nx">s</span><span class="p">[</span><span class="mf">6</span><span class="p">];</span><span class="w"> </span><span class="c1">// &#39; &#39;</span><span class="w"></span>
<span class="nx">s</span><span class="p">[</span><span class="mf">7</span><span class="p">];</span><span class="w"> </span><span class="c1">// &#39;w&#39;</span><span class="w"></span>
<span class="nx">s</span><span class="p">[</span><span class="mf">12</span><span class="p">];</span><span class="w"> </span><span class="c1">// &#39;!&#39;</span><span class="w"></span>
<span class="nx">s</span><span class="p">[</span><span class="mf">13</span><span class="p">];</span><span class="w"> </span><span class="c1">// undefined 超出范围的索引不会报错，但一律返回undefined</span><span class="w"></span>

<span class="c1">// 字符串不可变，但对其赋值不会报错</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Test&#39;</span><span class="p">;</span><span class="w"></span>
<span class="nx">s</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;X&#39;</span><span class="p">;</span><span class="w"></span>
<span class="nx">alert</span><span class="p">(</span><span class="nx">s</span><span class="p">);</span><span class="w"> </span><span class="c1">// s仍然为&#39;Test&#39;</span><span class="w"></span>

<span class="c1">// toUpperCase, toLowerCase</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Hello&#39;</span><span class="p">;</span><span class="w"></span>
<span class="nx">s</span><span class="p">.</span><span class="nx">toUpperCase</span><span class="p">();</span><span class="w"> </span><span class="c1">// 返回&#39;HELLO&#39;</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">lower</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">s</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">();</span><span class="w"> </span><span class="c1">// 返回&#39;hello&#39;并赋值给变量lower</span><span class="w"></span>

<span class="c1">// indexOf</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;hello, world&#39;</span><span class="p">;</span><span class="w"></span>
<span class="nx">s</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s1">&#39;world&#39;</span><span class="p">);</span><span class="w"> </span><span class="c1">// 返回7</span><span class="w"></span>
<span class="nx">s</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s1">&#39;World&#39;</span><span class="p">);</span><span class="w"> </span><span class="c1">// 没有找到指定的子串，返回-1</span><span class="w"></span>
</code></pre></div>
<h4 id="substring-substr">substring(), substr()<a class="headerlink" href="#substring-substr" title="Permanent link">&para;</a></h4>
<p>substr 和 substring 的区别之处在于第二个参数是想要得到的子串的长度。</p>
<div class="highlight"><pre><span></span><code><span class="c1">// substring</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;hello, world&#39;</span><span class="w"></span>
<span class="nx">s</span><span class="p">.</span><span class="nx">substring</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="mf">5</span><span class="p">);</span><span class="w"> </span><span class="c1">// 从索引0开始到5（不包括5），返回&#39;hello&#39;</span><span class="w"></span>
<span class="nx">s</span><span class="p">.</span><span class="nx">substring</span><span class="p">(</span><span class="mf">7</span><span class="p">);</span><span class="w"> </span><span class="c1">// 从索引7开始到结束，返回&#39;world&#39;</span><span class="w"></span>
</code></pre></div>
<h4 id="replace">replace()<a class="headerlink" href="#replace" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="c1">// 默认匹配一个</span><span class="w"></span>
<span class="nx">str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;Please visit Microsoft and Microsoft!&quot;</span><span class="p">;</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">str</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="s2">&quot;Microsoft&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;W3School&quot;</span><span class="p">);</span><span class="w"></span>

<span class="c1">// 忽略大小写</span><span class="w"></span>
<span class="nx">str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;Please visit Microsoft!&quot;</span><span class="p">;</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">str</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/MICROSOFT/i</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;W3School&quot;</span><span class="p">);</span><span class="w"></span>

<span class="c1">// 替换所有匹配</span><span class="w"></span>
<span class="nx">str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;Please visit Microsoft and Microsoft!&quot;</span><span class="p">;</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">str</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/Microsoft/g</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;W3School&quot;</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p>您将在 JavaScript 正则表达式这一章学到更多有关<a href="https://www.w3school.com.cn/js/js_regexp.asp">正则表达式</a>的内容。</p>
<h4 id="trim">trim()<a class="headerlink" href="#trim" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="kd">var</span><span class="w"> </span><span class="nx">str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;       Hello World!        &quot;</span><span class="p">;</span><span class="w"></span>
<span class="nx">alert</span><span class="p">(</span><span class="nx">str</span><span class="p">.</span><span class="nx">trim</span><span class="p">());</span><span class="w"></span>
</code></pre></div>
<p>警告：Internet Explorer 8 或更低版本不支持 trim() 方法。
如需支持 IE 8，您可搭配正则表达式使用 replace() 方法代替。
您还可以使用上面的 replace 方案把 trim 函数添加到 JavaScript <code>String.prototype</code>。</p>
<div class="highlight"><pre><span></span><code><span class="kd">var</span><span class="w"> </span><span class="nx">str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;       Hello World!        &quot;</span><span class="p">;</span><span class="w"></span>
<span class="nx">alert</span><span class="p">(</span><span class="nx">str</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">));</span><span class="w"></span>


<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nb">String</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">trim</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="nb">String</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">trim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">);</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;       Hello World!        &quot;</span><span class="p">;</span><span class="w"></span>
<span class="nx">alert</span><span class="p">(</span><span class="nx">str</span><span class="p">.</span><span class="nx">trim</span><span class="p">());</span><span class="w"></span>
</code></pre></div>
<h4 id="property-access">属性访问（Property Access）<a class="headerlink" href="#property-access" title="Permanent link">&para;</a></h4>
<p>ECMAScript 5 (2009) 允许对字符串的属性访问 [ ]：</p>
<p>使用属性访问有点不太靠谱：</p>
<ul>
<li>不适用 Internet Explorer 7 或更早的版本</li>
<li>它让字符串看起来像是数组（其实并不是）</li>
<li>如果找不到字符，[ ] 返回 undefined，而 charAt() 返回空字符串。</li>
<li>它是只读的。str[0] = &ldquo;A&rdquo; 不会产生错误（但也不会工作！）</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="kd">var</span><span class="w"> </span><span class="nx">str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;HELLO WORLD&quot;</span><span class="p">;</span><span class="w"></span>
<span class="nx">str</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;A&quot;</span><span class="p">;</span><span class="w">             </span><span class="c1">// 不产生错误，但不会工作</span><span class="w"></span>
<span class="nx">str</span><span class="p">[</span><span class="mf">0</span><span class="p">];</span><span class="w">                   </span><span class="c1">// 返回 H</span><span class="w"></span>
</code></pre></div>
<h4 id="split">split()<a class="headerlink" href="#split" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="kd">var</span><span class="w"> </span><span class="nx">txt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;Hello&quot;</span><span class="p">;</span><span class="w">       </span><span class="c1">// 字符串</span><span class="w"></span>
<span class="nx">txt</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">);</span><span class="w">           </span><span class="c1">// 分隔为字符</span><span class="w"></span>
</code></pre></div>
<h3 id="js">js 数组<a class="headerlink" href="#js" title="Permanent link">&para;</a></h3>
<ul>
<li>JavaScript的 <code>Array</code> 可以包含任意数据类型，并通过索引来访问每个元素。<ul>
<li>直接给Array的length赋一个新的值会导致Array大小的变化</li>
<li>如果通过索引赋值时，索引超过了范围，同样会引起Array大小的变化</li>
</ul>
</li>
<li><code>includes</code> 判断是否包含</li>
<li><code>indexOf</code> 也可以, 若找不到返回 -1</li>
<li>slice<ul>
<li>slice()就是对应String的substring()版本</li>
<li>如果不给slice()传递任何参数，它就会从头到尾截取所有元素。利用这一点，我们可以很容易地 <strong>复制</strong> 一个Array</li>
</ul>
</li>
<li><code>push</code> 和 pop; <code>unshift</code> 和 shift<ul>
<li><code>a.unshift("a", "b");</code> 传入多个元素, 若要拼接两个数组, 用 concat</li>
</ul>
</li>
<li>sort<ul>
<li>原地修改</li>
</ul>
</li>
<li>reverse 反转</li>
<li>splice<ul>
<li>splice()方法是修改Array的“万能方法”，它可以从指定的索引开始删除若干元素，然后再从该位置添加若干元素</li>
<li>例如, <code>arr.splice(2, 3, 'Google', 'Facebook');</code> 表示 从索引2开始删除3个元素,然后再添加两个元素</li>
</ul>
</li>
<li>concat<ul>
<li>请注意，concat()方法并没有修改当前Array，而是返回了一个新的Array。</li>
<li>concat()方法可以接收任意个元素和Array，并且自动把Array拆开，然后全部添加到新的Array里, 例如 <code>arr.concat(1, 2, [3, 4]); // ['A', 'B', 'C', 1, 2, 3, 4]</code></li>
</ul>
</li>
<li>join<ul>
<li>把当前Array的每个元素都用指定的字符串连接起来，然后返回连接后的字符串; 如果Array的元素不是字符串，将自动转换为字符串后再连接。</li>
</ul>
</li>
</ul>
<h4 id="base">base<a class="headerlink" href="#base" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="c1">// 直接给Array的length赋一个新的值会导致Array大小的变化</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">arr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="mf">2</span><span class="p">,</span><span class="w"> </span><span class="mf">3</span><span class="p">];</span><span class="w"></span>
<span class="nx">arr</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="w"> </span><span class="c1">// 3</span><span class="w"></span>
<span class="nx">arr</span><span class="p">.</span><span class="nx">length</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">6</span><span class="p">;</span><span class="w"></span>
<span class="nx">arr</span><span class="p">;</span><span class="w"> </span><span class="c1">// arr变为[1, 2, 3, undefined, undefined, undefined]</span><span class="w"></span>
<span class="nx">arr</span><span class="p">.</span><span class="nx">length</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2</span><span class="p">;</span><span class="w"></span>
<span class="nx">arr</span><span class="p">;</span><span class="w"> </span><span class="c1">// arr变为[1, 2]</span><span class="w"></span>

<span class="c1">// 如果通过索引赋值时，索引超过了范围，同样会引起Array大小的变化</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">arr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="mf">2</span><span class="p">,</span><span class="w"> </span><span class="mf">3</span><span class="p">];</span><span class="w"></span>
<span class="nx">arr</span><span class="p">[</span><span class="mf">5</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;x&#39;</span><span class="p">;</span><span class="w"></span>
<span class="nx">arr</span><span class="p">;</span><span class="w"> </span><span class="c1">// arr变为[1, 2, 3, undefined, undefined, &#39;x&#39;]</span><span class="w"></span>
</code></pre></div>
<h4 id="foreach">遍历 forEach<a class="headerlink" href="#foreach" title="Permanent link">&para;</a></h4>
<p>可以通过 for 循环或者调用 <code>forEach(func)</code> 方法。</p>
<div class="highlight"><pre><span></span><code><span class="kd">function</span><span class="w"> </span><span class="nx">showList</span><span class="p">(){</span><span class="w"></span>
<span class="w"> </span><span class="kd">let</span><span class="w"> </span><span class="nx">fruits</span><span class="p">,</span><span class="w"> </span><span class="nx">text</span><span class="p">,</span><span class="w"> </span><span class="nx">fLen</span><span class="p">,</span><span class="w"> </span><span class="nx">i</span><span class="p">;</span><span class="w"></span>
<span class="w"> </span><span class="nx">fruits</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s1">&#39;banana&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;orange&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;apple&#39;</span><span class="p">];</span><span class="w"></span>
<span class="w"> </span><span class="nx">fLen</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">fruits</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="w"></span>
<span class="w"> </span><span class="nx">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;&lt;ul&gt;&#39;</span><span class="w"></span>
<span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="nx">i</span><span class="o">=</span><span class="mf">0</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">&lt;</span><span class="nx">fLen</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="nx">text</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="s2">&quot;&lt;li&gt;&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">fruits</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;&lt;/li&gt;&#39;</span><span class="p">;</span><span class="w"></span>
<span class="w"> </span><span class="p">}</span><span class="w"></span>
<span class="w"> </span><span class="nx">text</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="s1">&#39;&lt;/ul&gt;&#39;</span><span class="p">;</span><span class="w"></span>
<span class="w"> </span><span class="c1">// console.log(text);</span><span class="w"></span>
<span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;demo&#39;</span><span class="p">).</span><span class="nx">innerHTML</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">text</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kd">function</span><span class="w"> </span><span class="nx">showList2</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="kd">let</span><span class="w"> </span><span class="nx">fruits</span><span class="p">,</span><span class="w"> </span><span class="nx">text</span><span class="p">;</span><span class="w"></span>
<span class="w"> </span><span class="nx">fruits</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;Banana&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Orange&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Apple&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Mango&quot;</span><span class="p">];</span><span class="w"></span>

<span class="w"> </span><span class="nx">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;&lt;ul&gt;&#39;</span><span class="p">;</span><span class="w"></span>
<span class="w"> </span><span class="nx">fruits</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">foo</span><span class="p">);</span><span class="w"></span>
<span class="w"> </span><span class="nx">text</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="s1">&#39;&lt;/ul&gt;&#39;</span><span class="p">;</span><span class="w"></span>

<span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">foo</span><span class="p">(</span><span class="nx">value</span><span class="p">){</span><span class="w"></span>
<span class="w">  </span><span class="nx">text</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="s1">&#39;&lt;li&gt;&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">value</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;&lt;/li&gt;&#39;</span><span class="p">;</span><span class="w"></span>
<span class="w"> </span><span class="p">}</span><span class="w"></span>

<span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;demo&#39;</span><span class="p">).</span><span class="nx">innerHTML</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">text</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<h4 id="push-pop-unshift-shift">push(), pop(), unshift(), shift()<a class="headerlink" href="#push-pop-unshift-shift" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="c1">// push pop</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">arr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="mf">2</span><span class="p">];</span><span class="w"></span>
<span class="nx">arr</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;B&#39;</span><span class="p">);</span><span class="w"> </span><span class="c1">// 返回Array新的长度: 4</span><span class="w"></span>
<span class="nx">arr</span><span class="p">;</span><span class="w"> </span><span class="c1">// [1, 2, &#39;A&#39;, &#39;B&#39;]</span><span class="w"></span>
<span class="nx">arr</span><span class="p">.</span><span class="nx">pop</span><span class="p">();</span><span class="w"> </span><span class="c1">// pop()返回&#39;B&#39;</span><span class="w"></span>
<span class="nx">arr</span><span class="p">;</span><span class="w"> </span><span class="c1">// [1, 2, &#39;A&#39;]</span><span class="w"></span>
<span class="nx">arr</span><span class="p">.</span><span class="nx">pop</span><span class="p">();</span><span class="w"> </span><span class="nx">arr</span><span class="p">.</span><span class="nx">pop</span><span class="p">();</span><span class="w"> </span><span class="nx">arr</span><span class="p">.</span><span class="nx">pop</span><span class="p">();</span><span class="w"> </span><span class="c1">// 连续pop 3次</span><span class="w"></span>
<span class="nx">arr</span><span class="p">;</span><span class="w"> </span><span class="c1">// []</span><span class="w"></span>
<span class="nx">arr</span><span class="p">.</span><span class="nx">pop</span><span class="p">();</span><span class="w"> </span><span class="c1">// 空数组继续pop不会报错，而是返回undefined</span><span class="w"></span>
<span class="nx">arr</span><span class="p">;</span><span class="w"> </span><span class="c1">// []</span><span class="w"></span>


<span class="c1">// unshift shift 类似 push 和 pop 不过是数组前面</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">arr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="mf">2</span><span class="p">];</span><span class="w"></span>
<span class="nx">arr</span><span class="p">.</span><span class="nx">unshift</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;B&#39;</span><span class="p">);</span><span class="w"> </span><span class="c1">// 返回Array新的长度: 4</span><span class="w"></span>
<span class="nx">arr</span><span class="p">;</span><span class="w"> </span><span class="c1">// [&#39;A&#39;, &#39;B&#39;, 1, 2]</span><span class="w"></span>
<span class="nx">arr</span><span class="p">.</span><span class="nx">shift</span><span class="p">();</span><span class="w"> </span><span class="c1">// &#39;A&#39;</span><span class="w"></span>
<span class="nx">arr</span><span class="p">;</span><span class="w"> </span><span class="c1">// [&#39;B&#39;, 1, 2]</span><span class="w"></span>
<span class="nx">arr</span><span class="p">.</span><span class="nx">shift</span><span class="p">();</span><span class="w"> </span><span class="nx">arr</span><span class="p">.</span><span class="nx">shift</span><span class="p">();</span><span class="w"> </span><span class="nx">arr</span><span class="p">.</span><span class="nx">shift</span><span class="p">();</span><span class="w"> </span><span class="c1">// 连续shift 3次</span><span class="w"></span>
<span class="nx">arr</span><span class="p">;</span><span class="w"> </span><span class="c1">// []</span><span class="w"></span>
<span class="nx">arr</span><span class="p">.</span><span class="nx">shift</span><span class="p">();</span><span class="w"> </span><span class="c1">// 空数组继续shift不会报错，而是返回undefined</span><span class="w"></span>
<span class="nx">arr</span><span class="p">;</span><span class="w"> </span><span class="c1">// []</span><span class="w"></span>
</code></pre></div>
<h4 id="tostring-join">toString(), join()<a class="headerlink" href="#tostring-join" title="Permanent link">&para;</a></h4>
<p>toString() 用逗号分割
而 join() 的参数指定连接的方式。</p>
<div class="highlight"><pre><span></span><code><span class="c1">// join 支持自动转换</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">arr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;C&#39;</span><span class="p">,</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="mf">2</span><span class="p">,</span><span class="w"> </span><span class="mf">3</span><span class="p">];</span><span class="w"></span>
<span class="nx">arr</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">);</span><span class="w"> </span><span class="c1">// &#39;A-B-C-1-2-3&#39;</span><span class="w"></span>
</code></pre></div>
<h4 id="splice">splice() 添加、删除<a class="headerlink" href="#splice" title="Permanent link">&para;</a></h4>
<p><code>splice()</code> 方法是修改Array的“万能方法”，它可以从指定的索引开始删除若干元素，然后再从该位置添加若干元素</p>
<div class="highlight"><pre><span></span><code><span class="c1">// splice</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">arr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s1">&#39;Microsoft&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Apple&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Yahoo&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;AOL&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Excite&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Oracle&#39;</span><span class="p">];</span><span class="w"></span>
<span class="c1">// 从索引2开始删除3个元素,然后再添加两个元素:</span><span class="w"></span>
<span class="nx">arr</span><span class="p">.</span><span class="nx">splice</span><span class="p">(</span><span class="mf">2</span><span class="p">,</span><span class="w"> </span><span class="mf">3</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Google&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Facebook&#39;</span><span class="p">);</span><span class="w"> </span><span class="c1">// 返回删除的元素 [&#39;Yahoo&#39;, &#39;AOL&#39;, &#39;Excite&#39;]</span><span class="w"></span>
<span class="nx">arr</span><span class="p">;</span><span class="w"> </span><span class="c1">// [&#39;Microsoft&#39;, &#39;Apple&#39;, &#39;Google&#39;, &#39;Facebook&#39;, &#39;Oracle&#39;]</span><span class="w"></span>


<span class="c1">// 只删除,不添加:</span><span class="w"></span>
<span class="nx">arr</span><span class="p">.</span><span class="nx">splice</span><span class="p">(</span><span class="mf">2</span><span class="p">,</span><span class="w"> </span><span class="mf">2</span><span class="p">);</span><span class="w"> </span><span class="c1">// [&#39;Google&#39;, &#39;Facebook&#39;]</span><span class="w"></span>
<span class="nx">arr</span><span class="p">;</span><span class="w"> </span><span class="c1">// [&#39;Microsoft&#39;, &#39;Apple&#39;, &#39;Oracle&#39;]</span><span class="w"></span>


<span class="c1">// 只添加,不删除:</span><span class="w"></span>
<span class="nx">arr</span><span class="p">.</span><span class="nx">splice</span><span class="p">(</span><span class="mf">2</span><span class="p">,</span><span class="w"> </span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Google&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Facebook&#39;</span><span class="p">);</span><span class="w"> </span><span class="c1">// 返回[],因为没有删除任何元素</span><span class="w"></span>
<span class="nx">arr</span><span class="p">;</span><span class="w"> </span><span class="c1">// [&#39;Microsoft&#39;, &#39;Apple&#39;, &#39;Google&#39;, &#39;Facebook&#39;, &#39;Oracle&#39;]</span><span class="w"></span>
</code></pre></div>
<h4 id="slice">slice()<a class="headerlink" href="#slice" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="c1">// slice 就是 String 的 substring 方法</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">arr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;C&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;D&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;E&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;F&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;G&#39;</span><span class="p">];</span><span class="w"></span>
<span class="nx">arr</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="mf">3</span><span class="p">);</span><span class="w"> </span><span class="c1">// 从索引0开始，到索引3结束，但不包括索引3: [&#39;A&#39;, &#39;B&#39;, &#39;C&#39;]</span><span class="w"></span>
<span class="nx">arr</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="mf">3</span><span class="p">);</span><span class="w"> </span><span class="c1">// 从索引3开始到结束: [&#39;D&#39;, &#39;E&#39;, &#39;F&#39;, &#39;G&#39;]</span><span class="w"></span>


<span class="kd">var</span><span class="w"> </span><span class="nx">arr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;C&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;D&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;E&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;F&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;G&#39;</span><span class="p">];</span><span class="w">  </span><span class="c1">// 利用 slice 进行复制</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">aCopy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">arr</span><span class="p">.</span><span class="nx">slice</span><span class="p">();</span><span class="w"></span>
<span class="nx">aCopy</span><span class="p">;</span><span class="w"> </span><span class="c1">// [&#39;A&#39;, &#39;B&#39;, &#39;C&#39;, &#39;D&#39;, &#39;E&#39;, &#39;F&#39;, &#39;G&#39;]</span><span class="w"></span>
<span class="nx">aCopy</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="nx">arr</span><span class="p">;</span><span class="w"> </span><span class="c1">// false</span><span class="w"></span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1">// indexOf</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">arr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">10</span><span class="p">,</span><span class="w"> </span><span class="mf">20</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;30&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;xyz&#39;</span><span class="p">];</span><span class="w"></span>
<span class="nx">arr</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="mf">10</span><span class="p">);</span><span class="w"> </span><span class="c1">// 元素10的索引为0</span><span class="w"></span>
<span class="nx">arr</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="mf">20</span><span class="p">);</span><span class="w"> </span><span class="c1">// 元素20的索引为1</span><span class="w"></span>
<span class="nx">arr</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="mf">30</span><span class="p">);</span><span class="w"> </span><span class="c1">// 元素30没有找到，返回-1</span><span class="w"></span>
<span class="nx">arr</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s1">&#39;30&#39;</span><span class="p">);</span><span class="w"> </span><span class="c1">// 元素&#39;30&#39;的索引为2</span><span class="w"></span>
</code></pre></div>
<h4 id="sort-reverse">sort(), reverse()<a class="headerlink" href="#sort-reverse" title="Permanent link">&para;</a></h4>
<p>sort() 方法以字母顺序对数组进行排序。
reverse() 方法反转数组中的元素。【注意是原地反转】</p>
<div class="highlight"><pre><span></span><code><span class="c1">// sort</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">arr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;C&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;A&#39;</span><span class="p">];</span><span class="w"></span>
<span class="nx">arr</span><span class="p">.</span><span class="nx">sort</span><span class="p">();</span><span class="w"></span>
<span class="nx">arr</span><span class="p">;</span><span class="w"> </span><span class="c1">// [&#39;A&#39;, &#39;B&#39;, &#39;C&#39;]，默认升序</span><span class="w"></span>

<span class="c1">// reverse </span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">arr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s1">&#39;one&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;two&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;three&#39;</span><span class="p">];</span><span class="w"></span>
<span class="nx">arr</span><span class="p">.</span><span class="nx">reverse</span><span class="p">();</span><span class="w"> </span>
<span class="nx">arr</span><span class="p">;</span><span class="w"> </span><span class="c1">// [&#39;three&#39;, &#39;two&#39;, &#39;one&#39;]</span><span class="w"></span>
</code></pre></div>
<h5 id="_8">比值函数<a class="headerlink" href="#_8" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code><span class="kd">var</span><span class="w"> </span><span class="nx">points</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">40</span><span class="p">,</span><span class="w"> </span><span class="mf">100</span><span class="p">,</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="mf">5</span><span class="p">,</span><span class="w"> </span><span class="mf">25</span><span class="p">,</span><span class="w"> </span><span class="mf">10</span><span class="p">];</span><span class="w"></span>
<span class="nx">points</span><span class="p">.</span><span class="nx">sort</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="w"> </span><span class="nx">b</span><span class="p">){</span><span class="k">return</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">b</span><span class="p">});</span><span class="w"> </span>
</code></pre></div>
<p>比较函数应该返回一个负，零或正值，这取决于参数。
当 sort() 函数比较两个值时，会将值发送到比较函数，并根据所返回的值（负、零或正值）对这些值进行排序。
当比较 40 和 100 时，sort() 方法会调用比较函数 function(40,100)。该函数计算 40-100，然后返回 -60（负值）。排序函数将把 40 排序为比 100 更低的值。</p>
<div class="highlight"><pre><span></span><code><span class="c1">// 随机排序数组</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">points</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">40</span><span class="p">,</span><span class="w"> </span><span class="mf">100</span><span class="p">,</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="mf">5</span><span class="p">,</span><span class="w"> </span><span class="mf">25</span><span class="p">,</span><span class="w"> </span><span class="mf">10</span><span class="p">];</span><span class="w"></span>
<span class="nx">points</span><span class="p">.</span><span class="nx">sort</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="w"> </span><span class="nx">b</span><span class="p">){</span><span class="k">return</span><span class="w"> </span><span class="mf">0.5</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()});</span><span class="w"> </span>


<span class="c1">// 查找最大/最小。可采用下面的两种 sort</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">points</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">40</span><span class="p">,</span><span class="w"> </span><span class="mf">100</span><span class="p">,</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="mf">5</span><span class="p">,</span><span class="w"> </span><span class="mf">25</span><span class="p">,</span><span class="w"> </span><span class="mf">10</span><span class="p">];</span><span class="w"></span>
<span class="nx">points</span><span class="p">.</span><span class="nx">sort</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="w"> </span><span class="nx">b</span><span class="p">){</span><span class="k">return</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">b</span><span class="p">});</span><span class="w"></span>
<span class="c1">// 现在 points[0] 包含最低值</span><span class="w"></span>
<span class="c1">// 而 points[points.length-1] 包含最高值</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">points</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">40</span><span class="p">,</span><span class="w"> </span><span class="mf">100</span><span class="p">,</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="mf">5</span><span class="p">,</span><span class="w"> </span><span class="mf">25</span><span class="p">,</span><span class="w"> </span><span class="mf">10</span><span class="p">];</span><span class="w"></span>
<span class="nx">points</span><span class="p">.</span><span class="nx">sort</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="w"> </span><span class="nx">b</span><span class="p">){</span><span class="k">return</span><span class="w"> </span><span class="nx">b</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">a</span><span class="p">});</span><span class="w"></span>
<span class="c1">// 现在 points[0] 包含最高值</span><span class="w"></span>
<span class="c1">// 而 points[points.length-1] 包含最低值</span><span class="w"></span>
</code></pre></div>
<h5 id="mathmax">使用 Math.max()<a class="headerlink" href="#mathmax" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code><span class="kd">var</span><span class="w"> </span><span class="nx">arr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">40</span><span class="p">,</span><span class="w"> </span><span class="mf">100</span><span class="p">,</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="mf">5</span><span class="p">,</span><span class="w"> </span><span class="mf">25</span><span class="p">,</span><span class="w"> </span><span class="mf">10</span><span class="p">];</span><span class="w"></span>
<span class="kd">function</span><span class="w"> </span><span class="nx">myArrayMax</span><span class="p">(</span><span class="nx">arr</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span><span class="w"> </span><span class="nx">arr</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<h5 id="_9">自己写<a class="headerlink" href="#_9" title="Permanent link">&para;</a></h5>
<p>当然，自己实现的效率更高</p>
<div class="highlight"><pre><span></span><code><span class="kd">function</span><span class="w"> </span><span class="nx">myArrayMax</span><span class="p">(</span><span class="nx">arr</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="kd">var</span><span class="w"> </span><span class="nx">len</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">arr</span><span class="p">.</span><span class="nx">length</span><span class="w"></span>
<span class="w"> </span><span class="kd">var</span><span class="w"> </span><span class="nx">max</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="kc">Infinity</span><span class="p">;</span><span class="w"></span>
<span class="w"> </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="nx">len</span><span class="o">--</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">arr</span><span class="p">[</span><span class="nx">len</span><span class="p">]</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="nx">max</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">   </span><span class="nx">max</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">arr</span><span class="p">[</span><span class="nx">len</span><span class="p">];</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="w"> </span><span class="p">}</span><span class="w"></span>
<span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="nx">max</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<h4 id="map">map<a class="headerlink" href="#map" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="c1">// map</span><span class="w"></span>
<span class="kd">function</span><span class="w"> </span><span class="nx">pow</span><span class="p">(</span><span class="nx">x</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="nx">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">x</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kd">var</span><span class="w"> </span><span class="nx">arr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="mf">2</span><span class="p">,</span><span class="w"> </span><span class="mf">3</span><span class="p">,</span><span class="w"> </span><span class="mf">4</span><span class="p">,</span><span class="w"> </span><span class="mf">5</span><span class="p">,</span><span class="w"> </span><span class="mf">6</span><span class="p">,</span><span class="w"> </span><span class="mf">7</span><span class="p">,</span><span class="w"> </span><span class="mf">8</span><span class="p">,</span><span class="w"> </span><span class="mf">9</span><span class="p">];</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">results</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">arr</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">pow</span><span class="p">);</span><span class="w"> </span><span class="c1">// [1, 4, 9, 16, 25, 36, 49, 64, 81]</span><span class="w"></span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">results</span><span class="p">);</span><span class="w"></span>

<span class="c1">// reduce</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">arr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="mf">3</span><span class="p">,</span><span class="w"> </span><span class="mf">5</span><span class="p">,</span><span class="w"> </span><span class="mf">7</span><span class="p">,</span><span class="w"> </span><span class="mf">9</span><span class="p">];</span><span class="w"></span>
<span class="nx">arr</span><span class="p">.</span><span class="nx">reduce</span><span class="p">(</span><span class="kd">function</span><span class="w"> </span><span class="p">(</span><span class="nx">x</span><span class="p">,</span><span class="w"> </span><span class="nx">y</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="nx">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">y</span><span class="p">;</span><span class="w"></span>
<span class="p">});</span><span class="w"> </span><span class="c1">// 25</span><span class="w"></span>
</code></pre></div>
<p>另外，需要注意 map 虽然多数情况下仅需要传递一个参数，但实际上传递的是三个参数 元素、index、数组本身；因此若接受函数的参数多于 1 个可能就有问题，例如下面的 parseInt，可接受两个参数，第二个参数为进制，参见 <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/map#tricky_use_case">https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/map#tricky_use_case</a></p>
<div class="highlight"><pre><span></span><code><span class="p">[</span><span class="s2">&quot;1&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;2&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;3&quot;</span><span class="p">].</span><span class="nx">map</span><span class="p">(</span><span class="nb">parseInt</span><span class="p">)</span><span class="w"> </span><span class="c1">// [1, NaN, NaN]</span><span class="w"></span>

<span class="c1">// 几种解决方案</span><span class="w"></span>
<span class="kd">function</span><span class="w"> </span><span class="nx">returnInt</span><span class="p">(</span><span class="nx">element</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nb">parseInt</span><span class="p">(</span><span class="nx">element</span><span class="p">,</span><span class="w"> </span><span class="mf">10</span><span class="p">)</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
<span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;2&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;3&#39;</span><span class="p">].</span><span class="nx">map</span><span class="p">(</span><span class="nx">returnInt</span><span class="p">);</span><span class="w"> </span><span class="c1">// [1, 2, 3]</span><span class="w"></span>
<span class="c1">// Actual result is an array of numbers (as expected)</span><span class="w"></span>

<span class="c1">// Same as above, but using the concise arrow function syntax</span><span class="w"></span>
<span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;2&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;3&#39;</span><span class="p">].</span><span class="nx">map</span><span class="p">(</span><span class="w"> </span><span class="nx">str</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nb">parseInt</span><span class="p">(</span><span class="nx">str</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"></span>

<span class="c1">// A simpler way to achieve the above, while avoiding the &quot;gotcha&quot;:</span><span class="w"></span>
<span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;2&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;3&#39;</span><span class="p">].</span><span class="nx">map</span><span class="p">(</span><span class="nb">Number</span><span class="p">)</span><span class="w">  </span><span class="c1">// [1, 2, 3]</span><span class="w"></span>
</code></pre></div>
<h4 id="filter">filter<a class="headerlink" href="#filter" title="Permanent link">&para;</a></h4>
<p>filter也是一个常用的操作，它用于把Array的某些元素过滤掉，然后返回剩下的元素。</p>
<p>和map()类似，Array的filter()也接收一个函数。和map()不同的是，filter()把传入的函数依次作用于每个元素，然后根据返回值是true还是false决定保留还是丢弃该元素。</p>
<p>【和 map 类似】filter()接收的回调函数，其实可以有多个参数。通常我们仅使用第一个参数，表示Array的某个元素。回调函数还可以接收另外两个参数，表示元素的位置和数组本身。</p>
<div class="highlight"><pre><span></span><code><span class="c1">// 利用 filter 的 index 参数去除重复字符串</span><span class="w"></span>
<span class="kd">var</span><span class="w"></span>
<span class="w"> </span><span class="nx">r</span><span class="p">,</span><span class="w"></span>
<span class="w"> </span><span class="nx">arr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s1">&#39;apple&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;strawberry&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;banana&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;pear&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;apple&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;orange&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;orange&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;strawberry&#39;</span><span class="p">];</span><span class="w"></span>

<span class="nx">r</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">arr</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="kd">function</span><span class="w"> </span><span class="p">(</span><span class="nx">element</span><span class="p">,</span><span class="w"> </span><span class="nx">index</span><span class="p">,</span><span class="w"> </span><span class="nx">self</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="nx">self</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">element</span><span class="p">)</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="nx">index</span><span class="p">;</span><span class="w"></span>
<span class="p">});</span><span class="w"></span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">r</span><span class="p">.</span><span class="nx">toString</span><span class="p">());</span><span class="w">    </span>
</code></pre></div>
<p>一个例子，过滤素数</p>
<div class="highlight"><pre><span></span><code><span class="kd">let</span><span class="w"> </span><span class="nx">arr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span><span class="w"></span>
<span class="k">for</span><span class="p">(</span><span class="kd">var</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">101</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">++</span><span class="p">){</span><span class="w"></span>
<span class="w"> </span><span class="nx">arr</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">i</span><span class="p">);</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">getPrime</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="p">(</span><span class="nx">arr</span><span class="p">){</span><span class="w"></span>
<span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="nx">arr</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">ele</span><span class="p">){</span><span class="w"></span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">ele</span><span class="o">==</span><span class="mf">1</span><span class="p">){</span><span class="k">return</span><span class="w"> </span><span class="kc">false</span><span class="p">;}</span><span class="w"></span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">var</span><span class="w"> </span><span class="nx">i</span><span class="o">=</span><span class="mf">2</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">&lt;=</span><span class="nb">Math</span><span class="p">.</span><span class="nx">sqrt</span><span class="p">(</span><span class="nx">ele</span><span class="p">);</span><span class="w"> </span><span class="nx">i</span><span class="o">++</span><span class="p">){</span><span class="w"></span>
<span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">ele</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span><span class="w"></span>
<span class="w"> </span><span class="p">})</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">getPrime</span><span class="p">(</span><span class="nx">arr</span><span class="p">))</span><span class="w"></span>
</code></pre></div>
<h4 id="reduce">reduce()<a class="headerlink" href="#reduce" title="Permanent link">&para;</a></h4>
<p>reduce() 方法在数组中从左到右工作。另请参见 reduceRight（）。
【注意】reduce 的第一参数为累加的初始值。
在调用的时候，可以不赋值，例如可以以 <code>numbers1.reduce(myFunction)</code> 这样的形式调用，也可像下面那样写在后面。</p>
<div class="highlight"><pre><span></span><code><span class="kd">var</span><span class="w"> </span><span class="nx">numbers1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">45</span><span class="p">,</span><span class="w"> </span><span class="mf">4</span><span class="p">,</span><span class="w"> </span><span class="mf">9</span><span class="p">,</span><span class="w"> </span><span class="mf">16</span><span class="p">,</span><span class="w"> </span><span class="mf">25</span><span class="p">];</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">sum</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">numbers1</span><span class="p">.</span><span class="nx">reduce</span><span class="p">(</span><span class="nx">myFunction</span><span class="p">,</span><span class="w"> </span><span class="mf">100</span><span class="p">);</span><span class="w"> </span><span class="c1">// 或 numbers1.reduce(myFunction)</span><span class="w"></span>

<span class="c1">// function myFunction(total, value) 这样也行</span><span class="w"></span>
<span class="kd">function</span><span class="w"> </span><span class="nx">myFunction</span><span class="p">(</span><span class="nx">total</span><span class="p">,</span><span class="w"> </span><span class="nx">value</span><span class="p">,</span><span class="w"> </span><span class="nx">index</span><span class="p">,</span><span class="w"> </span><span class="nx">array</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">total</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">value</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<h4 id="every-some">every(), some()<a class="headerlink" href="#every-some" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="kd">var</span><span class="w"> </span><span class="nx">numbers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">45</span><span class="p">,</span><span class="w"> </span><span class="mf">4</span><span class="p">,</span><span class="w"> </span><span class="mf">9</span><span class="p">,</span><span class="w"> </span><span class="mf">16</span><span class="p">,</span><span class="w"> </span><span class="mf">25</span><span class="p">];</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">someOver18</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">numbers</span><span class="p">.</span><span class="nx">some</span><span class="p">(</span><span class="nx">myFunction</span><span class="p">);</span><span class="w"></span>

<span class="kd">function</span><span class="w"> </span><span class="nx">myFunction</span><span class="p">(</span><span class="nx">value</span><span class="p">,</span><span class="w"> </span><span class="nx">index</span><span class="p">,</span><span class="w"> </span><span class="nx">array</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">value</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">18</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<h4 id="concat">concat()<a class="headerlink" href="#concat" title="Permanent link">&para;</a></h4>
<p>注意，concat 是返回一个新的数组而非修改原数组。</p>
<div class="highlight"><pre><span></span><code><span class="c1">// concat</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">arr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;C&#39;</span><span class="p">];</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">added</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">arr</span><span class="p">.</span><span class="nx">concat</span><span class="p">([</span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="mf">2</span><span class="p">,</span><span class="w"> </span><span class="mf">3</span><span class="p">]);</span><span class="w"></span>
<span class="nx">added</span><span class="p">;</span><span class="w"> </span><span class="c1">// [&#39;A&#39;, &#39;B&#39;, &#39;C&#39;, 1, 2, 3]</span><span class="w"></span>
<span class="nx">arr</span><span class="p">;</span><span class="w"> </span><span class="c1">// [&#39;A&#39;, &#39;B&#39;, &#39;C&#39;]</span><span class="w"></span>

<span class="kd">var</span><span class="w"> </span><span class="nx">arr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;C&#39;</span><span class="p">];</span><span class="w">  </span><span class="c1">// 事实上 concat 后可接任一个元素和 Array，将 Array 自动展开</span><span class="w"></span>
<span class="nx">arr</span><span class="p">.</span><span class="nx">concat</span><span class="p">(</span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="mf">2</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="mf">3</span><span class="p">,</span><span class="w"> </span><span class="mf">4</span><span class="p">]);</span><span class="w"> </span><span class="c1">// [&#39;A&#39;, &#39;B&#39;, &#39;C&#39;, 1, 2, 3, 4]</span><span class="w"></span>
</code></pre></div>
<h4 id="indexof">indexOf()<a class="headerlink" href="#indexof" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="kd">var</span><span class="w"> </span><span class="nx">fruits</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;Apple&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Orange&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Apple&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Mango&quot;</span><span class="p">];</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">fruits</span><span class="p">.</span><span class="nx">lastIndexOf</span><span class="p">(</span><span class="s2">&quot;Apple&quot;</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<h4 id="find-findindex">find(), findIndex()<a class="headerlink" href="#find-findindex" title="Permanent link">&para;</a></h4>
<p>区别在于一个返回所找到的值，一个返回 index</p>
<div class="highlight"><pre><span></span><code><span class="kd">var</span><span class="w"> </span><span class="nx">numbers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">4</span><span class="p">,</span><span class="w"> </span><span class="mf">9</span><span class="p">,</span><span class="w"> </span><span class="mf">16</span><span class="p">,</span><span class="w"> </span><span class="mf">25</span><span class="p">,</span><span class="w"> </span><span class="mf">29</span><span class="p">];</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">first</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">numbers</span><span class="p">.</span><span class="nx">findIndex</span><span class="p">(</span><span class="nx">myFunction</span><span class="p">);</span><span class="w"></span>

<span class="kd">function</span><span class="w"> </span><span class="nx">myFunction</span><span class="p">(</span><span class="nx">value</span><span class="p">,</span><span class="w"> </span><span class="nx">index</span><span class="p">,</span><span class="w"> </span><span class="nx">array</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">value</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">18</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<h3 id="js_1">js 对象<a class="headerlink" href="#js_1" title="Permanent link">&para;</a></h3>
<ul>
<li>属性名必须是一个有效的变量名。如果属性名包含特殊字符，就必须用 <code>""</code> 括起来。访问这个属性也无法使用 <code>.</code> 操作符，必须用 <code>['xxx']</code> 来访问.</li>
<li>JavaScript规定，访问不存在的属性不报错，而是返回 <code>undefined</code></li>
<li>如果我们要检测是否拥有某一属性，可以用 <code>in</code> 操作符<ul>
<li><code>'name' in xiaoming;</code></li>
<li>要判断一个属性是否是某对象自身拥有的，而不是继承得到的，可以用 <code>hasOwnProperty()</code> 方法, 例如 <code>xiaoming.hasOwnProperty('toString');</code> (toString 定义在object对象中, 而所有对象最终都会在原型链上指向object)</li>
</ul>
</li>
<li><strong>JavaScript 对象无法进行对比</strong>，比较两个 JavaScript 将始终返回 false。</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="kd">var</span><span class="w"> </span><span class="nx">xiaohong</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;小红&#39;</span><span class="p">,</span><span class="w"></span>
<span class="w"> </span><span class="s1">&#39;middle-school&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;No.1 Middle School&#39;</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="nx">xiaohong</span><span class="p">[</span><span class="s1">&#39;middle-school&#39;</span><span class="p">];</span><span class="w"> </span><span class="c1">// &#39;No.1 Middle School&#39;</span><span class="w"></span>
<span class="nx">xiaohong</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">];</span><span class="w"> </span><span class="c1">// &#39;小红&#39;</span><span class="w"></span>
<span class="nx">xiaohong</span><span class="p">.</span><span class="nx">name</span><span class="p">;</span><span class="w"> </span><span class="c1">// &#39;小红&#39;</span><span class="w"></span>
</code></pre></div>
<p>如果访问一个不存在的属性会返回什么呢？JavaScript规定，访问不存在的属性不报错，而是返回undefined</p>
<div class="highlight"><pre><span></span><code><span class="kd">var</span><span class="w"> </span><span class="nx">xiaoming</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;小明&#39;</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>
<span class="nx">xiaoming</span><span class="p">.</span><span class="nx">age</span><span class="p">;</span><span class="w"> </span><span class="c1">// undefined</span><span class="w"></span>
<span class="nx">xiaoming</span><span class="p">.</span><span class="nx">age</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">18</span><span class="p">;</span><span class="w"> </span><span class="c1">// 新增一个age属性</span><span class="w"></span>
<span class="nx">xiaoming</span><span class="p">.</span><span class="nx">age</span><span class="p">;</span><span class="w"> </span><span class="c1">// 18</span><span class="w"></span>
<span class="ow">delete</span><span class="w"> </span><span class="nx">xiaoming</span><span class="p">.</span><span class="nx">age</span><span class="p">;</span><span class="w"> </span><span class="c1">// 删除age属性</span><span class="w"></span>
<span class="nx">xiaoming</span><span class="p">.</span><span class="nx">age</span><span class="p">;</span><span class="w"> </span><span class="c1">// undefined</span><span class="w"></span>
<span class="ow">delete</span><span class="w"> </span><span class="nx">xiaoming</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">];</span><span class="w"> </span><span class="c1">// 删除name属性</span><span class="w"></span>
<span class="nx">xiaoming</span><span class="p">.</span><span class="nx">name</span><span class="p">;</span><span class="w"> </span><span class="c1">// undefined</span><span class="w"></span>
<span class="ow">delete</span><span class="w"> </span><span class="nx">xiaoming</span><span class="p">.</span><span class="nx">school</span><span class="p">;</span><span class="w"> </span><span class="c1">// 删除一个不存在的school属性也不会报错</span><span class="w"></span>

<span class="c1">// 查看一个对象是否有一个属性，可以用 in 操作符</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">xiaoming</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;小明&#39;</span><span class="p">,</span><span class="w"></span>
<span class="w"> </span><span class="nx">birth</span><span class="o">:</span><span class="w"> </span><span class="mf">1990</span><span class="p">,</span><span class="w"></span>
<span class="w"> </span><span class="nx">school</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;No.1 Middle School&#39;</span><span class="p">,</span><span class="w"></span>
<span class="w"> </span><span class="nx">height</span><span class="o">:</span><span class="w"> </span><span class="mf">1.70</span><span class="p">,</span><span class="w"></span>
<span class="w"> </span><span class="nx">weight</span><span class="o">:</span><span class="w"> </span><span class="mf">65</span><span class="p">,</span><span class="w"></span>
<span class="w"> </span><span class="nx">score</span><span class="o">:</span><span class="w"> </span><span class="kc">null</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>
<span class="s1">&#39;name&#39;</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nx">xiaoming</span><span class="p">;</span><span class="w"> </span><span class="c1">// true</span><span class="w"></span>
<span class="s1">&#39;grade&#39;</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nx">xiaoming</span><span class="p">;</span><span class="w"> </span><span class="c1">// false</span><span class="w"></span>

<span class="c1">// 要判断一个属性是否是xiaoming自身拥有的，而不是继承得到的，可以用hasOwnProperty()方法</span><span class="w"></span>
<span class="nx">xiaoming</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">);</span><span class="w"> </span><span class="c1">// true</span><span class="w"></span>
<span class="nx">xiaoming</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="s1">&#39;toString&#39;</span><span class="p">);</span><span class="w"> </span><span class="c1">// false</span><span class="w"></span>
</code></pre></div>
<h3 id="_10">条件判断<a class="headerlink" href="#_10" title="Permanent link">&para;</a></h3>
<ul>
<li>JavaScript把 null、undefined、0、NaN 和空字符串 &lsquo;&rsquo; 视为false，其他值一概视为true。</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="kd">var</span><span class="w"> </span><span class="nx">age</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">3</span><span class="p">;</span><span class="w"></span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">age</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mf">18</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="nx">alert</span><span class="p">(</span><span class="s1">&#39;adult&#39;</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">age</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mf">6</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="nx">alert</span><span class="p">(</span><span class="s1">&#39;teenager&#39;</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="nx">alert</span><span class="p">(</span><span class="s1">&#39;kid&#39;</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<h3 id="_11">循环<a class="headerlink" href="#_11" title="Permanent link">&para;</a></h3>
<h4 id="for">for<a class="headerlink" href="#for" title="Permanent link">&para;</a></h4>
<ul>
<li>for 循环，通过初始条件、结束条件和递增条件来循环执行语句块<ul>
<li><code>for (var i = 1; i &lt;= 10; i++) {}</code></li>
<li>遍历数组 <code>for (i=0; i&lt;arr.length; i++){}</code></li>
</ul>
</li>
<li>for循环的一个变体是 <code>for ... in</code>  循环，它可以把一个对象的所有属性依次循环出来<ul>
<li><code>for (var key in o) {}</code></li>
<li>注意, Array也是对象，而它的每个元素的索引被视为对象的属性 (注意, for &hellip; in对Array的循环得到的是String而不是Number ! 记住 js 中所有的 key 类型都是字符串)<ul>
<li><code>for (var i in arr) { console.log(arr[i]); }</code></li>
</ul>
</li>
</ul>
</li>
<li>while循环</li>
<li>do { &hellip; } while()循环</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="c1">// for 语句</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">i</span><span class="p">;</span><span class="w"></span>
<span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="nx">i</span><span class="o">=</span><span class="mf">1</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">&lt;=</span><span class="mf">10000</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="nx">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">i</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
<span class="nx">x</span><span class="p">;</span><span class="w"> </span><span class="c1">// 50005000</span><span class="w"></span>

<span class="kd">var</span><span class="w"> </span><span class="nx">arr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s1">&#39;Apple&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Google&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Microsoft&#39;</span><span class="p">];</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">i</span><span class="p">,</span><span class="w"> </span><span class="nx">x</span><span class="p">;</span><span class="w"></span>
<span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="nx">i</span><span class="o">=</span><span class="mf">0</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">&lt;</span><span class="nx">arr</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="nx">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">arr</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span><span class="w"></span>
<span class="w"> </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">x</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// 其中的 3 个条件都是可省略的</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span><span class="w"></span>
<span class="k">for</span><span class="w"> </span><span class="p">(;;)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">// 将无限循环下去</span><span class="w"></span>
<span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">x</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">100</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="k">break</span><span class="p">;</span><span class="w"> </span><span class="c1">// 通过if判断来退出循环</span><span class="w"></span>
<span class="w"> </span><span class="p">}</span><span class="w"></span>
<span class="w"> </span><span class="nx">x</span><span class="w"> </span><span class="o">++</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<h4 id="forin">for&hellip;in<a class="headerlink" href="#forin" title="Permanent link">&para;</a></h4>
<p>for 循环的一个变体是 <code>for ... in</code> 循环，它可以把一个对象的所有属性依次循环出来。
由于<strong>Array也是对象</strong>，而它的每个元素的索引被视为对象的属性，因此，for &hellip; in循环可以直接循环出Array的索引</p>
<div class="highlight"><pre><span></span><code><span class="c1">// for...in</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">o</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Jack&#39;</span><span class="p">,</span><span class="w"></span>
<span class="w"> </span><span class="nx">age</span><span class="o">:</span><span class="w"> </span><span class="mf">20</span><span class="p">,</span><span class="w"></span>
<span class="w"> </span><span class="nx">city</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Beijing&#39;</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>
<span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">var</span><span class="w"> </span><span class="nx">key</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nx">o</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">key</span><span class="p">);</span><span class="w"> </span><span class="c1">// &#39;name&#39;, &#39;age&#39;, &#39;city&#39;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// 循环列表</span><span class="w"></span>
<span class="c1">// 但注意，请注意，for ... in对Array的循环得到的是String而不是Number。</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;C&#39;</span><span class="p">];</span><span class="w"></span>
<span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">var</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nx">a</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">i</span><span class="p">);</span><span class="w"> </span><span class="c1">// &#39;0&#39;, &#39;1&#39;, &#39;2&#39;</span><span class="w"></span>
<span class="w"> </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">a</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span><span class="w"> </span><span class="c1">// &#39;A&#39;, &#39;B&#39;, &#39;C&#39;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<h4 id="while">while<a class="headerlink" href="#while" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="kd">var</span><span class="w"> </span><span class="nx">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">99</span><span class="p">;</span><span class="w"></span>
<span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="nx">n</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="nx">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">n</span><span class="p">;</span><span class="w"></span>
<span class="w"> </span><span class="nx">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">n</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">2</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
<span class="nx">x</span><span class="p">;</span><span class="w"> </span><span class="c1">// 2500</span><span class="w"></span>
</code></pre></div>
<h4 id="dowhile">do&hellip;while<a class="headerlink" href="#dowhile" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="kd">var</span><span class="w"> </span><span class="nx">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span><span class="w"></span>
<span class="k">do</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="nx">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">n</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">1</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="nx">n</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">100</span><span class="p">);</span><span class="w"></span>
<span class="nx">n</span><span class="p">;</span><span class="w"> </span><span class="c1">// 100</span><span class="w"></span>
</code></pre></div>
<h3 id="map-set">Map 和 Set<a class="headerlink" href="#map-set" title="Permanent link">&para;</a></h3>
<ul>
<li>Map<ul>
<li>JavaScript的默认对象表示方式{}可以视为其他语言中的Map或Dictionary的数据结构，即一组键值对。但是JavaScript的对象有个小问题，就是键必须是字符串。但实际上Number或者其他数据类型作为键也是非常合理的。</li>
<li>为了解决这个问题，最新的ES6规范引入了新的数据类型 <code>Map</code>。</li>
<li>初始化Map需要一个 <strong>二维数组</strong>，或者直接初始化一个空Map。 <code>var m = new Map([['Michael', 95], ['Bob', 75], ['Tracy', 85]]);</code></li>
<li>方法: <code>set, has, get, delete</code></li>
</ul>
</li>
<li>Set<ul>
<li><code>Set</code> 和Map类似，也是一组key的集合，但不存储value。由于key不能重复，所以，在Set中，没有重复的key。</li>
<li>要创建一个Set，需要提供一个 Array 作为输入，或者直接创建一个空Set.</li>
<li>方法: <code>add, delete, has</code></li>
</ul>
</li>
<li>注意, in 语句 在 Map 和 Set 中无效</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="kd">var</span><span class="w"> </span><span class="nx">m</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Map</span><span class="p">([[</span><span class="s1">&#39;Michael&#39;</span><span class="p">,</span><span class="w"> </span><span class="mf">95</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="s1">&#39;Bob&#39;</span><span class="p">,</span><span class="w"> </span><span class="mf">75</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="s1">&#39;Tracy&#39;</span><span class="p">,</span><span class="w"> </span><span class="mf">85</span><span class="p">]]);</span><span class="w"></span>
<span class="nx">m</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;Michael&#39;</span><span class="p">);</span><span class="w"> </span><span class="c1">// 95</span><span class="w"></span>

<span class="c1">// set() has() get() delete()</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">m</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Map</span><span class="p">();</span><span class="w"> </span><span class="c1">// 空Map</span><span class="w"></span>
<span class="nx">m</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">&#39;Adam&#39;</span><span class="p">,</span><span class="w"> </span><span class="mf">67</span><span class="p">);</span><span class="w"> </span><span class="c1">// 添加新的key-value</span><span class="w"></span>
<span class="nx">m</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">&#39;Bob&#39;</span><span class="p">,</span><span class="w"> </span><span class="mf">59</span><span class="p">);</span><span class="w"></span>
<span class="nx">m</span><span class="p">.</span><span class="nx">has</span><span class="p">(</span><span class="s1">&#39;Adam&#39;</span><span class="p">);</span><span class="w"> </span><span class="c1">// 是否存在key &#39;Adam&#39;: true</span><span class="w"></span>
<span class="nx">m</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;Adam&#39;</span><span class="p">);</span><span class="w"> </span><span class="c1">// 67</span><span class="w"></span>
<span class="nx">m</span><span class="p">.</span><span class="ow">delete</span><span class="p">(</span><span class="s1">&#39;Adam&#39;</span><span class="p">);</span><span class="w"> </span><span class="c1">// 删除key &#39;Adam&#39;</span><span class="w"></span>
<span class="nx">m</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;Adam&#39;</span><span class="p">);</span><span class="w"> </span><span class="c1">// undefined</span><span class="w"></span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="kd">var</span><span class="w"> </span><span class="nx">s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Set</span><span class="p">([</span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="mf">2</span><span class="p">,</span><span class="w"> </span><span class="mf">3</span><span class="p">,</span><span class="w"> </span><span class="mf">3</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;3&#39;</span><span class="p">]);</span><span class="w"></span>
<span class="nx">s</span><span class="p">;</span><span class="w"> </span><span class="c1">// Set {1, 2, 3, &quot;3&quot;}</span><span class="w"></span>

<span class="c1">// add()</span><span class="w"></span>
<span class="nx">s</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="mf">4</span><span class="p">);</span><span class="w"></span>
<span class="nx">s</span><span class="p">;</span><span class="w"> </span><span class="c1">// Set {1, 2, 3, 4}</span><span class="w"></span>
<span class="nx">s</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="mf">4</span><span class="p">);</span><span class="w"></span>
<span class="nx">s</span><span class="p">;</span><span class="w"> </span><span class="c1">// 仍然是 Set {1, 2, 3, 4}</span><span class="w"></span>

<span class="c1">// delete()</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Set</span><span class="p">([</span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="mf">2</span><span class="p">,</span><span class="w"> </span><span class="mf">3</span><span class="p">]);</span><span class="w"></span>
<span class="nx">s</span><span class="p">;</span><span class="w"> </span><span class="c1">// Set {1, 2, 3}</span><span class="w"></span>
<span class="nx">s</span><span class="p">.</span><span class="ow">delete</span><span class="p">(</span><span class="mf">3</span><span class="p">);</span><span class="w"></span>
<span class="nx">s</span><span class="p">;</span><span class="w"> </span><span class="c1">// Set {1, 2}</span><span class="w"></span>
</code></pre></div>
<h3 id="iterable">iterable<a class="headerlink" href="#iterable" title="Permanent link">&para;</a></h3>
<ul>
<li>遍历Array可以采用下标循环，遍历Map和Set就无法使用下标。为了统一集合类型，ES6标准引入了新的iterable类型，<strong>Array、Map 和 Set 都属于 iterable 类型</strong>。</li>
<li>具有iterable类型的集合可以通过新的 <code>for ... of</code> 循环来遍历。</li>
<li>for &hellip; of循环和for &hellip; in循环有何区别？<ul>
<li>一个Array数组实际上也是一个对象，它的每个元素的索引被视为一个属性。</li>
<li>例如, Array <code>['A', 'B', 1, name: 'Hello']</code> 也是可以的,<ul>
<li>此时用 <code>for ... in</code> 得到的属性名称为 <code>'0', '1', '2', 'name'</code></li>
<li>注意, for &hellip; in 循环将把name包括在内，但Array的length属性却不包括在内。</li>
<li><code>for ... of</code> 循环则完全修复了这些问题，它只循环集合本身的元素</li>
</ul>
</li>
</ul>
</li>
<li>forEach<ul>
<li>然而，更好的方式是直接使用 iterable 内置的 forEach 方法，它接收一个函数，每次迭代就自动回调该函数。以 <code>Array</code> 为例，三个参数分别为 element, index 和 array 本身。<ul>
<li><code>Set</code> 与Array类似，但Set没有索引，因此回调函数的前两个参数都是元素本身。</li>
<li><code>Map</code> 的回调函数参数依次为value、key和map本身。</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="for-of">for &hellip; of<a class="headerlink" href="#for-of" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="kd">var</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;C&#39;</span><span class="p">];</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Set</span><span class="p">([</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;C&#39;</span><span class="p">]);</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">m</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Map</span><span class="p">([[</span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;x&#39;</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mf">2</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;y&#39;</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mf">3</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;z&#39;</span><span class="p">]]);</span><span class="w"></span>
<span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">var</span><span class="w"> </span><span class="nx">x</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="nx">a</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">// 遍历Array</span><span class="w"></span>
<span class="w"> </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">x</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
<span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">var</span><span class="w"> </span><span class="nx">x</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="nx">s</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">// 遍历Set</span><span class="w"></span>
<span class="w"> </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">x</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
<span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">var</span><span class="w"> </span><span class="nx">x</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="nx">m</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">// 遍历Map</span><span class="w"></span>
<span class="w"> </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">x</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;=&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">x</span><span class="p">[</span><span class="mf">1</span><span class="p">]);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// 当我们手动给Array对象添加了额外的属性后，for ... in 循环将带来意想不到的意外效果</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;C&#39;</span><span class="p">];</span><span class="w"></span>
<span class="nx">a</span><span class="p">.</span><span class="nx">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Hello&#39;</span><span class="p">;</span><span class="w"> </span><span class="c1">// 会在最后, 也即 a[3] === 1</span><span class="w"></span>
<span class="nx">a</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="mf">1</span><span class="p">);</span><span class="w"></span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">a</span><span class="p">);</span><span class="w"></span>
<span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">var</span><span class="w"> </span><span class="nx">x</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nx">a</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">x</span><span class="p">);</span><span class="w"> </span><span class="c1">// &#39;0&#39;, &#39;1&#39;, &#39;2&#39;, &#39;name&#39;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
<span class="c1">// 此时用 for...of 就只会循环集合本身的元素</span><span class="w"></span>
<span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">var</span><span class="w"> </span><span class="nx">x</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="nx">a</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">x</span><span class="p">);</span><span class="w"> </span><span class="c1">// &#39;A&#39;, &#39;B&#39;, &#39;C&#39;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<h4 id="foreach_1">forEach 方法<a class="headerlink" href="#foreach_1" title="Permanent link">&para;</a></h4>
<ul>
<li>然而，更好的方式是直接使用 iterable 内置的 forEach 方法，它接收一个函数，每次迭代就自动回调该函数。以 <code>Array</code> 为例，三个参数分别为 <code>element, index</code> 和 array 本身。</li>
<li><code>Set</code> 与Array类似，但Set没有索引，因此回调函数的前两个参数都是元素本身。</li>
<li><code>Map</code> 的回调函数参数依次为 <code>value、key</code> 和map本身。</li>
<li>如果对某些参数不感兴趣，由于JavaScript的函数调用不要求参数必须一致，因此可以忽略它们</li>
</ul>
<p>如果对某些参数不感兴趣，由于JavaScript的函数调用不要求参数必须一致，因此可以忽略它们。</p>
<div class="highlight"><pre><span></span><code><span class="c1">// forEach Array</span><span class="w"></span>
<span class="nx">a</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="w"> </span><span class="p">(</span><span class="nx">element</span><span class="p">,</span><span class="w"> </span><span class="nx">index</span><span class="p">,</span><span class="w"> </span><span class="nx">array</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="c1">// element: 指向当前元素的值</span><span class="w"></span>
<span class="w"> </span><span class="c1">// index: 指向当前索引</span><span class="w"></span>
<span class="w"> </span><span class="c1">// array: 指向Array对象本身</span><span class="w"></span>
<span class="w"> </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">element</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;, index = &#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">index</span><span class="p">);</span><span class="w"></span>
<span class="p">});</span><span class="w"></span>
<span class="c1">// Set</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Set</span><span class="p">([</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;C&#39;</span><span class="p">]);</span><span class="w"></span>
<span class="nx">s</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="w"> </span><span class="p">(</span><span class="nx">element</span><span class="p">,</span><span class="w"> </span><span class="nx">sameElement</span><span class="p">,</span><span class="w"> </span><span class="nx">set</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">element</span><span class="p">);</span><span class="w"></span>
<span class="p">});</span><span class="w"></span>
<span class="c1">//Map</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">m</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Map</span><span class="p">([[</span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;x&#39;</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mf">2</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;y&#39;</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mf">3</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;z&#39;</span><span class="p">]]);</span><span class="w"></span>
<span class="nx">m</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="w"> </span><span class="p">(</span><span class="nx">value</span><span class="p">,</span><span class="w"> </span><span class="nx">key</span><span class="p">,</span><span class="w"> </span><span class="nx">map</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">value</span><span class="p">);</span><span class="w"></span>
<span class="p">});</span><span class="w"></span>

<span class="c1">// 函数调用的参数数量可以不一致</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;C&#39;</span><span class="p">];</span><span class="w"></span>
<span class="nx">a</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="w"> </span><span class="p">(</span><span class="nx">element</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">element</span><span class="p">);</span><span class="w"></span>
<span class="p">});</span><span class="w"></span>
</code></pre></div>
<h2 id="js_2">JS 函数<a class="headerlink" href="#js_2" title="Permanent link">&para;</a></h2>
<ul>
<li>参数<ul>
<li><code>function foo(a, b, ...rest) {}</code>; <code>arguments</code> 对象; 值传递, 对象引用是值</li>
</ul>
</li>
<li>变量作用域<ul>
<li>变量提升; 全局作用域; 申明块级作用域 let, const</li>
</ul>
</li>
<li>Function 构造器<ul>
<li><code>var myFunction = new Function("a", "b", "return a * b");</code></li>
</ul>
</li>
<li>解构赋值: 类似Python中的序列解包<ul>
<li>对象的解构赋值. 别名; 嵌套; 默认值; 在函数传参时使用</li>
</ul>
</li>
<li>对象的方法<ul>
<li>this 关键词</li>
<li>apply, call(). <code>Math.max.apply(null, [3, 5, 4]);</code></li>
</ul>
</li>
<li>高阶函数<ul>
<li>forEach</li>
<li>map, reduce</li>
<li>filter</li>
<li>sort. <code>sort((firstEl, secondEl) =&gt; { /* ... */ } )</code> 注意返回 -1,0,1 负数表示优先级高</li>
<li>every</li>
<li>find, findIndex</li>
</ul>
</li>
<li>函数闭包: 返回一个新的函数<ul>
<li>作用: 1. 可以像 class 一样定义私有变量; 2. 可以封装新的函数</li>
</ul>
</li>
<li>箭头函数: 主要区别在于对于 this 的指向进行了一定修复, 其内部的 this 是词法作用域, 由上下文确定</li>
<li>generator 生成器: 类似 Python<ul>
<li>作用: 1. 可以记录过程中变量, 完成 object 采用实现的任务; 2. 更重要的是, 可以把异步回调代码变成“同步”代码</li>
</ul>
</li>
</ul>
<h3 id="_12">定义和调用<a class="headerlink" href="#_12" title="Permanent link">&para;</a></h3>
<ul>
<li>定义函数<ul>
<li>两种定义语法<ul>
<li><code>function abs(x) {}</code></li>
<li><code>var abs = function (x) {}</code></li>
</ul>
</li>
<li>由于JavaScript的函数也是一个对象，上述定义的<code>abs()</code>函数实际上是一个函数对象，而函数名<code>abs</code>可以视为指向该函数的变量。</li>
<li>如果没有<code>return</code>语句，函数执行完毕后也会返回结果，只是结果为<code>undefined</code>。</li>
</ul>
</li>
<li>JavaScript 函数有一个名为 <code>arguments</code> 对象的内置对象。</li>
<li>rest 参数<ul>
<li>ES6标准引入了rest参数</li>
<li>写法为 <code>function foo(a, b, ...rest) {}</code></li>
<li>如果传入的参数连正常定义的参数都没填满，也不要紧，rest参数会接收一个空数组（注意不是<code>undefined</code>）。</li>
</ul>
</li>
<li>函数也是对象, 有 <code>toString()</code> 等方法</li>
<li>变量作用域与解构赋值<ul>
<li>由于JavaScript的函数可以嵌套，此时，内部函数可以访问外部函数定义的变量，反过来则不行</li>
<li>若重名: JavaScript的函数在查找变量时从自身函数定义开始，从“内”向“外”查找。如果内部函数定义了与外部函数重名的变量，则内部函数的变量将“屏蔽”外部函数的变量。</li>
</ul>
</li>
<li>变量提升<ul>
<li>JavaScript的函数定义有个特点，它会先扫描整个函数体的语句，把所有申明的变量“提升”到函数顶部</li>
<li>提升的仅仅是声明 (undefined), 而不会运行变量赋值</li>
</ul>
</li>
</ul>
<p>如果没有return语句，函数执行完毕后也会返回结果，只是结果为 <code>undefined</code>。</p>
<div class="highlight"><pre><span></span><code><span class="kd">function</span><span class="w"> </span><span class="nx">abs</span><span class="p">(</span><span class="nx">x</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">x</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">x</span><span class="p">;</span><span class="w"></span>
<span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="o">-</span><span class="nx">x</span><span class="p">;</span><span class="w"></span>
<span class="w"> </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
<span class="c1">// 也可以这样定义函数</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">abs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="p">(</span><span class="nx">x</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">x</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">x</span><span class="p">;</span><span class="w"></span>
<span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="o">-</span><span class="nx">x</span><span class="p">;</span><span class="w"></span>
<span class="w"> </span><span class="p">}</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>
</code></pre></div>
<ul>
<li>在第二种方式下，<code>function (x) { ... }</code> 是一个匿名函数，它没有函数名。但是，这个匿名函数赋值给了变量abs，所以，通过变量abs就可以调用该函数。</li>
<li>上述两种定义完全等价，注意第二种方式按照完整语法需要在函数体末尾加一个 <code>;</code>，表示赋值语句结束。</li>
</ul>
<p>函数调用</p>
<ul>
<li>由于JavaScript <strong>允许传入任意个参数而不影响调用</strong>，因此传入的参数比定义的参数多也没有问题，虽然函数内部并不需要这些参数。</li>
<li>传入的参数比定义的少也没有问题（注意函数没有返回值的时候得到的是 <code>undefined</code>）。在上例中，abs(x) 函数的参数x将收到 <code>undefined</code>，计算结果为 <code>NaN</code>。</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="c1">// 避免收到异常值或是 undefined</span><span class="w"></span>
<span class="kd">function</span><span class="w"> </span><span class="nx">abs</span><span class="p">(</span><span class="nx">x</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="ow">typeof</span><span class="w"> </span><span class="nx">x</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="s1">&#39;number&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="k">throw</span><span class="w"> </span><span class="s1">&#39;Not a number&#39;</span><span class="p">;</span><span class="w"></span>
<span class="w"> </span><span class="p">}</span><span class="w"></span>
<span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">x</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">x</span><span class="p">;</span><span class="w"></span>
<span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="o">-</span><span class="nx">x</span><span class="p">;</span><span class="w"></span>
<span class="w"> </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<h4 id="arguments">arguments 对象<a class="headerlink" href="#arguments" title="Permanent link">&para;</a></h4>
<p>JavaScript还有一个免费赠送的关键字arguments，它只在函数内部起作用，并且永远指向当前函数的调用者传入的所有参数。arguments 类似 Array，但它不是一个Array。</p>
<div class="highlight"><pre><span></span><code><span class="kd">function</span><span class="w"> </span><span class="nx">foo</span><span class="p">(</span><span class="nx">x</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;x = &#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">x</span><span class="p">);</span><span class="w"> </span><span class="c1">// 10</span><span class="w"></span>
<span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">var</span><span class="w"> </span><span class="nx">i</span><span class="o">=</span><span class="mf">0</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">&lt;</span><span class="nx">arguments</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;arg &#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39; = &#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">arguments</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span><span class="w"> </span><span class="c1">// 10, 20, 30</span><span class="w"></span>
<span class="w"> </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
<span class="nx">foo</span><span class="p">(</span><span class="mf">10</span><span class="p">,</span><span class="w"> </span><span class="mf">20</span><span class="p">,</span><span class="w"> </span><span class="mf">30</span><span class="p">);</span><span class="w"></span>

<span class="c1">// 根据是否传入了该参数进行相应处理</span><span class="w"></span>
<span class="kd">function</span><span class="w"> </span><span class="nx">abs</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">arguments</span><span class="p">.</span><span class="nx">length</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span><span class="w"></span>
<span class="w"> </span><span class="p">}</span><span class="w"></span>
<span class="w"> </span><span class="kd">var</span><span class="w"> </span><span class="nx">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">arguments</span><span class="p">[</span><span class="mf">0</span><span class="p">];</span><span class="w"></span>
<span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="nx">x</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mf">0</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">x</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="o">-</span><span class="nx">x</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
<span class="nx">abs</span><span class="p">();</span><span class="w"> </span><span class="c1">// 0</span><span class="w"></span>
<span class="nx">abs</span><span class="p">(</span><span class="mf">10</span><span class="p">);</span><span class="w"> </span><span class="c1">// 10</span><span class="w"></span>
<span class="nx">abs</span><span class="p">(</span><span class="o">-</span><span class="mf">9</span><span class="p">);</span><span class="w"> </span><span class="c1">// 9</span><span class="w"></span>
</code></pre></div>
<ul>
<li>参数通过值传递<ul>
<li>函数调用中的参数（parameter）是函数的参数（argument）。</li>
<li>JavaScript 参数通过值传递：函数只知道值，而不是参数的位置。</li>
<li>如果函数改变了参数的值，它不会改变参数的原始值。</li>
</ul>
</li>
<li>对象是由引用传递的<ul>
<li>在 JavaScript 中，<strong>对象引用是值</strong>。</li>
<li>正因如此，对象的行为就像它们通过引用来传递：</li>
<li>如果函数改变了对象属性，它也改变了原始值。</li>
</ul>
</li>
</ul>
<h4 id="function">Function() 构造器<a class="headerlink" href="#function" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="kd">var</span><span class="w"> </span><span class="nx">myFunction</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Function</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;b&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;return a * b&quot;</span><span class="p">);</span><span class="w"></span>
<span class="c1">// 等价</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">myFunction</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="w"> </span><span class="nx">b</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="k">return</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">b</span><span class="p">};</span><span class="w"></span>
</code></pre></div>
<p>大多数情况下，您可以避免在 JavaScript 中使用 new 关键词。</p>
<h4 id="rest">rest 参数<a class="headerlink" href="#rest" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="kd">function</span><span class="w"> </span><span class="nx">foo</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="w"> </span><span class="nx">b</span><span class="p">,</span><span class="w"> </span><span class="p">...</span><span class="nx">rest</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;a = &#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">a</span><span class="p">);</span><span class="w"></span>
<span class="w"> </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;b = &#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">b</span><span class="p">);</span><span class="w"></span>
<span class="w"> </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">rest</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="nx">foo</span><span class="p">(</span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="mf">2</span><span class="p">,</span><span class="w"> </span><span class="mf">3</span><span class="p">,</span><span class="w"> </span><span class="mf">4</span><span class="p">,</span><span class="w"> </span><span class="mf">5</span><span class="p">);</span><span class="w"></span>
<span class="c1">// 结果:</span><span class="w"></span>
<span class="c1">// a = 1</span><span class="w"></span>
<span class="c1">// b = 2</span><span class="w"></span>
<span class="c1">// Array [ 3, 4, 5 ]</span><span class="w"></span>

<span class="nx">foo</span><span class="p">(</span><span class="mf">1</span><span class="p">);</span><span class="w"></span>
<span class="c1">// 结果:</span><span class="w"></span>
<span class="c1">// a = 1</span><span class="w"></span>
<span class="c1">// b = undefined</span><span class="w"></span>
<span class="c1">// Array []</span><span class="w"></span>
</code></pre></div>
<ul>
<li>rest参数只能写在最后，前面用&hellip;标识，从运行结果可知，传入的参数先绑定a、b，多余的参数以数组形式交给变量rest。</li>
<li>注意：若调用函数是未赋值，则为使用的参数默认值为 undefined，而 rest 则是空数组。</li>
</ul>
<h3 id="_13">变量作用域<a class="headerlink" href="#_13" title="Permanent link">&para;</a></h3>
<p>由于JavaScript的函数可以嵌套，此时，内部函数可以访问外部函数定义的变量，反过来则不行.</p>
<div class="highlight"><pre><span></span><code><span class="kd">function</span><span class="w"> </span><span class="nx">foo</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="kd">var</span><span class="w"> </span><span class="nx">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1</span><span class="p">;</span><span class="w"></span>
<span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">bar</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="kd">var</span><span class="w"> </span><span class="nx">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">1</span><span class="p">;</span><span class="w"> </span><span class="c1">// bar可以访问foo的变量x!</span><span class="w"></span>
<span class="w"> </span><span class="p">}</span><span class="w"></span>
<span class="w"> </span><span class="kd">var</span><span class="w"> </span><span class="nx">z</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">y</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">1</span><span class="p">;</span><span class="w"> </span><span class="c1">// ReferenceError! foo不可以访问bar的变量y!</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<h4 id="_14">变量提升<a class="headerlink" href="#_14" title="Permanent link">&para;</a></h4>
<p>JavaScript的函数定义有个特点，它会先扫描整个函数体的语句，把所有申明的变量“提升”到函数顶部。下例中，虽然是strict模式，但语句 <code>var x = 'Hello, ' + y;</code> 并不报错，原因是变量y在稍后申明了。但是console.log显示Hello, undefined，说明变量y的值为 undefined。<strong>这正是因为JavaScript引擎自动提升了变量y的声明，但不会提升变量y的赋值</strong>。</p>
<div class="highlight"><pre><span></span><code><span class="s1">&#39;use strict&#39;</span><span class="p">;</span><span class="w"></span>

<span class="kd">function</span><span class="w"> </span><span class="nx">foo</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="kd">var</span><span class="w"> </span><span class="nx">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Hello, &#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">y</span><span class="p">;</span><span class="w"></span>
<span class="w"> </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">x</span><span class="p">);</span><span class="w"></span>
<span class="w"> </span><span class="kd">var</span><span class="w"> </span><span class="nx">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Bob&#39;</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="nx">foo</span><span class="p">();</span><span class="w"></span>
</code></pre></div>
<p>由于JavaScript的这一怪异的“特性”，我们在函数内部定义变量时，请严格遵守“在函数内部首先申明所有变量”这一规则。最常见的做法是用一个var申明函数内部用到的所有变量.</p>
<div class="highlight"><pre><span></span><code><span class="kd">function</span><span class="w"> </span><span class="nx">foo</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="kd">var</span><span class="w"></span>
<span class="w">  </span><span class="nx">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="c1">// x初始化为1</span><span class="w"></span>
<span class="w">  </span><span class="nx">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="c1">// y初始化为2</span><span class="w"></span>
<span class="w">  </span><span class="nx">z</span><span class="p">,</span><span class="w"> </span><span class="nx">i</span><span class="p">;</span><span class="w"> </span><span class="c1">// z和i为undefined</span><span class="w"></span>
<span class="w"> </span><span class="c1">// 其他语句:</span><span class="w"></span>
<span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="nx">i</span><span class="o">=</span><span class="mf">0</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">&lt;</span><span class="mf">100</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="p">...</span><span class="w"></span>
<span class="w"> </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<h4 id="_15">全局作用域<a class="headerlink" href="#_15" title="Permanent link">&para;</a></h4>
<ul>
<li>不在任何函数内定义的变量就具有全局作用域。实际上，JavaScript默认有一个全局对象window，全局作用域的变量实际上被绑定到window的一个属性。</li>
<li>由于函数定义有两种方式，以变量方式var foo = function () {}定义的函数实际上也是一个全局变量，因此，顶层函数的定义也被视为一个全局变量，并绑定到window对象。</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="kd">var</span><span class="w"> </span><span class="nx">course</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Learn JavaScript&#39;</span><span class="p">;</span><span class="w"></span>
<span class="nx">alert</span><span class="p">(</span><span class="nx">course</span><span class="p">);</span><span class="w"> </span><span class="c1">// &#39;Learn JavaScript&#39;</span><span class="w"></span>
<span class="nx">alert</span><span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">course</span><span class="p">);</span><span class="w"> </span><span class="c1">// &#39;Learn JavaScript&#39;</span><span class="w"></span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1">// 事实上，我们每次直接调用的alert()函数其实也是window的一个变量</span><span class="w"></span>
<span class="nb">window</span><span class="p">.</span><span class="nx">alert</span><span class="p">(</span><span class="s1">&#39;调用window.alert()&#39;</span><span class="p">);</span><span class="w"></span>
<span class="c1">// 把alert保存到另一个变量:</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">old_alert</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">window</span><span class="p">.</span><span class="nx">alert</span><span class="p">;</span><span class="w"></span>
<span class="c1">// 给alert赋一个新函数:</span><span class="w"></span>
<span class="nb">window</span><span class="p">.</span><span class="nx">alert</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>
<span class="nx">alert</span><span class="p">(</span><span class="s1">&#39;无法用alert()显示了!&#39;</span><span class="p">);</span><span class="w"></span>
<span class="c1">// 恢复alert:</span><span class="w"></span>
<span class="nb">window</span><span class="p">.</span><span class="nx">alert</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">old_alert</span><span class="p">;</span><span class="w"></span>
<span class="nx">alert</span><span class="p">(</span><span class="s1">&#39;又可以用alert()了!&#39;</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p><strong>这说明JavaScript实际上只有一个全局作用域</strong>。任何变量（函数也视为变量），如果没有在当前函数作用域中找到，就会继续往上查找，最后如果在全局作用域中也没有找到，则报ReferenceError错误。</p>
<h4 id="_16">命名空间<a class="headerlink" href="#_16" title="Permanent link">&para;</a></h4>
<ul>
<li>全局变量会绑定到window上，不同的JavaScript文件如果使用了相同的全局变量，或者定义了相同名字的顶层函数，都会造成命名冲突，并且很难被发现。</li>
<li>减少冲突的一个方法是把自己的所有变量和函数全部绑定到一个全局变量中。</li>
<li>许多著名的JavaScript库都是这么干的：jQuery，YUI，underscore等等。</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="c1">// 唯一的全局变量MYAPP:</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">MYAPP</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{};</span><span class="w"></span>

<span class="c1">// 其他变量:</span><span class="w"></span>
<span class="nx">MYAPP</span><span class="p">.</span><span class="nx">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;myapp&#39;</span><span class="p">;</span><span class="w"></span>
<span class="nx">MYAPP</span><span class="p">.</span><span class="nx">version</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0</span><span class="p">;</span><span class="w"></span>

<span class="c1">// 其他函数:</span><span class="w"></span>
<span class="nx">MYAPP</span><span class="p">.</span><span class="nx">foo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="s1">&#39;foo&#39;</span><span class="p">;</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>
</code></pre></div>
<h4 id="let">局部作用域 let<a class="headerlink" href="#let" title="Permanent link">&para;</a></h4>
<ul>
<li>由于JavaScript的变量作用域实际上是函数内部，我们在for循环等语句块中是无法定义具有局部作用域的变量的。</li>
<li>为了解决块级作用域，ES6引入了新的关键字 <code>let</code>，用let替代var可以申明一个块级作用域的变量。</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="kd">function</span><span class="w"> </span><span class="nx">foo</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">var</span><span class="w"> </span><span class="nx">i</span><span class="o">=</span><span class="mf">0</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">&lt;</span><span class="mf">100</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="c1">//</span><span class="w"></span>
<span class="w"> </span><span class="p">}</span><span class="w"></span>
<span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="mf">100</span><span class="p">;</span><span class="w"> </span><span class="c1">// 仍然可以引用变量i</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kd">function</span><span class="w"> </span><span class="nx">foo</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="kd">var</span><span class="w"> </span><span class="nx">sum</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span><span class="w"></span>
<span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">let</span><span class="w"> </span><span class="nx">i</span><span class="o">=</span><span class="mf">0</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">&lt;</span><span class="mf">100</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="nx">sum</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="nx">i</span><span class="p">;</span><span class="w"></span>
<span class="w"> </span><span class="p">}</span><span class="w"></span>
<span class="w"> </span><span class="c1">// SyntaxError:</span><span class="w"></span>
<span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="mf">1</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<h4 id="const">常量 const<a class="headerlink" href="#const" title="Permanent link">&para;</a></h4>
<ul>
<li>ES6标准引入了新的关键字 <code>const</code> 来定义常量，const与let都具有块级作用域。</li>
</ul>
<h3 id="_17">解构赋值<a class="headerlink" href="#_17" title="Permanent link">&para;</a></h3>
<ul>
<li>【类似 Python 中的序列解包】</li>
<li>如果需要从一个对象中取出若干属性，也可以使用解构赋值，便于快速获取对象的指定属性。<ul>
<li>注意，对数组元素进行解构赋值时，多个变量要用<code>[...]</code>括起来。<ul>
<li>支持嵌套</li>
</ul>
</li>
<li>解构赋值还可以忽略某些元素</li>
<li>如果需要从一个对象中取出若干属性，也可以使用解构赋值，便于快速获取对象的指定属性<ul>
<li>例如, <code>var {name, address: {city, zip}} = person;</code>, 注意此时没有声明 address 变量</li>
<li>同样可以直接对嵌套的对象属性进行赋值，只要保证对应的层次是一致的</li>
<li>使用解构赋值对对象属性进行赋值时，如果对应的属性不存在，变量将被赋值为 <code>undefined</code>，这和引用一个不存在的属性获得undefined是一致的</li>
<li>可以使用别名, 例如 <code>let {name, passport:id} = person;</code>, 注意此时没有声明 passport 变量, 它仅仅是为了取出 person 对象的 passport 属性赋值给 id</li>
<li>设置默认值 (替代 undefined) <code>var {name, single=true} = person;</code></li>
<li>如果变量已经声明过了, 为了避免被引擎解释为块代码 <code>{}</code>, 可以加上括号将解构赋值写成 <code>({x, y} = { name: '小明', x: 100, y: 200});</code></li>
</ul>
</li>
</ul>
</li>
<li>案例<ul>
<li>交换变量的值, <code>[x, y] = [y, x]</code></li>
<li>如果一个函数接收一个对象作为参数，那么，可以使用解构直接把对象的属性绑定到变量中<ul>
<li>例如 <code>function buildDate({year, month, day, hour=0, minute=0, second=0}) {}</code></li>
</ul>
</li>
</ul>
</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="kd">let</span><span class="w"> </span><span class="p">[</span><span class="nx">x</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="nx">y</span><span class="p">,</span><span class="w"> </span><span class="nx">z</span><span class="p">]]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s1">&#39;hello&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="s1">&#39;JavaScript&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;ES6&#39;</span><span class="p">]];</span><span class="w"></span>
<span class="nx">x</span><span class="p">;</span><span class="w"> </span><span class="c1">// &#39;hello&#39;</span><span class="w"></span>
<span class="nx">y</span><span class="p">;</span><span class="w"> </span><span class="c1">// &#39;JavaScript&#39;</span><span class="w"></span>
<span class="nx">z</span><span class="p">;</span><span class="w"> </span><span class="c1">// &#39;ES6&#39;</span><span class="w"></span>

<span class="kd">let</span><span class="w"> </span><span class="p">[,</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="nx">z</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s1">&#39;hello&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;JavaScript&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;ES6&#39;</span><span class="p">];</span><span class="w"> </span><span class="c1">// 忽略前两个元素，只对z赋值第三个元素</span><span class="w"></span>
<span class="nx">z</span><span class="p">;</span><span class="w"> </span><span class="c1">// &#39;ES6&#39;</span><span class="w"></span>


<span class="c1">// 对象的解构赋值还可以嵌套</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">person</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;小明&#39;</span><span class="p">,</span><span class="w"></span>
<span class="w"> </span><span class="nx">age</span><span class="o">:</span><span class="w"> </span><span class="mf">20</span><span class="p">,</span><span class="w"></span>
<span class="w"> </span><span class="nx">gender</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;male&#39;</span><span class="p">,</span><span class="w"></span>
<span class="w"> </span><span class="nx">passport</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;G-12345678&#39;</span><span class="p">,</span><span class="w"></span>
<span class="w"> </span><span class="nx">school</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;No.4 middle school&#39;</span><span class="p">,</span><span class="w"></span>
<span class="w"> </span><span class="nx">address</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="nx">city</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Beijing&#39;</span><span class="p">,</span><span class="w"></span>
<span class="w">  </span><span class="nx">street</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;No.1 Road&#39;</span><span class="p">,</span><span class="w"></span>
<span class="w">  </span><span class="nx">zipcode</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;100001&#39;</span><span class="w"></span>
<span class="w"> </span><span class="p">}</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="p">{</span><span class="nx">name</span><span class="p">,</span><span class="w"> </span><span class="nx">address</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="nx">city</span><span class="p">,</span><span class="w"> </span><span class="nx">zip</span><span class="p">}}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">person</span><span class="p">;</span><span class="w"></span>
<span class="nx">name</span><span class="p">;</span><span class="w"> </span><span class="c1">// &#39;小明&#39;</span><span class="w"></span>
<span class="nx">city</span><span class="p">;</span><span class="w"> </span><span class="c1">// &#39;Beijing&#39;</span><span class="w"></span>
<span class="nx">zip</span><span class="p">;</span><span class="w"> </span><span class="c1">// undefined, 因为属性名是zipcode而不是zip</span><span class="w"></span>
<span class="c1">// 注意: address不是变量，而是为了让city和zip获得嵌套的address对象的属性:</span><span class="w"></span>
<span class="nx">address</span><span class="p">;</span><span class="w"> </span><span class="c1">// Uncaught ReferenceError: address is not defined</span><span class="w"></span>
</code></pre></div>
<ul>
<li>使用解构赋值对对象属性进行赋值时，如果对应的属性不存在，变量将被赋值为undefined，这和引用一个不存在的属性获得undefined是一致的。如果要使用的变量名和属性名不一致，可以后面加冒号。</li>
<li>解构赋值还可以使用默认值，这样就避免了不存在的属性返回undefined的问题。</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="kd">var</span><span class="w"> </span><span class="nx">person</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;小明&#39;</span><span class="p">,</span><span class="w"></span>
<span class="w"> </span><span class="nx">age</span><span class="o">:</span><span class="w"> </span><span class="mf">20</span><span class="p">,</span><span class="w"></span>
<span class="w"> </span><span class="nx">gender</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;male&#39;</span><span class="p">,</span><span class="w"></span>
<span class="w"> </span><span class="nx">passport</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;G-12345678&#39;</span><span class="p">,</span><span class="w"></span>
<span class="w"> </span><span class="nx">school</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;No.4 middle school&#39;</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="c1">// 把passport属性赋值给变量id:</span><span class="w"></span>
<span class="kd">let</span><span class="w"> </span><span class="p">{</span><span class="nx">name</span><span class="p">,</span><span class="w"> </span><span class="nx">passport</span><span class="o">:</span><span class="nx">id</span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">person</span><span class="p">;</span><span class="w"></span>
<span class="nx">name</span><span class="p">;</span><span class="w"> </span><span class="c1">// &#39;小明&#39;</span><span class="w"></span>
<span class="nx">id</span><span class="p">;</span><span class="w"> </span><span class="c1">// &#39;G-12345678&#39;</span><span class="w"></span>
<span class="c1">// 注意: passport不是变量，而是为了让变量id获得passport属性:</span><span class="w"></span>
<span class="nx">passport</span><span class="p">;</span><span class="w"> </span><span class="c1">// Uncaught ReferenceError: passport is not defined</span><span class="w"></span>


<span class="c1">// 如果person对象没有single属性，默认赋值为true:</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="p">{</span><span class="nx">name</span><span class="p">,</span><span class="w"> </span><span class="nx">single</span><span class="o">=</span><span class="kc">true</span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">person</span><span class="p">;</span><span class="w"></span>
<span class="nx">name</span><span class="p">;</span><span class="w"> </span><span class="c1">// &#39;小明&#39;</span><span class="w"></span>
<span class="nx">single</span><span class="p">;</span><span class="w"> </span><span class="c1">// true</span><span class="w"></span>
</code></pre></div>
<p>注意下面的例子，这是因为JavaScript引擎把 { 开头的语句当作了块处理，于是=不再合法。解决方法是用小括号括起来。</p>
<div class="highlight"><pre><span></span><code><span class="c1">// 声明变量:</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">x</span><span class="p">,</span><span class="w"> </span><span class="nx">y</span><span class="p">;</span><span class="w"></span>
<span class="c1">// 解构赋值:</span><span class="w"></span>
<span class="p">{</span><span class="nx">x</span><span class="p">,</span><span class="w"> </span><span class="nx">y</span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;小明&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">x</span><span class="o">:</span><span class="w"> </span><span class="mf">100</span><span class="p">,</span><span class="w"> </span><span class="nx">y</span><span class="o">:</span><span class="w"> </span><span class="mf">200</span><span class="p">};</span><span class="w"></span>
<span class="c1">// 语法错误: Uncaught SyntaxError: Unexpected token =</span><span class="w"></span>

<span class="c1">// 加一个 () 来避免</span><span class="w"></span>
<span class="p">({</span><span class="nx">x</span><span class="p">,</span><span class="w"> </span><span class="nx">y</span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;小明&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">x</span><span class="o">:</span><span class="w"> </span><span class="mf">100</span><span class="p">,</span><span class="w"> </span><span class="nx">y</span><span class="o">:</span><span class="w"> </span><span class="mf">200</span><span class="p">});</span><span class="w"></span>
</code></pre></div>
<h5 id="_18">案例<a class="headerlink" href="#_18" title="Permanent link">&para;</a></h5>
<ul>
<li>交换变量的值, <code>[x, y] = [y, x]</code></li>
<li>如果一个函数接收一个对象作为参数，那么，可以使用解构直接把对象的属性绑定到变量中<ul>
<li>例如 <code>function buildDate({year, month, day, hour=0, minute=0, second=0}) {}</code></li>
</ul>
</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="c1">// 交换变量</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">x</span><span class="o">=</span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="nx">y</span><span class="o">=</span><span class="mf">2</span><span class="p">;</span><span class="w"></span>
<span class="p">[</span><span class="nx">x</span><span class="p">,</span><span class="w"> </span><span class="nx">y</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="nx">y</span><span class="p">,</span><span class="w"> </span><span class="nx">x</span><span class="p">]</span><span class="w"></span>

<span class="c1">// 快速获取当前页面的域名和路径</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="p">{</span><span class="nx">hostname</span><span class="o">:</span><span class="nx">domain</span><span class="p">,</span><span class="w"> </span><span class="nx">pathname</span><span class="o">:</span><span class="nx">path</span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">location</span><span class="p">;</span><span class="w"></span>
</code></pre></div>
<p>如果一个函数接收一个对象作为参数，那么，可以使用解构直接把对象的属性绑定到变量中。例如，下面的函数可以快速创建一个Date对象。它的方便之处在于传入的对象只需要year、month和day这三个属性。也可以传入hour、minute和second属性。</p>
<div class="highlight"><pre><span></span><code><span class="kd">function</span><span class="w"> </span><span class="nx">buildDate</span><span class="p">({</span><span class="nx">year</span><span class="p">,</span><span class="w"> </span><span class="nx">month</span><span class="p">,</span><span class="w"> </span><span class="nx">day</span><span class="p">,</span><span class="w"> </span><span class="nx">hour</span><span class="o">=</span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="nx">minute</span><span class="o">=</span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="nx">second</span><span class="o">=</span><span class="mf">0</span><span class="p">})</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Date</span><span class="p">(</span><span class="nx">year</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;-&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">month</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;-&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">day</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39; &#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">hour</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;:&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">minute</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;:&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">second</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="nx">buildDate</span><span class="p">({</span><span class="w"> </span><span class="nx">year</span><span class="o">:</span><span class="w"> </span><span class="mf">2017</span><span class="p">,</span><span class="w"> </span><span class="nx">month</span><span class="o">:</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="nx">day</span><span class="o">:</span><span class="w"> </span><span class="mf">1</span><span class="w"> </span><span class="p">});</span><span class="w"></span>
<span class="c1">// Sun Jan 01 2017 00:00:00 GMT+0800 (CST)</span><span class="w"></span>
<span class="nx">buildDate</span><span class="p">({</span><span class="w"> </span><span class="nx">year</span><span class="o">:</span><span class="w"> </span><span class="mf">2017</span><span class="p">,</span><span class="w"> </span><span class="nx">month</span><span class="o">:</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="nx">day</span><span class="o">:</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="nx">hour</span><span class="o">:</span><span class="w"> </span><span class="mf">20</span><span class="p">,</span><span class="w"> </span><span class="nx">minute</span><span class="o">:</span><span class="w"> </span><span class="mf">15</span><span class="w"> </span><span class="p">});</span><span class="w"></span>
<span class="c1">// Sun Jan 01 2017 20:15:00 GMT+0800 (CST)</span><span class="w"></span>
</code></pre></div>
<h3 id="_19">方法<a class="headerlink" href="#_19" title="Permanent link">&para;</a></h3>
<ul>
<li>在一个对象中绑定函数，称为这个对象的方法。</li>
<li><code>this</code> 是一个特殊变量，它始终指向当前对象;<ul>
<li>在非严格模式下, 全局变量 this 指向的是全局 window 对象 (因此有 <code>this === window</code>), 因此想要将 object 中的方法分离成全局的函数, 函数内部使用的 this 指向就有问题</li>
<li>在严格模式下, 定义 this 为 undefined</li>
</ul>
</li>
<li>要指定函数的this指向哪个对象，可以用函数本身的 <code>apply</code> 方法<ul>
<li>它接收两个参数，第一个参数就是需要绑定的this变量，第二个参数是Array，表示函数本身的参数。</li>
<li>例如, <code>getAge.apply(xiaoming, []);</code> 将 getAge 函数内的 this 定义为 xiaoming 这个 object, 从而能够得到其出生日期</li>
</ul>
</li>
<li>另一个相关的是 <code>call()</code> 方法, 区别在于<code>call()</code> 把参数按顺序传入。<ul>
<li>例如, 可以 <code>Math.max.apply(null, [3, 5, 4]);</code>, <code>Math.max.call(null, 3, 5, 4);</code></li>
</ul>
</li>
</ul>
<h4 id="this">this 关键词<a class="headerlink" href="#this" title="Permanent link">&para;</a></h4>
<ul>
<li>JavaScript this 关键词指的是它所属的对象。它拥有不同的值，具体取决于它的使用位置：<ul>
<li>在方法中，this 指的是所有者对象。</li>
<li>单独的情况下，this 指的是全局对象。</li>
<li>在函数中，this 指的是全局对象。</li>
<li>在函数中，严格模式下，this 是 undefined。</li>
<li>在事件中，this 指的是接收事件的元素。【HTML 元素, 见下】</li>
</ul>
</li>
<li>像 call() 和 apply() 这样的方法可以将 this 引用到任何对象。</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">button</span> <span class="na">onclick</span><span class="o">=</span><span class="s">&quot;this.style.display=&#39;none&#39;&quot;</span><span class="p">&gt;</span>
  点击来删除我！
<span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
</code></pre></div>
<p>对象的方法</p>
<div class="highlight"><pre><span></span><code><span class="kd">var</span><span class="w"> </span><span class="nx">xiaoming</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;小明&#39;</span><span class="p">,</span><span class="w"></span>
<span class="w"> </span><span class="nx">birth</span><span class="o">:</span><span class="w"> </span><span class="mf">1990</span><span class="p">,</span><span class="w"></span>
<span class="w"> </span><span class="nx">age</span><span class="o">:</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="kd">var</span><span class="w"> </span><span class="nx">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Date</span><span class="p">().</span><span class="nx">getFullYear</span><span class="p">();</span><span class="w"></span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">y</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">birth</span><span class="p">;</span><span class="w"></span>
<span class="w"> </span><span class="p">}</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="nx">xiaoming</span><span class="p">.</span><span class="nx">age</span><span class="p">;</span><span class="w"> </span><span class="c1">// function xiaoming.age()</span><span class="w"></span>
<span class="nx">xiaoming</span><span class="p">.</span><span class="nx">age</span><span class="p">();</span><span class="w"> </span><span class="c1">// 今年调用是25,明年调用就变成26了</span><span class="w"></span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="kd">function</span><span class="w"> </span><span class="nx">getAge</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="kd">var</span><span class="w"> </span><span class="nx">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Date</span><span class="p">().</span><span class="nx">getFullYear</span><span class="p">();</span><span class="w"></span>
<span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="nx">y</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">birth</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kd">var</span><span class="w"> </span><span class="nx">xiaoming</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;小明&#39;</span><span class="p">,</span><span class="w"></span>
<span class="w"> </span><span class="nx">birth</span><span class="o">:</span><span class="w"> </span><span class="mf">1990</span><span class="p">,</span><span class="w"></span>
<span class="w"> </span><span class="nx">age</span><span class="o">:</span><span class="w"> </span><span class="nx">getAge</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="nx">xiaoming</span><span class="p">.</span><span class="nx">age</span><span class="p">();</span><span class="w"> </span><span class="c1">// 25, 正常结果</span><span class="w"></span>
<span class="nx">getAge</span><span class="p">();</span><span class="w"> </span><span class="c1">// NaN</span><span class="w"></span>
<span class="c1">// 下面这样也不行</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">fn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">xiaoming</span><span class="p">.</span><span class="nx">age</span><span class="p">;</span><span class="w"> </span><span class="c1">// 先拿到xiaoming的age函数</span><span class="w"></span>
<span class="nx">fn</span><span class="p">();</span><span class="w"> </span><span class="c1">// NaN</span><span class="w"></span>
<span class="c1">// 而在 strict 模式下，上面这种先取出对象方法然后调用会报错</span><span class="w"></span>
<span class="nx">fn</span><span class="p">();</span><span class="w"> </span><span class="c1">// Uncaught TypeError: Cannot read property &#39;birth&#39; of undefined</span><span class="w"></span>
</code></pre></div>
<ul>
<li>注意到，上面单独调用 getAge 函数，或者在非 strict 模式下将对象方法取出作为函数，则其（this）指向的是全局对象，也就是 <code>window</code>，因此可能对象没有该属性/方法；</li>
<li>而在 strict 模式下，重新拿到的对象方法指向的是 <code>undefined</code>，这时候调用其属性/方法会报错。</li>
</ul>
<h4 id="apply-call">apply(), call()<a class="headerlink" href="#apply-call" title="Permanent link">&para;</a></h4>
<ul>
<li>虽然在一个独立的函数调用中，根据是否是strict模式，this指向undefined或window，不过，我们还是可以控制this的指向的！</li>
<li>要指定函数的this指向哪个对象，可以用函数本身的 <code>apply</code> 方法<ul>
<li>它接收两个参数，第一个参数就是需要绑定的this变量，第二个参数是Array，表示函数本身的参数。</li>
</ul>
</li>
<li>另一个相关的是 <code>call()</code> 方法, 区别在于<code>call()</code> 把参数按顺序传入。</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="kd">function</span><span class="w"> </span><span class="nx">getAge</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="kd">var</span><span class="w"> </span><span class="nx">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Date</span><span class="p">().</span><span class="nx">getFullYear</span><span class="p">();</span><span class="w"></span>
<span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="nx">y</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">birth</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kd">var</span><span class="w"> </span><span class="nx">xiaoming</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;小明&#39;</span><span class="p">,</span><span class="w"></span>
<span class="w"> </span><span class="nx">birth</span><span class="o">:</span><span class="w"> </span><span class="mf">1990</span><span class="p">,</span><span class="w"></span>
<span class="w"> </span><span class="nx">age</span><span class="o">:</span><span class="w"> </span><span class="nx">getAge</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="nx">xiaoming</span><span class="p">.</span><span class="nx">age</span><span class="p">();</span><span class="w"> </span><span class="c1">// 25</span><span class="w"></span>
<span class="nx">getAge</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="nx">xiaoming</span><span class="p">,</span><span class="w"> </span><span class="p">[]);</span><span class="w"> </span><span class="c1">// 25, this指向xiaoming, 参数为空</span><span class="w"></span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1">// 比如调用Math.max(3, 5, 4)，分别用apply()和call()实现如下：</span><span class="w"></span>
<span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="mf">3</span><span class="p">,</span><span class="w"> </span><span class="mf">5</span><span class="p">,</span><span class="w"> </span><span class="mf">4</span><span class="p">]);</span><span class="w"> </span><span class="c1">// 5</span><span class="w"></span>
<span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span><span class="w"> </span><span class="mf">3</span><span class="p">,</span><span class="w"> </span><span class="mf">5</span><span class="p">,</span><span class="w"> </span><span class="mf">4</span><span class="p">);</span><span class="w"> </span><span class="c1">// 5</span><span class="w"></span>
</code></pre></div>
<p>另一个例子</p>
<div class="highlight"><pre><span></span><code><span class="kd">var</span><span class="w"> </span><span class="nx">person</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="nx">fullName</span><span class="o">:</span><span class="w"> </span><span class="kd">function</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">firstName</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">&quot; &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">lastName</span><span class="p">;</span><span class="w"></span>
<span class="w"> </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">person1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="nx">firstName</span><span class="o">:</span><span class="s2">&quot;Bill&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w"> </span><span class="nx">lastName</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Gates&quot;</span><span class="p">,</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
<span class="nx">person</span><span class="p">.</span><span class="nx">fullName</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">person1</span><span class="p">);</span><span class="w">  </span><span class="c1">// 将返回 &quot;Bill Gates&quot;</span><span class="w"></span>
</code></pre></div>
<h4 id="_20">装饰器<a class="headerlink" href="#_20" title="Permanent link">&para;</a></h4>
<ul>
<li>利用apply()，我们还可以动态改变函数的行为。</li>
<li>JavaScript的所有对象都是动态的，即使内置的函数，我们也可以重新指向新的函数。</li>
<li>现在假定我们想统计一下代码一共调用了多少次parseInt()，可以把所有的调用都找出来，然后手动加上count += 1，不过这样做太傻了。最佳方案是用我们自己的函数替换掉默认的parseInt()。</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="kd">var</span><span class="w"> </span><span class="nx">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">oldParseInt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">parseInt</span><span class="p">;</span><span class="w"> </span><span class="c1">// 保存原函数</span><span class="w"></span>

<span class="nb">window</span><span class="p">.</span><span class="nb">parseInt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="nx">count</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="mf">1</span><span class="p">;</span><span class="w"></span>
<span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="nx">oldParseInt</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span><span class="w"> </span><span class="nx">arguments</span><span class="p">);</span><span class="w"> </span><span class="c1">// 调用原函数</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="c1">// 测试:</span><span class="w"></span>
<span class="nb">parseInt</span><span class="p">(</span><span class="s1">&#39;10&#39;</span><span class="p">);</span><span class="w"></span>
<span class="nb">parseInt</span><span class="p">(</span><span class="s1">&#39;20&#39;</span><span class="p">);</span><span class="w"></span>
<span class="nb">parseInt</span><span class="p">(</span><span class="s1">&#39;30&#39;</span><span class="p">);</span><span class="w"></span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;count = &#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">count</span><span class="p">);</span><span class="w"> </span><span class="c1">// 3</span><span class="w"></span>
</code></pre></div>
<h3 id="higher-order-function">高阶函数 Higher-order function<a class="headerlink" href="#higher-order-function" title="Permanent link">&para;</a></h3>
<p>查看 Array 的内置方法 <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array">https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array</a></p>
<ul>
<li>map<ul>
<li><code>arr.map(function (x) {});</code></li>
<li>注意, 这里回调函数只用了 Array 的value, 但实际上 map 支持的回调函数类型还包括 <code>map((element, index, array) =&gt; { /* ... */ })</code> 等,</li>
<li>因此, 若采用 <code>arr.map(parseInt);</code>, 由于 parseInt 支持第二个参数指定进制, 因此调用会变成 <code>parseInt(arr[i], i)</code>, 会出错</li>
<li>可以写成 <code>arr.map(c=&gt;parseInt(c));</code></li>
</ul>
</li>
<li>reduce<ul>
<li><code>arr.reduce(function (x, y) {})</code></li>
<li>同样支持 <code>reduce((previousValue, currentValue, currentIndex, array) =&gt; { /* ... */ } )</code></li>
</ul>
</li>
<li><code>filter()</code>把传入的函数依次作用于每个元素，然后根据返回值是<code>true</code>还是<code>false</code>决定保留还是丢弃该元素</li>
<li>sort<ul>
<li><code>sort((firstEl, secondEl) =&gt; { /* ... */ } )</code></li>
<li>注意, js 根据比较函数的返回值来决定是否调整两个元素之间的位置, 0 表示不变, 负数表示 firstEl 应该排在 secondEl 前面; 因此, 一般返回 -1, 0, 1</li>
</ul>
</li>
<li>every()</li>
<li>find(), findIndex() 搜索 Array 中第一个满足条件的元素, 分别返回元素和 index; 找不到时分别返回 undefined 和 -1</li>
<li>forEach()<ul>
<li><code>forEach()</code>和<code>map()</code>类似，它也把每个元素依次作用于传入的函数，但不会返回新的数组。<code>forEach()</code>常用于遍历数组，因此，传入的函数不需要返回值</li>
</ul>
</li>
</ul>
<p>JavaScript的函数其实都指向某个变量。既然变量可以指向函数，函数的参数能接收变量，那么一个函数就可以接收另一个函数作为参数，这种函数就称之为高阶函数。</p>
<div class="highlight"><pre><span></span><code><span class="kd">function</span><span class="w"> </span><span class="nx">add</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span><span class="w"> </span><span class="nx">y</span><span class="p">,</span><span class="w"> </span><span class="nx">f</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="nx">f</span><span class="p">(</span><span class="nx">x</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">f</span><span class="p">(</span><span class="nx">y</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<h4 id="map-reduce">map, reduce<a class="headerlink" href="#map-reduce" title="Permanent link">&para;</a></h4>
<ul>
<li>map<ul>
<li><code>arr.map(function (x) {});</code></li>
<li>注意, 这里回调函数只用了 Array 的value, 但实际上 map 支持的回调函数类型还包括 <code>map((element, index, array) =&gt; { /* ... */ })</code> 等,</li>
<li>因此, 若采用 <code>arr.map(parseInt);</code>, 由于 parseInt 支持第二个参数指定进制, 因此调用会变成 <code>parseInt(arr[i], i)</code>, 会出错</li>
<li>可以写成 <code>arr.map(c=&gt;parseInt(c));</code></li>
</ul>
</li>
<li>reduce<ul>
<li><code>arr.reduce(function (x, y) {})</code></li>
</ul>
</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="c1">// map</span><span class="w"></span>
<span class="kd">function</span><span class="w"> </span><span class="nx">pow</span><span class="p">(</span><span class="nx">x</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="nx">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">x</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">arr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="mf">2</span><span class="p">,</span><span class="w"> </span><span class="mf">3</span><span class="p">,</span><span class="w"> </span><span class="mf">4</span><span class="p">,</span><span class="w"> </span><span class="mf">5</span><span class="p">,</span><span class="w"> </span><span class="mf">6</span><span class="p">,</span><span class="w"> </span><span class="mf">7</span><span class="p">,</span><span class="w"> </span><span class="mf">8</span><span class="p">,</span><span class="w"> </span><span class="mf">9</span><span class="p">];</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">results</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">arr</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">pow</span><span class="p">);</span><span class="w"> </span><span class="c1">// [1, 4, 9, 16, 25, 36, 49, 64, 81]</span><span class="w"></span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">results</span><span class="p">);</span><span class="w"></span>

<span class="c1">// reduce</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">arr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="mf">3</span><span class="p">,</span><span class="w"> </span><span class="mf">5</span><span class="p">,</span><span class="w"> </span><span class="mf">7</span><span class="p">,</span><span class="w"> </span><span class="mf">9</span><span class="p">];</span><span class="w"></span>
<span class="nx">arr</span><span class="p">.</span><span class="nx">reduce</span><span class="p">(</span><span class="kd">function</span><span class="w"> </span><span class="p">(</span><span class="nx">x</span><span class="p">,</span><span class="w"> </span><span class="nx">y</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="nx">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">y</span><span class="p">;</span><span class="w"></span>
<span class="p">});</span><span class="w"> </span><span class="c1">// 25</span><span class="w"></span>
</code></pre></div>
<h4 id="filter_1">filter 方法<a class="headerlink" href="#filter_1" title="Permanent link">&para;</a></h4>
<ul>
<li><code>filter()</code>把传入的函数依次作用于每个元素，然后根据返回值是<code>true</code>还是<code>false</code>决定保留还是丢弃该元素</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="c1">// 把一个`Array`中的空字符串删掉，可以这么写：</span><span class="w"></span>

<span class="kd">var</span><span class="w"> </span><span class="nx">arr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w"> </span><span class="kc">undefined</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;C&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;  &#39;</span><span class="p">];</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">r</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">arr</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="kd">function</span><span class="w"> </span><span class="p">(</span><span class="nx">s</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="nx">s</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">s</span><span class="p">.</span><span class="nx">trim</span><span class="p">();</span><span class="w"> </span><span class="c1">// 注意：IE9以下的版本没有trim()方法</span><span class="w"></span>
<span class="p">});</span><span class="w"></span>
<span class="nx">r</span><span class="p">;</span><span class="w"> </span><span class="c1">// [&#39;A&#39;, &#39;B&#39;, &#39;C&#39;]</span><span class="w"></span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="cm">/* 去除重复元素 */</span><span class="w"></span>
<span class="kd">var</span><span class="w"></span>
<span class="w"> </span><span class="nx">r</span><span class="p">,</span><span class="w"></span>
<span class="w"> </span><span class="nx">arr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s1">&#39;apple&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;strawberry&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;banana&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;pear&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;apple&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;orange&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;orange&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;strawberry&#39;</span><span class="p">];</span><span class="w"></span>
<span class="nx">r</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">arr</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="kd">function</span><span class="w"> </span><span class="p">(</span><span class="nx">element</span><span class="p">,</span><span class="w"> </span><span class="nx">index</span><span class="p">,</span><span class="w"> </span><span class="nx">self</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="nx">self</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">element</span><span class="p">)</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="nx">index</span><span class="p">;</span><span class="w"></span>
<span class="p">});</span><span class="w"></span>
</code></pre></div>
<h4 id="sort">sort 方法<a class="headerlink" href="#sort" title="Permanent link">&para;</a></h4>
<ul>
<li>sort<ul>
<li><code>sort((firstEl, secondEl) =&gt; { /* ... */ } )</code></li>
<li>注意, js 根据比较函数的返回值来决定是否调整两个元素之间的位置, 0 表示不变, 负数表示 firstEl 应该排在 secondEl 前面; 因此, 一般返回 -1, 0, 1</li>
</ul>
</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="c1">// 注意 sort 默认是转化为字符串排序的 !</span><span class="w"></span>
<span class="c1">// apple排在了最后:</span><span class="w"></span>
<span class="p">[</span><span class="s1">&#39;Google&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;apple&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Microsoft&#39;</span><span class="p">].</span><span class="nx">sort</span><span class="p">();</span><span class="w"> </span><span class="c1">// [&#39;Google&#39;, &#39;Microsoft&quot;, &#39;apple&#39;]</span><span class="w"></span>
<span class="c1">// 无法理解的结果:</span><span class="w"></span>
<span class="p">[</span><span class="mf">10</span><span class="p">,</span><span class="w"> </span><span class="mf">20</span><span class="p">,</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="mf">2</span><span class="p">].</span><span class="nx">sort</span><span class="p">();</span><span class="w"> </span><span class="c1">// [1, 10, 2, 20]</span><span class="w"></span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="cm">/* 按照数字大小排序 */</span><span class="w"></span>
<span class="nx">arr</span><span class="p">.</span><span class="nx">sort</span><span class="p">(</span><span class="kd">function</span><span class="w"> </span><span class="p">(</span><span class="nx">x</span><span class="p">,</span><span class="w"> </span><span class="nx">y</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">x</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nx">y</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="o">-</span><span class="mf">1</span><span class="p">;</span><span class="w"></span>
<span class="w"> </span><span class="p">}</span><span class="w"></span>
<span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">x</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="nx">y</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="mf">1</span><span class="p">;</span><span class="w"></span>
<span class="w"> </span><span class="p">}</span><span class="w"></span>
<span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span><span class="w"></span>
<span class="p">});</span><span class="w"></span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">arr</span><span class="p">);</span><span class="w"> </span><span class="c1">// [1, 2, 10, 20]</span><span class="w"></span>

<span class="cm">/* 忽略大小写排序 */</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">arr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s1">&#39;Google&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;apple&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Microsoft&#39;</span><span class="p">];</span><span class="w"></span>
<span class="nx">arr</span><span class="p">.</span><span class="nx">sort</span><span class="p">(</span><span class="kd">function</span><span class="w"> </span><span class="p">(</span><span class="nx">s1</span><span class="p">,</span><span class="w"> </span><span class="nx">s2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="nx">x1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">s1</span><span class="p">.</span><span class="nx">toUpperCase</span><span class="p">();</span><span class="w"></span>
<span class="w"> </span><span class="nx">x2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">s2</span><span class="p">.</span><span class="nx">toUpperCase</span><span class="p">();</span><span class="w"></span>
<span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">x1</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nx">x2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="o">-</span><span class="mf">1</span><span class="p">;</span><span class="w"></span>
<span class="w"> </span><span class="p">}</span><span class="w"></span>
<span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">x1</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="nx">x2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="mf">1</span><span class="p">;</span><span class="w"></span>
<span class="w"> </span><span class="p">}</span><span class="w"></span>
<span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span><span class="w"></span>
<span class="p">});</span><span class="w"> </span><span class="c1">// [&#39;apple&#39;, &#39;Google&#39;, &#39;Microsoft&#39;]</span><span class="w"></span>
</code></pre></div>
<h4 id="every-find-findindex-foreach">every, find, findIndex, forEach<a class="headerlink" href="#every-find-findindex-foreach" title="Permanent link">&para;</a></h4>
<p><code>forEach()</code>和<code>map()</code>类似，它也把每个元素依次作用于传入的函数，但不会返回新的数组。<code>forEach()</code>常用于遍历数组，因此，传入的函数不需要返回值</p>
<div class="highlight"><pre><span></span><code><span class="kd">var</span><span class="w"> </span><span class="nx">arr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s1">&#39;Apple&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;pear&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;orange&#39;</span><span class="p">];</span><span class="w"></span>
<span class="nx">arr</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">);</span><span class="w"> </span><span class="c1">// 依次打印每个元素</span><span class="w"></span>
</code></pre></div>
<h3 id="_21">函数闭包<a class="headerlink" href="#_21" title="Permanent link">&para;</a></h3>
<ul>
<li>自调用<ul>
<li>表示 <strong>创建一个匿名函数并立刻执行</strong></li>
<li>形如 <code>(function (x) {})();</code></li>
</ul>
</li>
<li>闭包的作用<ul>
<li>实现 <strong>私有变量</strong><ul>
<li>在面向对象的程序设计语言里，比如Java和C++，要在对象内部封装一个私有变量，可以用<code>private</code>修饰一个成员变量。</li>
<li>在没有<code>class</code>机制，只有函数的语言里，借助闭包，同样可以封装一个私有变量</li>
</ul>
</li>
<li>闭包还可以把多参数的函数变成单参数的函数<ul>
<li>例如将 <code>Math.pow(x, y)</code> 函数, 实现 <code>make_pow(n)</code> 分别封装为 新的函数 <code>pow2</code>和<code>pow3</code></li>
</ul>
</li>
</ul>
</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="cm">/* 利用闭包实现私有变量</span>
<span class="cm">例子: 计数器 */</span><span class="w"></span>
<span class="kd">function</span><span class="w"> </span><span class="nx">create_counter</span><span class="p">(</span><span class="nx">initial</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="kd">var</span><span class="w"> </span><span class="nx">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">initial</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span><span class="w"></span>
<span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="nx">inc</span><span class="o">:</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">   </span><span class="nx">x</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="mf">1</span><span class="p">;</span><span class="w"></span>
<span class="w">   </span><span class="k">return</span><span class="w"> </span><span class="nx">x</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="p">},</span><span class="w"></span>
<span class="w"> </span><span class="p">};</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">c1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">create_counter</span><span class="p">();</span><span class="w"></span>
<span class="nx">c1</span><span class="p">.</span><span class="nx">inc</span><span class="p">();</span><span class="w"> </span><span class="c1">// 1</span><span class="w"></span>
<span class="nx">c1</span><span class="p">.</span><span class="nx">inc</span><span class="p">();</span><span class="w"> </span><span class="c1">// 2</span><span class="w"></span>
<span class="nx">c1</span><span class="p">.</span><span class="nx">inc</span><span class="p">();</span><span class="w"> </span><span class="c1">// 3</span><span class="w"></span>

<span class="kd">var</span><span class="w"> </span><span class="nx">c2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">create_counter</span><span class="p">(</span><span class="mf">10</span><span class="p">);</span><span class="w"></span>
<span class="nx">c2</span><span class="p">.</span><span class="nx">inc</span><span class="p">();</span><span class="w"> </span><span class="c1">// 11</span><span class="w"></span>
<span class="nx">c2</span><span class="p">.</span><span class="nx">inc</span><span class="p">();</span><span class="w"> </span><span class="c1">// 12</span><span class="w"></span>
<span class="nx">c2</span><span class="p">.</span><span class="nx">inc</span><span class="p">();</span><span class="w"> </span><span class="c1">// 13</span><span class="w"></span>
</code></pre></div>
<p>在返回的对象中，实现了一个闭包，该闭包携带了局部变量<code>x</code>，并且，从外部代码根本无法访问到变量<code>x</code>。换句话说，闭包就是携带状态的函数，并且它的状态可以完全对外隐藏起来。</p>
<div class="highlight"><pre><span></span><code><span class="cm">/* 利用闭包包装多参数函数 */</span><span class="w"></span>
<span class="kd">function</span><span class="w"> </span><span class="nx">make_pow</span><span class="p">(</span><span class="nx">n</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="p">(</span><span class="nx">x</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">pow</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span><span class="w"> </span><span class="nx">n</span><span class="p">);</span><span class="w"></span>
<span class="w"> </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// 创建两个新函数:</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">pow2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">make_pow</span><span class="p">(</span><span class="mf">2</span><span class="p">);</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">pow3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">make_pow</span><span class="p">(</span><span class="mf">3</span><span class="p">);</span><span class="w"></span>

<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">pow2</span><span class="p">(</span><span class="mf">5</span><span class="p">));</span><span class="w"> </span><span class="c1">// 25</span><span class="w"></span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">pow3</span><span class="p">(</span><span class="mf">7</span><span class="p">));</span><span class="w"> </span><span class="c1">// 343</span><span class="w"></span>
</code></pre></div>
<h4 id="_22">自调用<a class="headerlink" href="#_22" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="c1">// 创建一个匿名函数并立刻执行</span><span class="w"></span>
<span class="p">(</span><span class="kd">function</span><span class="w"> </span><span class="p">(</span><span class="nx">x</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="nx">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">x</span><span class="p">;</span><span class="w"></span>
<span class="p">})(</span><span class="mf">3</span><span class="p">);</span><span class="w"> </span><span class="c1">// 9</span><span class="w"></span>

<span class="kd">var</span><span class="w"> </span><span class="nx">add</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kd">function</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="kd">var</span><span class="w"> </span><span class="nx">counter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span><span class="w"></span>
<span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="k">return</span><span class="w"> </span><span class="nx">counter</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="mf">1</span><span class="p">;}</span><span class="w"></span>
<span class="p">})();</span><span class="w"></span>

<span class="nx">add</span><span class="p">();</span><span class="w"></span>
<span class="nx">add</span><span class="p">();</span><span class="w"></span>
<span class="nx">add</span><span class="p">();</span><span class="w"></span>

<span class="c1">// 计数器目前是 3 </span><span class="w"></span>
</code></pre></div>
<ul>
<li>变量 add 的赋值是自调用函数的返回值。</li>
<li>这个自调用函数只运行一次。它设置计数器为零（0），并返回函数表达式。</li>
<li>这样 add 成为了函数。最“精彩的”部分是它能够访问父作用域中的计数器。</li>
<li>这被称为 JavaScript 闭包。它使函数拥有“私有”变量成为可能。</li>
<li>计数器被这个匿名函数的作用域保护，并且只能使用 add 函数来修改。</li>
<li><strong>闭包</strong> 指的是有权访问父作用域的函数，即使在父函数关闭之后。</li>
</ul>
<h3 id="_23">箭头函数<a class="headerlink" href="#_23" title="Permanent link">&para;</a></h3>
<ul>
<li>例如 <code>x =&gt; x * x</code></li>
<li>箭头函数相当于匿名函数，并且简化了函数定义。箭头函数有两种格式，一种像上面的，只包含一个表达式，连<code>{ ... }</code>和<code>return</code>都省略掉了。还有一种可以包含多条语句，这时候就不能省略<code>{ ... }</code>和<code>return</code></li>
<li>如果参数不是一个，就需要用括号()括起来, 例如 <code>(x, y, ...rest) =&gt; {}</code></li>
<li>注意, 在单表达式语句中, 如果要返回一个对象, 可能会语法冲突, 会被解释为语法块<ul>
<li>例如 <code>x =&gt; { foo: x }</code> 应该写成 <code>x =&gt; ({ foo: x })</code></li>
</ul>
</li>
<li>this<ul>
<li>箭头函数看上去是匿名函数的一种简写，但实际上，箭头函数和匿名函数有个明显的区别：箭头函数内部的<code>this</code>是 <strong>词法作用域</strong>，由上下文确定。</li>
<li>从而避免了之前 this 关键字的一些问题, 见下</li>
<li>由于<code>this</code>在箭头函数中已经按照词法作用域绑定了，所以，用<code>call()</code>或者<code>apply()</code>调用箭头函数时，无法对<code>this</code>进行绑定，即传入的第一个参数被忽略</li>
</ul>
</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="kd">var</span><span class="w"> </span><span class="nx">age</span><span class="p">,</span><span class="w"> </span><span class="nx">obj</span><span class="p">;</span><span class="w"></span>

<span class="c1">// 由于JavaScript函数对`this`绑定的错误处理，下面的例子无法得到预期结果</span><span class="w"></span>
<span class="nx">obj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="nx">birth</span><span class="o">:</span><span class="w"> </span><span class="mf">1990</span><span class="p">,</span><span class="w"></span>
<span class="w"> </span><span class="nx">getAge</span><span class="o">:</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="kd">var</span><span class="w"> </span><span class="nx">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">birth</span><span class="p">;</span><span class="w"> </span><span class="c1">// 1990</span><span class="w"></span>
<span class="w">  </span><span class="kd">var</span><span class="w"> </span><span class="nx">fn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">   </span><span class="k">return</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Date</span><span class="p">().</span><span class="nx">getFullYear</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">birth</span><span class="p">;</span><span class="w"> </span><span class="c1">// this指向window或undefined</span><span class="w"></span>
<span class="w">  </span><span class="p">};</span><span class="w"></span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">fn</span><span class="p">();</span><span class="w"></span>
<span class="w"> </span><span class="p">},</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>
<span class="nx">age</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">obj</span><span class="p">.</span><span class="nx">getAge</span><span class="p">();</span><span class="w"></span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;由于this指向window而出错: &quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">age</span><span class="p">);</span><span class="w"></span>

<span class="nx">obj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="nx">birth</span><span class="o">:</span><span class="w"> </span><span class="mf">1990</span><span class="p">,</span><span class="w"></span>
<span class="w"> </span><span class="nx">getAge</span><span class="o">:</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="kd">var</span><span class="w"> </span><span class="nx">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">birth</span><span class="p">;</span><span class="w"> </span><span class="c1">// 1990</span><span class="w"></span>
<span class="w">  </span><span class="kd">var</span><span class="w"> </span><span class="nx">that</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">;</span><span class="w"> </span><span class="c1">// 指向obj</span><span class="w"></span>
<span class="w">  </span><span class="kd">var</span><span class="w"> </span><span class="nx">fn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">   </span><span class="k">return</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Date</span><span class="p">().</span><span class="nx">getFullYear</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">that</span><span class="p">.</span><span class="nx">birth</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="p">};</span><span class="w"></span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">fn</span><span class="p">();</span><span class="w"></span>
<span class="w"> </span><span class="p">},</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>
<span class="nx">age</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">obj</span><span class="p">.</span><span class="nx">getAge</span><span class="p">();</span><span class="w"></span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;保存this为that: &quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">age</span><span class="p">);</span><span class="w"></span>

<span class="c1">// 箭头函数完全修复了`this`的指向，`this`总是指向词法作用域，也就是外层调用者`obj`</span><span class="w"></span>
<span class="nx">obj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="nx">birth</span><span class="o">:</span><span class="w"> </span><span class="mf">1990</span><span class="p">,</span><span class="w"></span>
<span class="w"> </span><span class="nx">getAge</span><span class="o">:</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="kd">var</span><span class="w"> </span><span class="nx">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">birth</span><span class="p">;</span><span class="w"> </span><span class="c1">// 1990</span><span class="w"></span>
<span class="w">  </span><span class="kd">var</span><span class="w"> </span><span class="nx">fn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Date</span><span class="p">().</span><span class="nx">getFullYear</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">birth</span><span class="p">;</span><span class="w"> </span><span class="c1">// this指向obj对象</span><span class="w"></span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">fn</span><span class="p">();</span><span class="w"></span>
<span class="w"> </span><span class="p">},</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>
<span class="nx">age</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">obj</span><span class="p">.</span><span class="nx">getAge</span><span class="p">();</span><span class="w"> </span><span class="c1">// 25</span><span class="w"></span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;采用箭头函数: &quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">age</span><span class="p">);</span><span class="w"></span>

<span class="c1">// 由于`this`在箭头函数中已经按照词法作用域绑定了，所以，用`call()`或者`apply()`调用箭头函数时，无法对`this`进行绑定，即传入的第一个参数被忽略</span><span class="w"></span>
<span class="nx">obj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="nx">birth</span><span class="o">:</span><span class="w"> </span><span class="mf">1990</span><span class="p">,</span><span class="w"></span>
<span class="w"> </span><span class="nx">getAge</span><span class="o">:</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="p">(</span><span class="nx">year</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="kd">var</span><span class="w"> </span><span class="nx">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">birth</span><span class="p">;</span><span class="w"> </span><span class="c1">// 1990</span><span class="w"></span>
<span class="w">  </span><span class="kd">var</span><span class="w"> </span><span class="nx">fn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Date</span><span class="p">().</span><span class="nx">getFullYear</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">birth</span><span class="p">;</span><span class="w"> </span><span class="c1">// this.birth仍是1990</span><span class="w"></span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">fn</span><span class="p">.</span><span class="nx">call</span><span class="p">({</span><span class="w"> </span><span class="nx">birth</span><span class="o">:</span><span class="w"> </span><span class="mf">2000</span><span class="w"> </span><span class="p">},</span><span class="w"> </span><span class="nx">year</span><span class="p">);</span><span class="w"></span>
<span class="w"> </span><span class="p">},</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>
<span class="nx">age</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">obj</span><span class="p">.</span><span class="nx">getAge</span><span class="p">();</span><span class="w"> </span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;apply的第一个参数会被忽略&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">age</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<h3 id="generator">generator<a class="headerlink" href="#generator" title="Permanent link">&para;</a></h3>
<ul>
<li>generator由<code>function*</code>定义（注意多出的<code>*</code>号），并且，除了<code>return</code>语句，还可以用<code>yield</code>返回多次</li>
<li>调用generator对象有两个方法，一是不断地调用generator对象的 <code>next()</code> 方法<ul>
<li><code>next()</code>方法会执行generator的代码，然后，每次遇到<code>yield x;</code>就返回一个对象<code>{value: x, done: true/false}</code>，然后“暂停”。返回的<code>value</code>就是<code>yield</code>的返回值，<code>done</code>表示这个generator是否已经执行结束了。如果<code>done</code>为<code>true</code>，则<code>value</code>就是<code>return</code>的返回值。</li>
<li>当执行到<code>done</code>为<code>true</code>时，这个generator对象就已经全部执行完毕，不要再继续调用<code>next()</code>了。</li>
</ul>
</li>
<li>第二个方法是直接用<code>for ... of</code>循环迭代generator对象，这种方式不需要我们自己判断<code>done</code><ul>
<li>每次拿到的都是 next 方式返回的对象的 value 值</li>
</ul>
</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="cm">/* 语法 */</span><span class="w"></span>
<span class="kd">function</span><span class="o">*</span><span class="w"> </span><span class="nx">foo</span><span class="p">(</span><span class="nx">x</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="k">yield</span><span class="w"> </span><span class="nx">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">1</span><span class="p">;</span><span class="w"></span>
<span class="w"> </span><span class="k">yield</span><span class="w"> </span><span class="nx">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">2</span><span class="p">;</span><span class="w"></span>
<span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="nx">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">3</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="cm">/* 两种调用方式 */</span><span class="w"></span>
<span class="kd">function</span><span class="o">*</span><span class="w"> </span><span class="nx">fib</span><span class="p">(</span><span class="nx">max</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="kd">var</span><span class="w"> </span><span class="nx">t</span><span class="p">,</span><span class="w"></span>
<span class="w">  </span><span class="nx">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">,</span><span class="w"></span>
<span class="w">  </span><span class="nx">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span><span class="w"></span>
<span class="w">  </span><span class="nx">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span><span class="w"></span>
<span class="w"> </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="nx">n</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nx">max</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="k">yield</span><span class="w"> </span><span class="nx">a</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="p">[</span><span class="nx">a</span><span class="p">,</span><span class="w"> </span><span class="nx">b</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="nx">b</span><span class="p">,</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">b</span><span class="p">];</span><span class="w"></span>
<span class="w">  </span><span class="nx">n</span><span class="o">++</span><span class="p">;</span><span class="w"></span>
<span class="w"> </span><span class="p">}</span><span class="w"></span>
<span class="w"> </span><span class="k">return</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="cm">/* 注意, next() 方法返回的是一个对象 */</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">f</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">fib</span><span class="p">(</span><span class="mf">5</span><span class="p">);</span><span class="w"></span>
<span class="nx">f</span><span class="p">.</span><span class="nx">next</span><span class="p">();</span><span class="w"> </span><span class="c1">// {value: 0, done: false}</span><span class="w"></span>
<span class="nx">f</span><span class="p">.</span><span class="nx">next</span><span class="p">();</span><span class="w"> </span><span class="c1">// {value: 1, done: false}</span><span class="w"></span>
<span class="nx">f</span><span class="p">.</span><span class="nx">next</span><span class="p">();</span><span class="w"> </span><span class="c1">// {value: 1, done: false}</span><span class="w"></span>
<span class="nx">f</span><span class="p">.</span><span class="nx">next</span><span class="p">();</span><span class="w"> </span><span class="c1">// {value: 2, done: false}</span><span class="w"></span>
<span class="nx">f</span><span class="p">.</span><span class="nx">next</span><span class="p">();</span><span class="w"> </span><span class="c1">// {value: 3, done: false}</span><span class="w"></span>
<span class="nx">f</span><span class="p">.</span><span class="nx">next</span><span class="p">();</span><span class="w"> </span><span class="c1">// {value: undefined, done: true}</span><span class="w"></span>

<span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">var</span><span class="w"> </span><span class="nx">x</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="nx">fib</span><span class="p">(</span><span class="mf">10</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">x</span><span class="p">);</span><span class="w"> </span><span class="c1">// 依次输出0, 1, 1, 2, 3, ...</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<ul>
<li>作用<ul>
<li>因为generator可以在执行过程中多次返回，所以它看上去就像一个 <strong>可以记住执行状态的函数</strong>，利用这一点，写一个generator就可以实现需要用面向对象才能实现的功能</li>
<li>generator还有另一个巨大的好处，就是把异步回调代码变成“同步”代码</li>
</ul>
</li>
<li>例子, 例如闭包实现一个自增的计数器</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="cm">/* 利用 generator 把异步回调代码变成“同步”代码 */</span><span class="w"></span>
<span class="c1">// 不用 yield</span><span class="w"></span>
<span class="nx">ajax</span><span class="p">(</span><span class="s1">&#39;http://url-1&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">data1</span><span class="p">,</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="p">(</span><span class="nx">err</span><span class="p">,</span><span class="w"> </span><span class="nx">result</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">err</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">handle</span><span class="p">(</span><span class="nx">err</span><span class="p">);</span><span class="w"></span>
<span class="w"> </span><span class="p">}</span><span class="w"></span>
<span class="w"> </span><span class="nx">ajax</span><span class="p">(</span><span class="s1">&#39;http://url-2&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">data2</span><span class="p">,</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="p">(</span><span class="nx">err</span><span class="p">,</span><span class="w"> </span><span class="nx">result</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">err</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">   </span><span class="k">return</span><span class="w"> </span><span class="nx">handle</span><span class="p">(</span><span class="nx">err</span><span class="p">);</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="w">  </span><span class="nx">ajax</span><span class="p">(</span><span class="s1">&#39;http://url-3&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">data3</span><span class="p">,</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="p">(</span><span class="nx">err</span><span class="p">,</span><span class="w"> </span><span class="nx">result</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">err</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">handle</span><span class="p">(</span><span class="nx">err</span><span class="p">);</span><span class="w"></span>
<span class="w">   </span><span class="p">}</span><span class="w"></span>
<span class="w">   </span><span class="k">return</span><span class="w"> </span><span class="nx">success</span><span class="p">(</span><span class="nx">result</span><span class="p">);</span><span class="w"></span>
<span class="w">  </span><span class="p">});</span><span class="w"></span>
<span class="w"> </span><span class="p">});</span><span class="w"></span>
<span class="p">});</span><span class="w"></span>
<span class="c1">// 用 generator</span><span class="w"></span>
<span class="k">try</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="nx">r1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">yield</span><span class="w"> </span><span class="nx">ajax</span><span class="p">(</span><span class="s1">&#39;http://url-1&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">data1</span><span class="p">);</span><span class="w"></span>
<span class="w"> </span><span class="nx">r2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">yield</span><span class="w"> </span><span class="nx">ajax</span><span class="p">(</span><span class="s1">&#39;http://url-2&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">data2</span><span class="p">);</span><span class="w"></span>
<span class="w"> </span><span class="nx">r3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">yield</span><span class="w"> </span><span class="nx">ajax</span><span class="p">(</span><span class="s1">&#39;http://url-3&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">data3</span><span class="p">);</span><span class="w"></span>
<span class="w"> </span><span class="nx">success</span><span class="p">(</span><span class="nx">r3</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
<span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">err</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="nx">handle</span><span class="p">(</span><span class="nx">err</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1">// 如果不用闭包, 需要一个全局变量</span><span class="w"></span>
<span class="c1">// var current_id = 0;</span><span class="w"></span>
<span class="c1">// function next_id() {</span><span class="w"></span>
<span class="c1">//     current_id++;</span><span class="w"></span>
<span class="c1">//     return current_id;</span><span class="w"></span>
<span class="c1">// }</span><span class="w"></span>
<span class="c1">// 利用 generator</span><span class="w"></span>
<span class="kd">function</span><span class="o">*</span><span class="w"> </span><span class="nx">next_id</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="kd">var</span><span class="w"> </span><span class="nx">current_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span><span class="w"></span>
<span class="w"> </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="kc">true</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="nx">current_id</span><span class="o">++</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="k">yield</span><span class="w"> </span><span class="nx">current_id</span><span class="p">;</span><span class="w"></span>
<span class="w"> </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<h2 id="_24">标准对象<a class="headerlink" href="#_24" title="Permanent link">&para;</a></h2>
<ul>
<li><code>number</code>、<code>string</code>、<code>boolean</code>、<code>function</code> 和 <code>undefined</code></li>
<li>包装对象, <code>Number, Boolean, String</code>; 注意用 new 来创建的话将返回一个对象</li>
<li>转为数字 <code>parseInt(), parseFloat()</code></li>
<li>判断<ul>
<li>是否为 array <code>Array.isArray(arr)</code></li>
<li>是否为 null <code>myVar === null</code> (null 类型为 object)</li>
<li>是否存在 <code>typeof myVar === 'undefined'</code></li>
</ul>
</li>
<li>Date<ul>
<li><code>var now = new Date();</code></li>
<li>Date 对象的方法: getFullYear, getMonth, getDate, getDay, getHours, getMinutes, getSeconds, getMilliseconds<ul>
<li>getTime 返回时间戳</li>
</ul>
</li>
<li>now 方法返回时间戳 <code>Date.now()</code></li>
<li>parse 方法: <code>var d = Date.parse('2015-06-24T19:49:22.875+08:00');</code></li>
</ul>
</li>
<li>RegExp<ul>
<li><code>/正则表达式/</code>, 表达式内的 <code>\</code> 符号不需要转义, 若用 new 创建输入的字符串需要转义</li>
<li>标志: g 全局 (记录 lastIndex 再次运行回往后匹配), i 忽略大小写, m 多行</li>
<li>test</li>
<li><code>exec</code> 匹配失败返回 null, 成功则返回 Array, 其中第一个为完整匹配, 后面是分组</li>
<li>默认贪婪匹配, 加 <code>?</code> 非贪婪, 例如 <code>var re = /^(\d+?)(0*)$/;</code> 第二组匹配最后的 0</li>
<li>正则基础<ul>
<li><code>*, +, ?, {n}, {n,m}</code> 限制长度</li>
</ul>
</li>
</ul>
</li>
<li>JSON<ul>
<li>序列化: <code>JSON.stringify()</code>, 第二个参数为对 key, value 进行处理的函数, 第三个参数指定输出个数<ul>
<li>还可以通过指定 object 的 <code>toJSON</code> 方法自定义输出对象内容</li>
</ul>
</li>
<li>反序列化: <code>JSON.parse('{"name":"小明","age":14}')</code></li>
</ul>
</li>
</ul>
<h3 id="basic">对象 basic<a class="headerlink" href="#basic" title="Permanent link">&para;</a></h3>
<ul>
<li>在JavaScript的世界里，一切都是对象。</li>
<li>但是某些对象还是和其他对象不太一样。为了区分对象的类型，我们用typeof操作符获取对象的类型<ul>
<li><code>number</code>、<code>string</code>、<code>boolean</code>、<code>function</code> 和 <code>undefined</code> 有别于其他类型。特别注意 null的类型是object，Array的类型也是object，如果我们用typeof将无法区分出 null、Array 和通常意义上的 object—— <code>{}</code>。</li>
</ul>
</li>
<li>JavaScript还提供了包装对象, 包装对象的类型为 object !<ul>
<li>number、boolean和string都有包装对象, 也即 <code>Number, Boolean, String</code></li>
<li>包装对象的类型为 object, 因此 <code>new Number(123) === 123;</code> 返回 false !<ul>
<li>另外, 一定要用 new 来修饰, 如果不加的话, Number() 等就被当作普通函数, 将任何类型转化为 number 类型</li>
<li>也即, <code>var n = Number('123');</code> 的类型为 number</li>
</ul>
</li>
<li>所以闲的蛋疼也不要使用包装对象！尤其是针对string类型！！！</li>
</ul>
</li>
</ul>
<p>总结一下，有这么几条规则需要遵守：</p>
<ul>
<li>不要使用 <code>new Number()</code>、<code>new Boolean()</code>、<code>new String()</code> 创建包装对象；</li>
<li>用 <code>parseInt()</code> 或 <code>parseFloat()</code> 来转换任意类型到 <code>number</code>；</li>
<li>用<code>String()</code>来转换任意类型到<code>string</code>，或者直接调用某个对象的<code>toString()</code>方法；</li>
<li>通常不必把任意类型转换为<code>boolean</code>再判断，因为可以直接写<code>if (myVar) {...}</code>；</li>
<li><code>typeof</code>操作符可以判断出<code>number</code>、<code>boolean</code>、<code>string</code>、<code>function</code>和<code>undefined</code>；</li>
<li>判断 <code>Array</code> 要使用 <code>Array.isArray(arr)</code>；</li>
<li>判断 <code>null</code> 请使用 <code>myVar === null</code>；</li>
<li>判断某个全局变量是否存在用 <code>typeof window.myVar === 'undefined'</code>；</li>
<li>函数内部判断某个变量是否存在用 <code>typeof myVar === 'undefined'</code>。</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="c1">// 类型</span><span class="w"></span>
<span class="ow">typeof</span><span class="w"> </span><span class="mf">123</span><span class="p">;</span><span class="w"> </span><span class="c1">// &#39;number&#39;</span><span class="w"></span>
<span class="ow">typeof</span><span class="w"> </span><span class="kc">NaN</span><span class="p">;</span><span class="w"> </span><span class="c1">// &#39;number&#39;</span><span class="w"></span>
<span class="ow">typeof</span><span class="w"> </span><span class="s1">&#39;str&#39;</span><span class="p">;</span><span class="w"> </span><span class="c1">// &#39;string&#39;</span><span class="w"></span>
<span class="ow">typeof</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span><span class="w"> </span><span class="c1">// &#39;boolean&#39;</span><span class="w"></span>
<span class="ow">typeof</span><span class="w"> </span><span class="kc">undefined</span><span class="p">;</span><span class="w"> </span><span class="c1">// &#39;undefined&#39;</span><span class="w"></span>
<span class="ow">typeof</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">abs</span><span class="p">;</span><span class="w"> </span><span class="c1">// &#39;function&#39;</span><span class="w"></span>
<span class="ow">typeof</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span><span class="w"> </span><span class="c1">// &#39;object&#39;</span><span class="w"></span>
<span class="ow">typeof</span><span class="w"> </span><span class="p">[];</span><span class="w"> </span><span class="c1">// &#39;object&#39;</span><span class="w"></span>
<span class="ow">typeof</span><span class="w"> </span><span class="p">{};</span><span class="w"> </span><span class="c1">// &#39;object&#39;</span><span class="w"></span>

<span class="c1">// 包装对象</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Number</span><span class="p">(</span><span class="mf">123</span><span class="p">);</span><span class="w"> </span><span class="c1">// 123,生成了新的包装类型</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Boolean</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span><span class="w"> </span><span class="c1">// true,生成了新的包装类型</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">String</span><span class="p">(</span><span class="s1">&#39;str&#39;</span><span class="p">);</span><span class="w"> </span><span class="c1">// &#39;str&#39;,生成了新的包装类型</span><span class="w"></span>
<span class="c1">// 包装对象的类型为 object !</span><span class="w"></span>
<span class="ow">typeof</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Number</span><span class="p">(</span><span class="mf">123</span><span class="p">);</span><span class="w"> </span><span class="c1">// &#39;object&#39;</span><span class="w"></span>
<span class="ow">new</span><span class="w"> </span><span class="nb">Number</span><span class="p">(</span><span class="mf">123</span><span class="p">)</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="mf">123</span><span class="p">;</span><span class="w"> </span><span class="c1">// false</span><span class="w"></span>

<span class="ow">typeof</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Boolean</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span><span class="w"> </span><span class="c1">// &#39;object&#39;</span><span class="w"></span>
<span class="ow">new</span><span class="w"> </span><span class="nb">Boolean</span><span class="p">(</span><span class="kc">true</span><span class="p">)</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span><span class="w"> </span><span class="c1">// false</span><span class="w"></span>

<span class="ow">typeof</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">String</span><span class="p">(</span><span class="s1">&#39;str&#39;</span><span class="p">);</span><span class="w"> </span><span class="c1">// &#39;object&#39;</span><span class="w"></span>
<span class="ow">new</span><span class="w"> </span><span class="nb">String</span><span class="p">(</span><span class="s1">&#39;str&#39;</span><span class="p">)</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;str&#39;</span><span class="p">;</span><span class="w"> </span><span class="c1">// false</span><span class="w"></span>
</code></pre></div>
<ul>
<li>最后有细心的同学指出，任何对象都有<code>toString()</code>方法吗？<code>null</code>和<code>undefined</code>就没有！确实如此，这两个特殊值要除外，虽然<code>null</code>还伪装成了<code>object</code>类型。</li>
<li>更细心的同学指出，<code>number</code>对象调用<code>toString()</code>报SyntaxError：<code>123.toString(); // SyntaxError</code>。<ul>
<li>遇到这种情况，要特殊处理一下：</li>
</ul>
</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="mf">123.</span><span class="p">.</span><span class="nx">toString</span><span class="p">();</span><span class="w"> </span><span class="c1">// &#39;123&#39;, 注意是两个点！</span><span class="w"></span>
<span class="p">(</span><span class="mf">123</span><span class="p">).</span><span class="nx">toString</span><span class="p">();</span><span class="w"> </span><span class="c1">// &#39;123&#39;</span><span class="w"></span>
</code></pre></div>
<h3 id="date">Date<a class="headerlink" href="#date" title="Permanent link">&para;</a></h3>
<ul>
<li>在JavaScript中，Date对象用来表示日期和时间。</li>
<li>获取系统当前时间 <code>var now = new Date();</code><ul>
<li>注意，当前时间是浏览器从本机操作系统获取的时间，所以不一定准确，因为用户可以把当前时间设定为任何值。</li>
<li>方法:<ul>
<li>getFullYear, getMonth, getDate,</li>
<li>getDay</li>
<li>getHours, getMinutes, getSeconds, getMilliseconds</li>
<li>getTime 返回时间戳</li>
</ul>
</li>
</ul>
</li>
<li>创建<ul>
<li>可以用 <code>var d = new Date(2015, 5, 19, 20, 15, 30, 123);</code><ul>
<li>注意, 月份和日期是从 0 开始的!</li>
</ul>
</li>
<li>第二种方式是用 parse 方法解析 ISO 8601 格式的字符串<ul>
<li>返回时间戳, 可以再转化为 Date 类型</li>
<li><code>var d = Date.parse('2015-06-24T19:49:22.875+08:00');</code></li>
</ul>
</li>
</ul>
</li>
<li>时区<ul>
<li>toLocalString</li>
<li>toUTCString</li>
</ul>
</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="kd">var</span><span class="w"> </span><span class="nx">now</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Date</span><span class="p">();</span><span class="w"></span>
<span class="nx">now</span><span class="p">;</span><span class="w"> </span><span class="c1">// Wed Jun 24 2015 19:49:22 GMT+0800 (CST)</span><span class="w"></span>
<span class="nx">now</span><span class="p">.</span><span class="nx">getFullYear</span><span class="p">();</span><span class="w"> </span><span class="c1">// 2015, 年份</span><span class="w"></span>
<span class="nx">now</span><span class="p">.</span><span class="nx">getMonth</span><span class="p">();</span><span class="w"> </span><span class="c1">// 5, 月份，注意月份范围是0~11，5表示六月</span><span class="w"></span>
<span class="nx">now</span><span class="p">.</span><span class="nx">getDate</span><span class="p">();</span><span class="w"> </span><span class="c1">// 24, 表示24号</span><span class="w"></span>
<span class="nx">now</span><span class="p">.</span><span class="nx">getDay</span><span class="p">();</span><span class="w"> </span><span class="c1">// 3, 表示星期三</span><span class="w"></span>
<span class="nx">now</span><span class="p">.</span><span class="nx">getHours</span><span class="p">();</span><span class="w"> </span><span class="c1">// 19, 24小时制</span><span class="w"></span>
<span class="nx">now</span><span class="p">.</span><span class="nx">getMinutes</span><span class="p">();</span><span class="w"> </span><span class="c1">// 49, 分钟</span><span class="w"></span>
<span class="nx">now</span><span class="p">.</span><span class="nx">getSeconds</span><span class="p">();</span><span class="w"> </span><span class="c1">// 22, 秒</span><span class="w"></span>
<span class="nx">now</span><span class="p">.</span><span class="nx">getMilliseconds</span><span class="p">();</span><span class="w"> </span><span class="c1">// 875, 毫秒数</span><span class="w"></span>
<span class="nx">now</span><span class="p">.</span><span class="nx">getTime</span><span class="p">();</span><span class="w"> </span><span class="c1">// 1435146562875, 以number形式表示的时间戳</span><span class="w"></span>
</code></pre></div>
<h4 id="date_1">创建一个指定日期和时间的<code>Date</code>对象<a class="headerlink" href="#date_1" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="kd">var</span><span class="w"> </span><span class="nx">d</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Date</span><span class="p">(</span><span class="mf">2015</span><span class="p">,</span><span class="w"> </span><span class="mf">5</span><span class="p">,</span><span class="w"> </span><span class="mf">19</span><span class="p">,</span><span class="w"> </span><span class="mf">20</span><span class="p">,</span><span class="w"> </span><span class="mf">15</span><span class="p">,</span><span class="w"> </span><span class="mf">30</span><span class="p">,</span><span class="w"> </span><span class="mf">123</span><span class="p">);</span><span class="w"></span>
<span class="nx">d</span><span class="p">;</span><span class="w"> </span><span class="c1">// Fri Jun 19 2015 20:15:30 GMT+0800 (CST)</span><span class="w"></span>
</code></pre></div>
<p>【注意】 JavaScript的Date对象月份值从0开始，牢记0=1月，1=2月，2=3月，……，11=12月。</p>
<ul>
<li>第二种创建一个指定日期和时间的方法是解析一个符合<a href="http://www.w3.org/TR/NOTE-datetime">ISO 8601</a>格式的字符串。</li>
<li>但它返回的不是<code>Date</code>对象，而是一个时间戳。不过有时间戳就可以很容易地把它转换为一个<code>Date</code></li>
</ul>
<div class="highlight"><pre><span></span><code><span class="kd">var</span><span class="w"> </span><span class="nx">d</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Date</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="s1">&#39;2015-06-24T19:49:22.875+08:00&#39;</span><span class="p">);</span><span class="w"></span>
<span class="nx">d</span><span class="p">;</span><span class="w"> </span><span class="c1">// 1435146562875</span><span class="w"></span>

<span class="kd">var</span><span class="w"> </span><span class="nx">d</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Date</span><span class="p">(</span><span class="mf">1435146562875</span><span class="p">);</span><span class="w"></span>
<span class="nx">d</span><span class="p">;</span><span class="w"> </span><span class="c1">// Wed Jun 24 2015 19:49:22 GMT+0800 (CST)</span><span class="w"></span>
<span class="nx">d</span><span class="p">.</span><span class="nx">getMonth</span><span class="p">();</span><span class="w"> </span><span class="c1">// 5</span><span class="w"></span>
</code></pre></div>
<h4 id="_25">时区<a class="headerlink" href="#_25" title="Permanent link">&para;</a></h4>
<p><code>Date</code>对象表示的时间总是按浏览器所在时区显示的，不过我们既可以显示本地时间，也可以显示调整后的UTC时间：</p>
<div class="highlight"><pre><span></span><code><span class="kd">var</span><span class="w"> </span><span class="nx">d</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Date</span><span class="p">(</span><span class="mf">1435146562875</span><span class="p">);</span><span class="w"></span>
<span class="nx">d</span><span class="p">.</span><span class="nx">toLocaleString</span><span class="p">();</span><span class="w"> </span><span class="c1">// &#39;2015/6/24 下午7:49:22&#39;，本地时间（北京时区+8:00），显示的字符串与操作系统设定的格式有关</span><span class="w"></span>
<span class="nx">d</span><span class="p">.</span><span class="nx">toUTCString</span><span class="p">();</span><span class="w"> </span><span class="c1">// &#39;Wed, 24 Jun 2015 11:49:22 GMT&#39;，UTC时间，与本地时间相差8小时</span><span class="w"></span>
</code></pre></div>
<p>要获取当前时间戳，可以用：</p>
<div class="highlight"><pre><span></span><code><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">());</span><span class="w"> </span><span class="c1">// 老版本IE没有now()方法</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="ow">new</span><span class="w"> </span><span class="nb">Date</span><span class="p">().</span><span class="nx">getTime</span><span class="p">());</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<h3 id="regexp">RegExp<a class="headerlink" href="#regexp" title="Permanent link">&para;</a></h3>
<ul>
<li>正则表达式</li>
<li>创建<ul>
<li><code>/正则表达式/</code>, 此时表达式内的 <code>\</code> 符号不需要转义,<ul>
<li>例如 <code>var re1 = /ABC\-001/;</code></li>
</ul>
</li>
<li><code>new RegExp('正则表达式')</code>,<ul>
<li>此时, 输入函数的是一个字符串, 因此字符串内部的 <code>\</code> 符号需要转义</li>
<li>例如 <code>var re2 = new RegExp('ABC\\-001');</code></li>
</ul>
</li>
</ul>
</li>
<li>匹配: test()</li>
<li>切分字符串<ul>
<li>字符串方法 split 中传入正则, 例如 <code>split(/\s+/)</code></li>
</ul>
</li>
<li>分组<ul>
<li><code>exec()</code> 匹配失败返回 null, 成功则返回 Array, 其中第一个为完整匹配, 后面是分组</li>
<li>例如, <code>/^(\d{3})-(\d{3,8})$/</code> 匹配电话</li>
</ul>
</li>
<li>贪婪匹配: 默认是贪婪匹配, 加上 <code>?</code> 设置为非贪婪<ul>
<li>例如, <code>/^(\d+)(0*)$/</code> 中第二个分组匹配结尾的 0</li>
</ul>
</li>
<li>全局匹配<ul>
<li>写成 <code>/test/g</code>, 或者 <code>new RegExp('test', 'g')</code></li>
<li>全局匹配可以多次执行exec()方法来搜索一个匹配的字符串。当我们指定g标志后，每次运行exec()，正则表达式本身会更新 <code>lastIndex</code> 属性，表示上次匹配到的最后索引</li>
</ul>
</li>
<li>正则表达式还可以指定 <code>i</code> 标志，表示忽略大小写，<code>m</code> 标志，表示执行多行匹配。</li>
</ul>
<h4 id="_26">正则表达式<a class="headerlink" href="#_26" title="Permanent link">&para;</a></h4>
<ul>
<li>正则基础<ul>
<li><code>\d, \w, .</code> 特殊字符</li>
<li><code>*, +, ?, {n}, {n,m}</code> 限制长度</li>
</ul>
</li>
<li><code>[]</code> 表示范围<ul>
<li>例如, <code>[a-zA-Z\_\$][0-9a-zA-Z\_\$]*</code> 匹配 JavaScript允许的变量名；</li>
</ul>
</li>
<li><code>A|B</code> 可以匹配A或B</li>
<li><code>^</code> 表示行的开头，<code>^\d</code> 表示必须以数字开头。</li>
<li><code>$</code> 表示行的结束，<code>\d$</code> 表示必须以数字结束。</li>
</ul>
<h4 id="regexp_1">创建 RegExp<a class="headerlink" href="#regexp_1" title="Permanent link">&para;</a></h4>
<p>JavaScript有两种方式创建一个正则表达式：</p>
<ul>
<li>第一种方式是直接通过<code>/正则表达式/</code>写出来，第二种方式是通过<code>new RegExp('正则表达式')</code>创建一个RegExp对象。</li>
<li>【Note】用第二种方式时，需要考虑字符串转义的问题。</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="kd">var</span><span class="w"> </span><span class="nx">re1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sr">/ABC\-001/</span><span class="p">;</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">re2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">RegExp</span><span class="p">(</span><span class="s1">&#39;ABC\\-001&#39;</span><span class="p">);</span><span class="w"></span>

<span class="nx">re1</span><span class="p">;</span><span class="w"> </span><span class="c1">// /ABC\-001/</span><span class="w"></span>
<span class="nx">re2</span><span class="p">;</span><span class="w"> </span><span class="c1">// /ABC\-001/</span><span class="w"></span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="kd">var</span><span class="w"> </span><span class="nx">re</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sr">/^\d{3}\-\d{3,8}$/</span><span class="p">;</span><span class="w"></span>
<span class="nx">re</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="s1">&#39;010-12345&#39;</span><span class="p">);</span><span class="w"> </span><span class="c1">// true</span><span class="w"></span>
<span class="nx">re</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="s1">&#39;010-1234x&#39;</span><span class="p">);</span><span class="w"> </span><span class="c1">// false</span><span class="w"></span>
<span class="nx">re</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="s1">&#39;010 12345&#39;</span><span class="p">);</span><span class="w"> </span><span class="c1">// false</span><span class="w"></span>
</code></pre></div>
<h4 id="_27">切分字符串<a class="headerlink" href="#_27" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="w"></span>
<span class="w"> </span><span class="s1">&#39;  a b   c  &#39;</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">),</span><span class="w"></span>
<span class="w"> </span><span class="s1">&#39;  a b   c  &#39;</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="sr">/\s+/</span><span class="p">),</span><span class="w"></span>
<span class="w"> </span><span class="s1">&#39;  a, b,   c  &#39;</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="sr">/[\s+,]+/</span><span class="p">)</span><span class="w">        </span><span class="c1">//[ &#39;&#39;, &#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#39;&#39; ]</span><span class="w"></span>
<span class="p">)</span><span class="w"></span>
</code></pre></div>
<h4 id="_28">分组<a class="headerlink" href="#_28" title="Permanent link">&para;</a></h4>
<ul>
<li><code>exec()</code>方法在匹配成功后，会返回一个<code>Array</code>，第一个元素是正则表达式匹配到的整个字符串，后面的字符串表示匹配成功的子串。</li>
<li><code>exec()</code>方法在匹配失败时返回<code>null</code>。</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="kd">var</span><span class="w"> </span><span class="nx">re</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sr">/^(\d{3})-(\d{3,8})$/</span><span class="p">;</span><span class="w"></span>
<span class="nx">re</span><span class="p">.</span><span class="nx">exec</span><span class="p">(</span><span class="s1">&#39;010-12345&#39;</span><span class="p">);</span><span class="w"> </span><span class="c1">// [&#39;010-12345&#39;, &#39;010&#39;, &#39;12345&#39;]</span><span class="w"></span>
<span class="nx">re</span><span class="p">.</span><span class="nx">exec</span><span class="p">(</span><span class="s1">&#39;010 12345&#39;</span><span class="p">);</span><span class="w"> </span><span class="c1">// null</span><span class="w"></span>
</code></pre></div>
<h4 id="_29">贪婪匹配<a class="headerlink" href="#_29" title="Permanent link">&para;</a></h4>
<p>需要特别指出的是，正则匹配默认是贪婪匹配，也就是匹配尽可能多的字符。</p>
<div class="highlight"><pre><span></span><code><span class="kd">var</span><span class="w"> </span><span class="nx">re</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sr">/^(\d+)(0*)$/</span><span class="p">;</span><span class="w"></span>
<span class="nx">re</span><span class="p">.</span><span class="nx">exec</span><span class="p">(</span><span class="s1">&#39;102300&#39;</span><span class="p">);</span><span class="w"> </span><span class="c1">// [&#39;102300&#39;, &#39;102300&#39;, &#39;&#39;]</span><span class="w"></span>

<span class="c1">//非贪婪</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">re</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sr">/^(\d+?)(0*)$/</span><span class="p">;</span><span class="w"></span>
<span class="nx">re</span><span class="p">.</span><span class="nx">exec</span><span class="p">(</span><span class="s1">&#39;102300&#39;</span><span class="p">);</span><span class="w"> </span><span class="c1">// [&#39;102300&#39;, &#39;1023&#39;, &#39;00&#39;]</span><span class="w"></span>
</code></pre></div>
<h4 id="_30">全局搜索<a class="headerlink" href="#_30" title="Permanent link">&para;</a></h4>
<ul>
<li>JavaScript的正则表达式还有几个特殊的标志，最常用的是<code>g</code>，表示全局匹配。</li>
<li>正则表达式还可以指定<code>i</code>标志，表示忽略大小写，<code>m</code>标志，表示执行多行匹配。</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="kd">var</span><span class="w"> </span><span class="nx">r1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sr">/test/g</span><span class="p">;</span><span class="w"></span>
<span class="c1">// 等价于:</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">r2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">RegExp</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;g&#39;</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p>全局匹配可以多次执行<code>exec()</code>方法来搜索一个匹配的字符串。当我们指定<code>g</code>标志后，每次运行<code>exec()</code>，正则表达式本身会更新<code>lastIndex</code>属性，表示上次匹配到的最后索引：</p>
<div class="highlight"><pre><span></span><code><span class="kd">var</span><span class="w"> </span><span class="nx">s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;JavaScript, VBScript, JScript and ECMAScript&#39;</span><span class="p">;</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">re</span><span class="o">=</span><span class="sr">/[a-zA-Z]+Script/g</span><span class="p">;</span><span class="w"></span>

<span class="c1">// 使用全局匹配:</span><span class="w"></span>
<span class="nx">re</span><span class="p">.</span><span class="nx">exec</span><span class="p">(</span><span class="nx">s</span><span class="p">);</span><span class="w"> </span><span class="c1">// [&#39;JavaScript&#39;]</span><span class="w"></span>
<span class="nx">re</span><span class="p">.</span><span class="nx">lastIndex</span><span class="p">;</span><span class="w"> </span><span class="c1">// 10</span><span class="w"></span>

<span class="nx">re</span><span class="p">.</span><span class="nx">exec</span><span class="p">(</span><span class="nx">s</span><span class="p">);</span><span class="w"> </span><span class="c1">// [&#39;VBScript&#39;]</span><span class="w"></span>
<span class="nx">re</span><span class="p">.</span><span class="nx">lastIndex</span><span class="p">;</span><span class="w"> </span><span class="c1">// 20</span><span class="w"></span>

<span class="nx">re</span><span class="p">.</span><span class="nx">exec</span><span class="p">(</span><span class="nx">s</span><span class="p">);</span><span class="w"> </span><span class="c1">// [&#39;JScript&#39;]</span><span class="w"></span>
<span class="nx">re</span><span class="p">.</span><span class="nx">lastIndex</span><span class="p">;</span><span class="w"> </span><span class="c1">// 29</span><span class="w"></span>

<span class="nx">re</span><span class="p">.</span><span class="nx">exec</span><span class="p">(</span><span class="nx">s</span><span class="p">);</span><span class="w"> </span><span class="c1">// [&#39;ECMAScript&#39;]</span><span class="w"></span>
<span class="nx">re</span><span class="p">.</span><span class="nx">lastIndex</span><span class="p">;</span><span class="w"> </span><span class="c1">// 44</span><span class="w"></span>

<span class="nx">re</span><span class="p">.</span><span class="nx">exec</span><span class="p">(</span><span class="nx">s</span><span class="p">);</span><span class="w"> </span><span class="c1">// null，直到结束仍没有匹配到</span><span class="w"></span>
</code></pre></div>
<h3 id="json">JSON<a class="headerlink" href="#json" title="Permanent link">&para;</a></h3>
<ul>
<li>JSON: JavaScript Object Notation（JavaScript 对象标记法）<ul>
<li>JSON 是一种存储和交换数据的语法。</li>
<li>JSON 是通过 JavaScript 对象标记法书写的文本。</li>
</ul>
</li>
<li>序列化: <code>JSON.stringify()</code><ul>
<li>第一个参数为要序列化的 object;</li>
<li>第二个参数为对于 key, value 进行处理的函数; 也可指定 <code>['age', 'name']</code> 对于 key 进行过滤;</li>
<li>第三个参数指定输出格式, 默认输出一行, 可以指定格式化输出的空格数量, 或者指定 <code>\t</code> 进行格式化;</li>
</ul>
</li>
<li>还可以通过指定 object 的 <code>toJSON</code> 方法进行自定义输出;</li>
<li>反序列化: <code>JSON.parse()</code><ul>
<li>将 JSON 格式的字符串变为 js 对象</li>
</ul>
</li>
</ul>
<p>JSON 语法规则</p>
<ul>
<li>数据是名称/值对</li>
<li>数据由逗号分隔</li>
<li>花括号保存对象</li>
<li>方括号保存数组</li>
</ul>
<h4 id="_31">序列化<a class="headerlink" href="#_31" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="kd">var</span><span class="w"> </span><span class="nx">xiaoming</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;小明&#39;</span><span class="p">,</span><span class="w"></span>
<span class="w"> </span><span class="nx">age</span><span class="o">:</span><span class="w"> </span><span class="mf">14</span><span class="p">,</span><span class="w"></span>
<span class="w"> </span><span class="nx">gender</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w"></span>
<span class="w"> </span><span class="nx">height</span><span class="o">:</span><span class="w"> </span><span class="mf">1.65</span><span class="p">,</span><span class="w"></span>
<span class="w"> </span><span class="nx">grade</span><span class="o">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w"></span>
<span class="w"> </span><span class="s1">&#39;middle-school&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;\&quot;W3C\&quot; Middle School&#39;</span><span class="p">,</span><span class="w"></span>
<span class="w"> </span><span class="nx">skills</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s1">&#39;JavaScript&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Java&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Python&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Lisp&#39;</span><span class="p">]</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="kd">var</span><span class="w"> </span><span class="nx">s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">xiaoming</span><span class="p">);</span><span class="w"></span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">s</span><span class="p">);</span><span class="w"></span>

<span class="c1">// 1. 调整格式</span><span class="w"></span>
<span class="nx">s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">xiaoming</span><span class="p">,</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;  &#39;</span><span class="p">);</span><span class="w"></span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">s</span><span class="p">);</span><span class="w"></span>

<span class="c1">// 2. 第二个参数：控制如何筛选对象的键值</span><span class="w"></span>
<span class="nx">s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">xiaoming</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;skills&#39;</span><span class="p">],</span><span class="w"> </span><span class="s1">&#39;  &#39;</span><span class="p">);</span><span class="w"></span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">s</span><span class="p">);</span><span class="w"></span>
<span class="c1">// 也可传入一个函数</span><span class="w"></span>
<span class="kd">function</span><span class="w"> </span><span class="nx">convert</span><span class="p">(</span><span class="nx">key</span><span class="p">,</span><span class="w"> </span><span class="nx">value</span><span class="p">){</span><span class="w"></span>
<span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="ow">typeof</span><span class="w"> </span><span class="nx">value</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;string&#39;</span><span class="p">){</span><span class="w"></span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">value</span><span class="p">.</span><span class="nx">toUpperCase</span><span class="p">();</span><span class="w"></span>
<span class="w"> </span><span class="p">}</span><span class="w"></span>
<span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="nx">value</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
<span class="nx">s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">xiaoming</span><span class="p">,</span><span class="w"> </span><span class="nx">convert</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;\t&#39;</span><span class="p">);</span><span class="w"></span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">s</span><span class="p">)</span><span class="w"></span>


<span class="c1">// 3. 自定义</span><span class="w"></span>
<span class="nx">xiaoming</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;小明&#39;</span><span class="p">,</span><span class="w"></span>
<span class="w"> </span><span class="nx">age</span><span class="o">:</span><span class="w"> </span><span class="mf">14</span><span class="p">,</span><span class="w"></span>
<span class="w"> </span><span class="nx">gender</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w"></span>
<span class="w"> </span><span class="nx">height</span><span class="o">:</span><span class="w"> </span><span class="mf">1.65</span><span class="p">,</span><span class="w"></span>
<span class="w"> </span><span class="nx">grade</span><span class="o">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w"></span>
<span class="w"> </span><span class="s1">&#39;middle-school&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;\&quot;W3C\&quot; Middle School&#39;</span><span class="p">,</span><span class="w"></span>
<span class="w"> </span><span class="nx">skills</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s1">&#39;JavaScript&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Java&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Python&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Lisp&#39;</span><span class="p">],</span><span class="w"></span>
<span class="w"> </span><span class="nx">toJSON</span><span class="o">:</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">// 只输出name和age，并且改变了key：</span><span class="w"></span>
<span class="w">   </span><span class="s1">&#39;Name&#39;</span><span class="o">:</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">name</span><span class="p">,</span><span class="w"></span>
<span class="w">   </span><span class="s1">&#39;Age&#39;</span><span class="o">:</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">age</span><span class="w"></span>
<span class="w">  </span><span class="p">};</span><span class="w"></span>
<span class="w"> </span><span class="p">}</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>
<span class="nx">s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">xiaoming</span><span class="p">);</span><span class="w"></span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">s</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<h4 id="_32">反序列化<a class="headerlink" href="#_32" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="nb">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="s1">&#39;[1,2,3,true]&#39;</span><span class="p">);</span><span class="w"> </span><span class="c1">// [1, 2, 3, true]</span><span class="w"></span>
<span class="nb">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="s1">&#39;{&quot;name&quot;:&quot;小明&quot;,&quot;age&quot;:14}&#39;</span><span class="p">);</span><span class="w"> </span><span class="c1">// Object {name: &#39;小明&#39;, age: 14}</span><span class="w"></span>
<span class="nb">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="s1">&#39;true&#39;</span><span class="p">);</span><span class="w"> </span><span class="c1">// true</span><span class="w"></span>
<span class="nb">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="s1">&#39;123.45&#39;</span><span class="p">);</span><span class="w"> </span><span class="c1">// 123.45</span><span class="w"></span>
</code></pre></div>
<p><code>JSON.parse()</code>还可以接收一个函数，用来转换解析出的属性</p>
<div class="highlight"><pre><span></span><code><span class="kd">var</span><span class="w"> </span><span class="nx">obj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="s1">&#39;{&quot;name&quot;:&quot;小明&quot;,&quot;age&quot;:14}&#39;</span><span class="p">,</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="p">(</span><span class="nx">key</span><span class="p">,</span><span class="w"> </span><span class="nx">value</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">key</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;name&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">value</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;同学&#39;</span><span class="p">;</span><span class="w"></span>
<span class="w"> </span><span class="p">}</span><span class="w"></span>
<span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="nx">value</span><span class="p">;</span><span class="w"></span>
<span class="p">});</span><span class="w"></span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nb">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">obj</span><span class="p">));</span><span class="w"> </span><span class="c1">// {name: &#39;小明同学&#39;, age: 14}</span><span class="w"></span>
</code></pre></div>
<h4 id="api-openweathermap">案例：解析天气 API OpenWeatherMap<a class="headerlink" href="#api-openweathermap" title="Permanent link">&para;</a></h4>
<ul>
<li>注意到下面的代码中用到了 jQuery，因此不能用 node 但可在浏览器中调试。</li>
</ul>
<p>用浏览器访问OpenWeatherMap的<a href="https://api.openweathermap.org/data/2.5/forecast?q=Beijing,cn&amp;appid=800f49846586c3ba6e7052cfc89af16c">天气API</a>，查看返回的JSON数据，然后返回城市、天气预报等信息。</p>
<div class="highlight"><pre><span></span><code><span class="kd">var</span><span class="w"> </span><span class="nx">url</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;https://api.openweathermap.org/data/2.5/forecast?q=Beijing,cn&amp;appid=800f49846586c3ba6e7052cfc89af16c&#39;</span><span class="p">;</span><span class="w"></span>
<span class="nx">$</span><span class="p">.</span><span class="nx">getJSON</span><span class="p">(</span><span class="nx">url</span><span class="p">,</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="p">(</span><span class="nx">data</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="kd">var</span><span class="w"> </span><span class="nx">info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="nx">city</span><span class="o">:</span><span class="w"> </span><span class="nx">data</span><span class="p">.</span><span class="nx">city</span><span class="p">.</span><span class="nx">name</span><span class="p">,</span><span class="w"></span>
<span class="w">  </span><span class="nx">weather</span><span class="o">:</span><span class="w"> </span><span class="nx">data</span><span class="p">.</span><span class="nx">list</span><span class="p">[</span><span class="mf">0</span><span class="p">].</span><span class="nx">weather</span><span class="p">[</span><span class="mf">0</span><span class="p">].</span><span class="nx">main</span><span class="p">,</span><span class="w"></span>
<span class="w">  </span><span class="nx">time</span><span class="o">:</span><span class="w"> </span><span class="nx">data</span><span class="p">.</span><span class="nx">list</span><span class="p">[</span><span class="mf">0</span><span class="p">].</span><span class="nx">dt_txt</span><span class="w"></span>
<span class="w"> </span><span class="p">};</span><span class="w"></span>
<span class="w"> </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nb">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">info</span><span class="p">,</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;  &#39;</span><span class="p">));</span><span class="w"></span>
<span class="p">});</span><span class="w">    </span>
</code></pre></div>
<h2 id="_33">面向对象编程<a class="headerlink" href="#_33" title="Permanent link">&para;</a></h2>
<p>参见 <a href="https://zhuanlan.zhihu.com/p/288635990">JavaScript的原型对象的彻底理解</a></p>
<ul>
<li>JavaScript不区分类和实例的概念，而是通过原型（prototype）来实现面向对象编程。</li>
<li>一个对象的 <code>__proto__</code> 属性 指向其原型</li>
<li>构造函数<ul>
<li>使用 <code>new</code> 关键字创建;</li>
<li>为了避免冗余, 不应该在构造函数中定义方法, 而应该定义在其原型上, 例如 <code>Student.prototype.func = ...</code></li>
</ul>
</li>
<li>注意区分:<ul>
<li><code>prototype</code> 是函数独有的属性</li>
<li><code>__proto__</code> 和 <code>constructor</code> 是对象的属性; 但是由于 JS 中函数也是一种对象，所以函数也拥有</li>
</ul>
</li>
<li>不应该操作 <code>__proto__</code> 属性</li>
<li>一个构造函数及其所构造出来的对象满足关系 <code>foo.__proto__ === Foo.prototype</code> , 这里的 foo 通过 <code>new Foo()</code> 构造.</li>
<li>如何实现继承 (实现构造函数)<ul>
<li>比如要实现继承链 <code>new PrimaryStudent() ----&gt; PrimaryStudent.prototype ----&gt; Student.prototype ----&gt; Object.prototype ----&gt; null</code> (注意, 继承链 通过 <code>__proto__</code> 属性连接, 例如 <code>Object.prototype.__proto__===null</code>)</li>
<li>我们最终要写的 PrimaryStudent 这样一个构造函数, 但要完成继承链, 注意要有一个 <code>PrimaryStudent.prototype</code> 原型(对象).</li>
<li>因此, 可以分三步: 1. 定义构造函数 PrimaryStudent(props), 注意在其中要调用 <code>Student.call(this, props);</code> 类比 Python 中的 <code>super(A, self).__init__()</code> ; 2. 修复继承链, 可以用一个空函数 <code>F(){}</code> 构造一个对象作为 <code>PrimaryStudent.prototype</code>, 维护 <code>__proto__, prototype, constructor</code> 属性; 3. 在 <code>PrimaryStudent.prototype</code> 上定义新的原型方法.</li>
</ul>
</li>
<li>ES6 标准中引入了 <code>class</code> 关键词, 大大简化了类和继承的语法.<ul>
<li>语法: <code>class Student {}</code><ul>
<li><code>class</code>的定义包含了构造函数 <code>constructor</code>和定义在原型对象上的方法（注意没有<code>function</code>关键字）</li>
</ul>
</li>
<li>继承: <code>class PrimaryStudent extends Student {}</code>; 记得在 constructor 函数中调用父类的构造方法 <code>super(name);</code></li>
</ul>
</li>
</ul>
<p><img alt="" src="../media/js-note/2022-02-10-22-27-30.png" /></p>
<h3 id="_34">创建对象<a class="headerlink" href="#_34" title="Permanent link">&para;</a></h3>
<ul>
<li>JavaScript对每个创建的对象都会设置一个原型，指向它的原型对象。</li>
<li>当我们用<code>obj.xxx</code>访问一个对象的属性时，JavaScript引擎先在当前对象上查找该属性，如果没有找到，就到其原型对象上找，如果还没有找到，就一直上溯到<code>Object.prototype</code>对象，最后，如果还没有找到，就只能返回<code>undefined</code>。</li>
<li>Array<ul>
<li>其原型链为 <code>arr ----&gt; Array.prototype ----&gt; Object.prototype ----&gt; null</code></li>
<li><code>Array.prototype</code>定义了<code>indexOf()</code>、<code>shift()</code>等方法，因此你可以在所有的<code>Array</code>对象上直接调用这些方法。</li>
</ul>
</li>
<li>function<ul>
<li>原型链为 <code>foo ----&gt; Function.prototype ----&gt; Object.prototype ----&gt; null</code></li>
<li>由于<code>Function.prototype</code>定义了<code>apply()</code>等方法，因此，所有函数都可以调用<code>apply()</code>方法。</li>
</ul>
</li>
</ul>
<h4 id="_35">构造函数<a class="headerlink" href="#_35" title="Permanent link">&para;</a></h4>
<ul>
<li>在JavaScript中，可以用关键字<code>new</code>来调用构造函数 (就是一个普通的函数)，并返回一个对象</li>
<li>构造函数绑定的<code>this</code>指向新创建的对象，并默认返回<code>this</code> (因此不需要写 return this)</li>
<li>例如, 下面的原型链为 <code>xiaoming ----&gt; Student.prototype ----&gt; Object.prototype ----&gt; null</code></li>
</ul>
<div class="highlight"><pre><span></span><code><span class="cm">/* 构造函数 (就是个普通的函数, 但是通过 new 来调用会返回一个对象) */</span><span class="w"></span>
<span class="kd">function</span><span class="w"> </span><span class="nx">Student</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">name</span><span class="p">;</span><span class="w"></span>
<span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">hello</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="nx">alert</span><span class="p">(</span><span class="s1">&#39;Hello, &#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">name</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;!&#39;</span><span class="p">);</span><span class="w"></span>
<span class="w"> </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">xiaoming</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">Student</span><span class="p">(</span><span class="s1">&#39;小明&#39;</span><span class="p">);</span><span class="w"> </span><span class="c1">// new !!</span><span class="w"></span>
<span class="nx">xiaoming</span><span class="p">.</span><span class="nx">name</span><span class="p">;</span><span class="w"> </span><span class="c1">// &#39;小明&#39;</span><span class="w"></span>
<span class="nx">xiaoming</span><span class="p">.</span><span class="nx">hello</span><span class="p">();</span><span class="w"> </span><span class="c1">// Hello, 小明!</span><span class="w"></span>
</code></pre></div>
<p>注意, 用<code>new Student()</code>创建的对象还从原型上获得了一个<code>constructor</code>属性，它指向函数<code>Student</code>本身</p>
<div class="highlight"><pre><span></span><code><span class="c1">// 构造函数 的 prototype 属性指向其原型, 原型 的 constructor 属性指向构造函数</span><span class="w"></span>
<span class="nx">Student</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="kr">constructor</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="nx">Student</span><span class="p">;</span><span class="w"> </span><span class="c1">// true</span><span class="w"></span>
<span class="c1">// 实例 的 constructor 属性指向构造函数</span><span class="w"></span>
<span class="nx">xiaoming</span><span class="p">.</span><span class="kr">constructor</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="nx">Student</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="kr">constructor</span><span class="p">;</span><span class="w"> </span><span class="c1">// true</span><span class="w"></span>
<span class="nx">xiaoming</span><span class="p">.</span><span class="kr">constructor</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="nx">Student</span><span class="p">;</span><span class="w"> </span><span class="c1">// true</span><span class="w"></span>

<span class="nb">Object</span><span class="p">.</span><span class="nx">getPrototypeOf</span><span class="p">(</span><span class="nx">xiaoming</span><span class="p">)</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="nx">Student</span><span class="p">.</span><span class="nx">prototype</span><span class="p">;</span><span class="w"> </span><span class="c1">// true</span><span class="w"></span>

<span class="nx">xiaoming</span><span class="w"> </span><span class="ow">instanceof</span><span class="w"> </span><span class="nx">Student</span><span class="p">;</span><span class="w"> </span><span class="c1">// true</span><span class="w"></span>
</code></pre></div>
<p><img alt="" src="../media/js-note/2022-02-10-16-16-07.png" /></p>
<ul>
<li>红色箭头是原型链。注意，<code>Student.prototype</code>指向的对象就是<code>xiaoming</code>、<code>xiaohong</code>的原型对象，这个原型对象自己还有个属性<code>constructor</code>，指向<code>Student</code>函数本身。</li>
<li>另外，函数<code>Student</code>恰好有个属性<code>prototype</code>指向<code>xiaoming</code>、<code>xiaohong</code>的原型对象，但是<code>xiaoming</code>、<code>xiaohong</code>这些对象可没有<code>prototype</code>这个属性，不过可以用<code>__proto__</code>这个非标准用法来查看。</li>
<li>现在我们就认为<code>xiaoming</code>、<code>xiaohong</code>这些对象“继承”自<code>Student</code>。</li>
</ul>
<p>另外, 为了避免构造函数索构造出来的「实例」对象包含重复代码 (例如上例中的 hello 方法会绑定到各个实例上, 浪费内存), 可以将方法绑定在其原型上.</p>
<p><img alt="" src="../media/js-note/2022-02-10-16-22-43.png" /></p>
<div class="highlight"><pre><span></span><code><span class="kd">function</span><span class="w"> </span><span class="nx">Student</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">name</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="nx">Student</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">hello</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="nx">alert</span><span class="p">(</span><span class="s1">&#39;Hello, &#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">name</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;!&#39;</span><span class="p">);</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>
</code></pre></div>
<h5 id="_36">规范的做法<a class="headerlink" href="#_36" title="Permanent link">&para;</a></h5>
<ul>
<li>忘记写 new 的后果: 在strict模式下，<code>this.name = name</code>将报错，因为<code>this</code>绑定为<code>undefined</code>，在非strict模式下，<code>this.name = name</code>不报错，因为<code>this</code>绑定为<code>window</code>，于是无意间创建了全局变量<code>name</code>，并且返回<code>undefined</code>，这个结果更糟糕。</li>
<li>因此, 遵循一些规范<ul>
<li>构造函数首字母应当大写，而普通函数首字母应当小写, 这样，一些语法检查工具如 <a href="http://www.jslint.com/">jslint</a> 将可以帮你检测到漏写的<code>new</code>。</li>
<li>还可以编写一个<code>createStudent()</code>函数，在内部封装所有的<code>new</code>操作<ul>
<li>好处: 一是不需要<code>new</code>来调用，二是参数非常灵活 (字典形式传参)</li>
</ul>
</li>
</ul>
</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="kd">function</span><span class="w"> </span><span class="nx">Student</span><span class="p">(</span><span class="nx">props</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">props</span><span class="p">.</span><span class="nx">name</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="s1">&#39;匿名&#39;</span><span class="p">;</span><span class="w"> </span><span class="c1">// 默认值为&#39;匿名&#39;</span><span class="w"></span>
<span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">grade</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">props</span><span class="p">.</span><span class="nx">grade</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="mf">1</span><span class="p">;</span><span class="w"> </span><span class="c1">// 默认值为1</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="nx">Student</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">hello</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="nx">alert</span><span class="p">(</span><span class="s1">&#39;Hello, &#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">name</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;!&#39;</span><span class="p">);</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="kd">function</span><span class="w"> </span><span class="nx">createStudent</span><span class="p">(</span><span class="nx">props</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">Student</span><span class="p">(</span><span class="nx">props</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="p">{})</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kd">var</span><span class="w"> </span><span class="nx">xiaoming</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">createStudent</span><span class="p">({</span><span class="w"></span>
<span class="w"> </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;小明&#39;</span><span class="w"></span>
<span class="p">});</span><span class="w"></span>
<span class="nx">xiaoming</span><span class="p">.</span><span class="nx">grade</span><span class="p">;</span><span class="w"> </span><span class="c1">// 1</span><span class="w"></span>
</code></pre></div>
<h3 id="_37">原型继承<a class="headerlink" href="#_37" title="Permanent link">&para;</a></h3>
<ul>
<li>注意<ul>
<li><code>prototype</code> 是 (构造) 函数独有的属性</li>
<li><code>__proto__</code> 和 <code>constructor</code> 是对象的属性; 但是由于 JS 中函数也是一种对象，所以函数也拥有</li>
</ul>
</li>
<li>不应该操作 <code>__proto__</code> 属性</li>
<li>一个构造函数及其所构造出来的对象满足关系 <code>foo.__proto__ === Foo.prototype</code> , 这里的 foo 通过 <code>new Foo()</code> 构造.</li>
</ul>
<p>JavaScript的原型继承实现方式就是：</p>
<ul>
<li>定义新的构造函数，并在内部用 <code>call()</code> 调用希望“继承”的构造函数，并绑定 <code>this</code>；</li>
<li>借助中间函数 F 实现原型链继承，最好通过封装的 inherits 函数完成；</li>
<li>继续在新的构造函数的原型上定义新方法。</li>
</ul>
<p>这里 F 函数的作用:</p>
<ol>
<li>指定构造函数 F 的 prototype 属性(注意prototype为函数所特有的属性) 为 Student.prototype; 从而使得 new 出来的 F对象有属性 <code>(new F()).__proto__ === Student.prototype</code></li>
<li>构造一个 F对象 (记为 f), 这个对象就是我们要构造的 PrimaryStudent.prototype 原型, 通过 1 我们指定好了这一对象 <code>__proto__</code> 属性</li>
<li>链接 对象f 和 构造函数PrimaryStudent, 使得它们互为 constructor, prototype</li>
</ol>
<p>我们希望完成一个 PrimaryStudent 构造函数, 使其继承 Student 函数. 也即继承链 <code>new PrimaryStudent() ----&gt; PrimaryStudent.prototype ----&gt; Student.prototype ----&gt; Object.prototype ----&gt; null</code></p>
<div class="highlight"><pre><span></span><code><span class="cm">/* 实现 PrimaryStudent 继承 Student */</span><span class="w"></span>
<span class="kd">function</span><span class="w"> </span><span class="nx">Student</span><span class="p">(</span><span class="nx">props</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">props</span><span class="p">.</span><span class="nx">name</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="s2">&quot;Unnamed&quot;</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
<span class="nx">Student</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">hello</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="nx">alert</span><span class="p">(</span><span class="s2">&quot;Hello, &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">name</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">&quot;!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="c1">// PrimaryStudent构造函数:</span><span class="w"></span>
<span class="kd">function</span><span class="w"> </span><span class="nx">PrimaryStudent</span><span class="p">(</span><span class="nx">props</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="nx">Student</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="w"> </span><span class="nx">props</span><span class="p">);</span><span class="w"> </span><span class="c1">// 注意调用了 Student 构造函数, 传入 this</span><span class="w"></span>
<span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">grade</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">props</span><span class="p">.</span><span class="nx">grade</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="mf">1</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="cm">/* 以下这块代码可以用下面实现的 inherits 函数替代</span>
<span class="cm"> 这里 F 函数的作用: </span>
<span class="cm"> 1. 指定构造函数 F 的 prototype 属性(注意prototype为函数所特有的属性) 为 Student.prototype; 从而使得 new 出来的 F对象有属性 `(new F()).__proto__ === Student.prototype`</span>
<span class="cm"> 2. 构造一个 F对象 (记为 f), 这个对象就是我们要构造的 PrimaryStudent.prototype 原型, 通过 1 我们指定好了这一对象 `__proto__` 属性</span>
<span class="cm"> 3. 链接 对象f 和 构造函数PrimaryStudent, 使得它们互为 constructor, prototype</span>
<span class="cm">*/</span><span class="w"></span>
<span class="c1">// 空函数F:</span><span class="w"></span>
<span class="kd">function</span><span class="w"> </span><span class="nx">F</span><span class="p">()</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>
<span class="c1">// 把F的原型指向Student.prototype:</span><span class="w"></span>
<span class="nx">F</span><span class="p">.</span><span class="nx">prototype</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">Student</span><span class="p">.</span><span class="nx">prototype</span><span class="p">;</span><span class="w"></span>
<span class="c1">// 把PrimaryStudent的原型指向一个新的F对象，F对象的原型正好指向Student.prototype:</span><span class="w"></span>
<span class="nx">PrimaryStudent</span><span class="p">.</span><span class="nx">prototype</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">F</span><span class="p">();</span><span class="w"></span>
<span class="c1">// 把PrimaryStudent原型的构造函数修复为PrimaryStudent:</span><span class="w"></span>
<span class="nx">PrimaryStudent</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="kr">constructor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">PrimaryStudent</span><span class="p">;</span><span class="w"></span>

<span class="c1">// 继续在PrimaryStudent原型（就是new F()对象）上定义方法：</span><span class="w"></span>
<span class="nx">PrimaryStudent</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">getGrade</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">grade</span><span class="p">;</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="c1">// 创建xiaoming:</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">xiaoming</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">PrimaryStudent</span><span class="p">({</span><span class="w"></span>
<span class="w"> </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;小明&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w"> </span><span class="nx">grade</span><span class="o">:</span><span class="w"> </span><span class="mf">2</span><span class="p">,</span><span class="w"></span>
<span class="p">});</span><span class="w"></span>
<span class="nx">xiaoming</span><span class="p">.</span><span class="nx">name</span><span class="p">;</span><span class="w"> </span><span class="c1">// &#39;小明&#39;</span><span class="w"></span>
<span class="nx">xiaoming</span><span class="p">.</span><span class="nx">grade</span><span class="p">;</span><span class="w"> </span><span class="c1">// 2</span><span class="w"></span>

<span class="c1">// 验证原型:</span><span class="w"></span>
<span class="nx">xiaoming</span><span class="p">.</span><span class="nx">__proto__</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="nx">PrimaryStudent</span><span class="p">.</span><span class="nx">prototype</span><span class="p">;</span><span class="w"> </span><span class="c1">// true</span><span class="w"></span>
<span class="nx">xiaoming</span><span class="p">.</span><span class="nx">__proto__</span><span class="p">.</span><span class="nx">__proto__</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="nx">Student</span><span class="p">.</span><span class="nx">prototype</span><span class="p">;</span><span class="w"> </span><span class="c1">// true</span><span class="w"></span>

<span class="c1">// 验证继承关系:</span><span class="w"></span>
<span class="nx">xiaoming</span><span class="w"> </span><span class="ow">instanceof</span><span class="w"> </span><span class="nx">PrimaryStudent</span><span class="p">;</span><span class="w"> </span><span class="c1">// true</span><span class="w"></span>
<span class="nx">xiaoming</span><span class="w"> </span><span class="ow">instanceof</span><span class="w"> </span><span class="nx">Student</span><span class="p">;</span><span class="w"> </span><span class="c1">// true</span><span class="w"></span>
</code></pre></div>
<p><img alt="" src="../media/js-note/2022-02-10-16-42-39.png" /></p>
<ul>
<li>注意，函数<code>F</code>仅用于桥接，我们仅创建了一个<code>new F()</code>实例，而且，没有改变原有的<code>Student</code>定义的原型链。</li>
<li>如果把继承这个动作用一个<code>inherits()</code>函数封装起来，还可以隐藏<code>F</code>的定义，并简化代码</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="kd">function</span><span class="w"> </span><span class="nx">inherits</span><span class="p">(</span><span class="nx">Child</span><span class="p">,</span><span class="w"> </span><span class="nx">Parent</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="kd">var</span><span class="w"> </span><span class="nx">F</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{};</span><span class="w"></span>
<span class="w"> </span><span class="nx">F</span><span class="p">.</span><span class="nx">prototype</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">Parent</span><span class="p">.</span><span class="nx">prototype</span><span class="p">;</span><span class="w"></span>
<span class="w"> </span><span class="nx">Child</span><span class="p">.</span><span class="nx">prototype</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">F</span><span class="p">();</span><span class="w"></span>
<span class="w"> </span><span class="nx">Child</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="kr">constructor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">Child</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<h3 id="class">class继承<a class="headerlink" href="#class" title="Permanent link">&para;</a></h3>
<ul>
<li>新的关键字<code>class</code>从ES6开始正式被引入到JavaScript中。<code>class</code>的目的就是让定义类更简单。</li>
<li>语法规则<ul>
<li><code>class</code>的定义包含了构造函数<code>constructor</code>和定义在原型对象上的函数<code>hello()</code>（注意没有<code>function</code>关键字），这样就避免了<code>Student.prototype.hello = function () {...}</code>这样分散的代码。</li>
</ul>
</li>
<li>class 继承: <code>extends</code> 关键词<ul>
<li><code>class PrimaryStudent extends Student {}</code></li>
<li>记得在 constructor 函数中调用父类的构造方法 <code>super(name);</code></li>
</ul>
</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="c1">// 之前的写法</span><span class="w"></span>
<span class="kd">function</span><span class="w"> </span><span class="nx">Student</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">name</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
<span class="nx">Student</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">hello</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="nx">alert</span><span class="p">(</span><span class="s1">&#39;Hello, &#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">name</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;!&#39;</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// 用 class 关键词来写</span><span class="w"></span>
<span class="kd">class</span><span class="w"> </span><span class="nx">Student</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="kr">constructor</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="k">this</span><span class="p">.</span><span class="nx">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">name</span><span class="p">;</span><span class="w"></span>
<span class="w"> </span><span class="p">}</span><span class="w"></span>

<span class="w"> </span><span class="nx">hello</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="nx">alert</span><span class="p">(</span><span class="s1">&#39;Hello, &#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">name</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;!&#39;</span><span class="p">);</span><span class="w"></span>
<span class="w"> </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kd">var</span><span class="w"> </span><span class="nx">xiaoming</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">Student</span><span class="p">(</span><span class="s1">&#39;小明&#39;</span><span class="p">);</span><span class="w"></span>
<span class="nx">xiaoming</span><span class="p">.</span><span class="nx">hello</span><span class="p">();</span><span class="w"></span>
</code></pre></div>
<p>继承</p>
<ul>
<li>注意<code>PrimaryStudent</code>的定义也是class关键字实现的，而<code>extends</code>则表示原型链对象来自<code>Student</code>。子类的构造函数可能会与父类不太相同，例如，<code>PrimaryStudent</code>需要<code>name</code>和<code>grade</code>两个参数，并且需要通过<code>super(name)</code>来调用父类的构造函数，否则父类的<code>name</code>属性无法正常初始化。</li>
<li><code>PrimaryStudent</code>已经自动获得了父类<code>Student</code>的<code>hello</code>方法，我们又在子类中定义了新的<code>myGrade</code>方法。</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="kd">class</span><span class="w"> </span><span class="nx">PrimaryStudent</span><span class="w"> </span><span class="k">extends</span><span class="w"> </span><span class="nx">Student</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="kr">constructor</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span><span class="w"> </span><span class="nx">grade</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="k">super</span><span class="p">(</span><span class="nx">name</span><span class="p">);</span><span class="w"> </span><span class="c1">// 记得用super调用父类的构造方法!</span><span class="w"></span>
<span class="w">  </span><span class="k">this</span><span class="p">.</span><span class="nx">grade</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">grade</span><span class="p">;</span><span class="w"></span>
<span class="w"> </span><span class="p">}</span><span class="w"></span>

<span class="w"> </span><span class="nx">myGrade</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="nx">alert</span><span class="p">(</span><span class="s1">&#39;I am at grade &#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">grade</span><span class="p">);</span><span class="w"></span>
<span class="w"> </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<h2 id="_38">浏览器<a class="headerlink" href="#_38" title="Permanent link">&para;</a></h2>
<h3 id="_39">浏览器对象<a class="headerlink" href="#_39" title="Permanent link">&para;</a></h3>
<ul>
<li>window<ul>
<li>window 对象不但充当全局作用域，而且表示浏览器窗口</li>
<li>属性: innerWidth, outterHeight</li>
</ul>
</li>
<li>navigator<ul>
<li>navigator 对象表示浏览器的信息</li>
<li>属性: appName, appVersion, language, platform, userAgent</li>
</ul>
</li>
<li>screen<ul>
<li>screen 对象表示屏幕的信息</li>
<li>属性: width, height, colorDepth</li>
</ul>
</li>
<li>location<ul>
<li>location 对象表示当前页面的URL信息</li>
<li>属性<ul>
<li><code>href</code> 完整 URL, 例如 <code>http://www.example.com:8080/path/index.html?a=1&amp;b=2#TOP</code></li>
<li><code>protocol</code>, <code>host</code>, <code>port</code>, <code>pathname</code></li>
<li><code>search</code>, <code>hash</code></li>
</ul>
</li>
<li>方法: assign, reload</li>
</ul>
</li>
<li>document<ul>
<li>document对象表示当前页面。由于HTML在浏览器中以DOM形式表示为树形结构，document对象就是整个DOM树的根节点。</li>
<li>document的 <code>title</code> 属性是从HTML文档中的 <code>&lt;title&gt;xxx&lt;/title&gt;</code> 读取的，但是可以动态改变</li>
<li>document对象还有一个 <code>cookie</code> 属性，可以获取当前页面的Cookie</li>
<li>方法: getElementById, getElementsByTagName</li>
</ul>
</li>
<li>history<ul>
<li><code>history</code>对象保存了浏览器的历史记录</li>
<li>JavaScript可以调用<code>history</code>对象的<code>back()</code>或<code>forward()</code>，相当于用户点击了浏览器的“后退”或“前进”按钮</li>
<li>不应该使用</li>
</ul>
</li>
</ul>
<h4 id="window">window<a class="headerlink" href="#window" title="Permanent link">&para;</a></h4>
<ul>
<li><code>window</code>对象不但充当全局作用域，而且表示浏览器窗口。</li>
<li><code>window</code>对象有<code>innerWidth</code>和<code>innerHeight</code>属性，可以获取浏览器窗口的内部宽度和高度。内部宽高是指除去菜单栏、工具栏、边框等占位元素后，用于显示网页的净宽高。</li>
<li>对应的，还有一个<code>outerWidth</code>和<code>outerHeight</code>属性，可以获取浏览器窗口的整个宽高。</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="c1">// 可以调整浏览器窗口大小试试:</span><span class="w"></span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;window inner size: &#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">window</span><span class="p">.</span><span class="nx">innerWidth</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39; x &#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">window</span><span class="p">.</span><span class="nx">innerHeight</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<h4 id="navigator">navigator<a class="headerlink" href="#navigator" title="Permanent link">&para;</a></h4>
<p><code>navigator</code>对象表示浏览器的信息，最常用的属性包括：</p>
<ul>
<li>navigator.appName：浏览器名称；</li>
<li>navigator.appVersion：浏览器版本；</li>
<li>navigator.language：浏览器设置的语言；</li>
<li>navigator.platform：操作系统类型；</li>
<li>navigator.userAgent：浏览器设定的<code>User-Agent</code>字符串。</li>
</ul>
<p>请注意，<code>navigator</code>的信息可以很容易地被用户修改，所以JavaScript读取的值不一定是正确的。很多初学者为了针对不同浏览器编写不同的代码，喜欢用<code>if</code>判断浏览器版本，例如：</p>
<div class="highlight"><pre><span></span><code><span class="kd">var</span><span class="w"> </span><span class="nx">width</span><span class="p">;</span><span class="w"> </span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">getIEVersion</span><span class="p">(</span><span class="nx">navigator</span><span class="p">.</span><span class="nx">userAgent</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">9</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span>
<span class="w"> </span><span class="nx">width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">clientWidth</span><span class="p">;</span><span class="w"> </span>
<span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w"> </span>
<span class="w"> </span><span class="nx">width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">window</span><span class="p">.</span><span class="nx">innerWidth</span><span class="p">;</span><span class="w"> </span>
<span class="p">}</span><span class="w"> </span>
</code></pre></div>
<p>但这样既可能判断不准确，也很难维护代码。正确的方法是充分利用JavaScript对不存在属性返回<code>undefined</code>的特性，直接用短路运算符<code>||</code>计算：</p>
<div class="highlight"><pre><span></span><code><span class="kd">var</span><span class="w"> </span><span class="nx">width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">window</span><span class="p">.</span><span class="nx">innerWidth</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">clientWidth</span><span class="p">;</span><span class="w"></span>
</code></pre></div>
<h4 id="screen">screen<a class="headerlink" href="#screen" title="Permanent link">&para;</a></h4>
<p><code>screen</code>对象表示屏幕的信息，常用的属性有：</p>
<ul>
<li>screen.width：屏幕宽度，以像素为单位；</li>
<li>screen.height：屏幕高度，以像素为单位；</li>
<li>screen.colorDepth：返回颜色位数，如8、16、24。</li>
</ul>
<h4 id="location">location<a class="headerlink" href="#location" title="Permanent link">&para;</a></h4>
<p><code>location</code>对象表示当前页面的URL信息。例如，一个完整的URL：<code>http://www.example.com:8080/path/index.html?a=1&amp;b=2#TOP</code></p>
<p>可以用<code>location.href</code>获取。要获得URL各个部分的值，可以这么写：</p>
<div class="highlight"><pre><span></span><code><span class="nx">location</span><span class="p">.</span><span class="nx">protocol</span><span class="p">;</span><span class="w"> </span><span class="c1">// &#39;http&#39;</span><span class="w"></span>
<span class="nx">location</span><span class="p">.</span><span class="nx">host</span><span class="p">;</span><span class="w"> </span><span class="c1">// &#39;www.example.com&#39;</span><span class="w"></span>
<span class="nx">location</span><span class="p">.</span><span class="nx">port</span><span class="p">;</span><span class="w"> </span><span class="c1">// &#39;8080&#39;</span><span class="w"></span>
<span class="nx">location</span><span class="p">.</span><span class="nx">pathname</span><span class="p">;</span><span class="w"> </span><span class="c1">// &#39;/path/index.html&#39;</span><span class="w"></span>
<span class="nx">location</span><span class="p">.</span><span class="nx">search</span><span class="p">;</span><span class="w"> </span><span class="c1">// &#39;?a=1&amp;b=2&#39;</span><span class="w"></span>
<span class="nx">location</span><span class="p">.</span><span class="nx">hash</span><span class="p">;</span><span class="w"> </span><span class="c1">// &#39;TOP&#39;</span><span class="w"></span>
</code></pre></div>
<p>要加载一个新页面，可以调用<code>location.assign()</code>。如果要重新加载当前页面，调用<code>location.reload()</code>方法非常方便。</p>
<div class="highlight"><pre><span></span><code><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">confirm</span><span class="p">(</span><span class="s1">&#39;重新加载当前页&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">location</span><span class="p">.</span><span class="nx">href</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;?&#39;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="nx">location</span><span class="p">.</span><span class="nx">reload</span><span class="p">();</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="nx">location</span><span class="p">.</span><span class="nx">assign</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">);</span><span class="w"> </span><span class="c1">// 设置一个新的URL地址</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<h4 id="document">document<a class="headerlink" href="#document" title="Permanent link">&para;</a></h4>
<ul>
<li><code>document</code>对象表示当前页面。由于HTML在浏览器中以DOM形式表示为树形结构，<code>document</code>对象就是整个DOM树的根节点。</li>
<li><code>document</code>的<code>title</code>属性是从HTML文档中的<code>&lt;title&gt;xxx&lt;/title&gt;</code>读取的，但是可以动态改变：</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="nb">document</span><span class="p">.</span><span class="nx">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;努力学习JavaScript!&#39;</span><span class="p">;</span><span class="w"></span>
</code></pre></div>
<ul>
<li>用<code>document</code>对象提供的<code>getElementById()</code>和<code>getElementsByTagName()</code>可以按ID获得一个DOM节点和按Tag名称获得一组DOM节点</li>
<li><code>document</code>对象还有一个<code>cookie</code>属性，可以获取当前页面的Cookie。</li>
</ul>
<p>Cookie 简介</p>
<ul>
<li>Cookie是由服务器发送的key-value标示符。因为HTTP协议是无状态的，但是服务器要区分到底是哪个用户发过来的请求，就可以用Cookie来区分。当一个用户成功登录后，服务器发送一个Cookie给浏览器，例如<code>user=ABC123XYZ(加密的字符串)...</code>，此后，浏览器访问该网站时，会在请求头附上这个Cookie，服务器根据Cookie即可区分出用户。</li>
<li>Cookie还可以存储网站的一些设置，例如，页面显示的语言等等。</li>
</ul>
<p>安全性</p>
<ul>
<li>由于JavaScript能读取到页面的Cookie，而用户的登录信息通常也存在Cookie中，这就造成了巨大的安全隐患。</li>
<li>为了解决这个问题，服务器在设置Cookie时可以使用<code>httpOnly</code>，设定了<code>httpOnly</code>的Cookie将不能被JavaScript读取。</li>
<li>为了确保安全，服务器端在设置Cookie时，应该始终坚持使用httpOnly。</li>
</ul>
<h4 id="history">history<a class="headerlink" href="#history" title="Permanent link">&para;</a></h4>
<ul>
<li><code>history</code>对象保存了浏览器的历史记录，JavaScript可以调用<code>history</code>对象的<code>back()</code>或<code>forward ()</code>，相当于用户点击了浏览器的“后退”或“前进”按钮。</li>
<li>这个对象属于历史遗留对象，对于现代Web页面来说，由于大量使用AJAX和页面交互，简单粗暴地调用<code>history.back()</code>可能会让用户感到非常愤怒。</li>
<li>新手开始设计Web页面时喜欢在登录页登录成功时调用<code>history.back()</code>，试图回到登录前的页面。这是一种错误的方法。</li>
<li>任何情况，你都不应该使用<code>history</code>这个对象了。</li>
</ul>
<h3 id="dom">操作 DOM<a class="headerlink" href="#dom" title="Permanent link">&para;</a></h3>
<ul>
<li>由于HTML文档被浏览器解析后就是一棵DOM树，要改变HTML的结构，就需要通过JavaScript来操作DOM</li>
<li>包括: 更新, 遍历, 添加, 删除</li>
<li>拿到 DOM 节点<ul>
<li><code>document.getElementById()</code>, <code>document.getElementsByTagName()</code>，以及CSS选择器 <code>document.getElementsByClassName()</code><ul>
<li>由于ID在HTML文档中是唯一的，所以<code>document.getElementById()</code>可以直接定位唯一的一个DOM节点。<code>document.getElementsByTagName()</code>和<code>document.getElementsByClassName()</code>总是返回一组DOM节点。要精确地选择DOM，可以先定位父节点，再从父节点开始选择，以缩小范围</li>
</ul>
</li>
<li>第二种方法是使用 <code>querySelector()</code> 和 <code>querySelectorAll()</code>，需要了解selector语法，然后使用条件来获取节点</li>
</ul>
</li>
<li>DOM<ul>
<li>DOM节点实际上是 <code>Node</code>，在HTML中，Node包括Element、Comment、CDATA_SECTION等很多种，以及根节点 Document类型，但是，绝大多数时候我们只关心 Element，也就是实际控制页面结构的Node，其他类型的Node忽略即可。<ul>
<li>根节点Document已经自动绑定为全局变量document。</li>
<li>严格地讲，我们这里的DOM节点是指Element</li>
</ul>
</li>
<li>innerHTML, innerText</li>
<li>id</li>
<li>parentNode</li>
<li><code>children</code><ul>
<li>注意返回的是 HTMLCollection, 若需要操作, 需要 <code>Arrray.from()</code> 转化为列表</li>
<li>参见 <a href="https://developer.mozilla.org/en-US/docs/Web/API/HTMLCollection">here</a></li>
</ul>
</li>
<li>firstElementChild, lastElementChild</li>
<li>setAttribute 方法, 例如 <code>setAttribute('type', 'text/css')</code></li>
</ul>
</li>
<li>更新<ul>
<li>修改节点的文本<ul>
<li>一种是修改<code>innerHTML</code>属性</li>
<li>第二种是修改<code>innerText</code>或<code>textContent</code>属性，这样可以自动对字符串进行HTML编码，保证无法设置任何HTML标签<ul>
<li>两者的区别在于读取属性时，innerText不返回隐藏元素的文本，而textContent返回所有文本</li>
</ul>
</li>
</ul>
</li>
<li>修改 CSS<ul>
<li>DOM节点的style属性对应所有的CSS，可以直接获取或设置。因为CSS允许font-size这样的名称，但它并非JavaScript有效的属性名，所以需要在JavaScript中改写为驼峰式命名fontSize</li>
</ul>
</li>
</ul>
</li>
<li>插入<ul>
<li><code>appendChild</code>，把一个节点添加到父节点的最后一个子节点</li>
<li>添加的节点可以是原本 DOM 就有的, 也可以是新建的<ul>
<li>例如, <code>document.createElement('p')</code>, 并修改 innerText 等属性</li>
</ul>
</li>
<li>通过这种方法, 还可以动态创建 <code>&lt;style&gt;</code> 节点, 将其放在 head 节点可以更新页面样式</li>
<li>想要插入到指定位置, 可以用 <code>parentElement.insertBefore(newElement, referenceElement);</code></li>
</ul>
</li>
<li>删除<ul>
<li>removeChild 方法, 例如 <code>parent.removeChild(parent.children[0])</code> 删除 parnet 的第一个子节点</li>
</ul>
</li>
</ul>
<h4 id="get-queryselector">get, querySelector<a class="headerlink" href="#get-queryselector" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="c1">// 1. </span><span class="w"></span>
<span class="c1">// 返回ID为&#39;test&#39;的节点：</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">test</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">);</span><span class="w"></span>
<span class="c1">// 先定位ID为&#39;test-table&#39;的节点，再返回其内部所有tr节点：</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">trs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;test-table&#39;</span><span class="p">).</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="s1">&#39;tr&#39;</span><span class="p">);</span><span class="w"></span>
<span class="c1">// 先定位ID为&#39;test-div&#39;的节点，再返回其内部所有class包含red的节点：</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">reds</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;test-div&#39;</span><span class="p">).</span><span class="nx">getElementsByClassName</span><span class="p">(</span><span class="s1">&#39;red&#39;</span><span class="p">);</span><span class="w"></span>
<span class="c1">// 获取节点test下的所有直属子节点:</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">cs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">test</span><span class="p">.</span><span class="nx">children</span><span class="p">;</span><span class="w"></span>
<span class="c1">// 获取节点test下第一个、最后一个子节点：</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">first</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">test</span><span class="p">.</span><span class="nx">firstElementChild</span><span class="p">;</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">last</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">test</span><span class="p">.</span><span class="nx">lastElementChild</span><span class="p">;</span><span class="w"></span>

<span class="c1">// 2. querySelector</span><span class="w"></span>
<span class="c1">// 通过querySelector获取ID为q1的节点：</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">q1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">&#39;#q1&#39;</span><span class="p">);</span><span class="w"></span>
<span class="c1">// 通过querySelectorAll获取q1节点内的符合条件的所有节点：</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">ps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">q1</span><span class="p">.</span><span class="nx">querySelectorAll</span><span class="p">(</span><span class="s1">&#39;div.highlighted &gt; p&#39;</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1">// see https://www.liaoxuefeng.com/wiki/1022910821149312/1023022310122752</span><span class="w"></span>
<span class="nx">js</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s2">&quot;#test-p&quot;</span><span class="p">);</span><span class="w"></span>
<span class="c1">// 选择 class 为 c-red c-green 的元素, 的所有 p 子节点</span><span class="w"></span>
<span class="nx">arr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">querySelectorAll</span><span class="p">(</span><span class="s2">&quot;#test-div .c-red.c-green p&quot;</span><span class="p">);</span><span class="w"></span>
<span class="c1">// 选择 id 为 test-div 元素的最后一个 div 子节点, 的最后一个 p 子节点</span><span class="w"></span>
<span class="nx">haskell</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s2">&quot;#test-div div:last-child p:last-child&quot;</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<h4 id="dom_1">更新 DOM<a class="headerlink" href="#dom_1" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="c1">// 1. 修改 innerHTML</span><span class="w"></span>
<span class="c1">// 获取&lt;p id=&quot;p-id&quot;&gt;...&lt;/p&gt;</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;p-id&#39;</span><span class="p">);</span><span class="w"></span>
<span class="c1">// 设置文本为abc:</span><span class="w"></span>
<span class="nx">p</span><span class="p">.</span><span class="nx">innerHTML</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;ABC&#39;</span><span class="p">;</span><span class="w"> </span><span class="c1">// &lt;p id=&quot;p-id&quot;&gt;ABC&lt;/p&gt;</span><span class="w"></span>
<span class="c1">// 设置HTML:</span><span class="w"></span>
<span class="nx">p</span><span class="p">.</span><span class="nx">innerHTML</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;ABC &lt;span style=&quot;color:red&quot;&gt;RED&lt;/span&gt; XYZ&#39;</span><span class="p">;</span><span class="w"></span>
<span class="c1">// &lt;p&gt;...&lt;/p&gt;的内部结构已修改</span><span class="w"></span>

<span class="c1">// 2. 修改 innerText</span><span class="w"></span>
<span class="c1">// 获取&lt;p id=&quot;p-id&quot;&gt;...&lt;/p&gt;</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;p-id&#39;</span><span class="p">);</span><span class="w"></span>
<span class="c1">// 设置文本:</span><span class="w"></span>
<span class="nx">p</span><span class="p">.</span><span class="nx">innerText</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;&lt;script&gt;alert(&quot;Hi&quot;)&lt;/script&gt;&#39;</span><span class="p">;</span><span class="w"></span>
<span class="c1">// HTML被自动编码，无法设置一个&lt;script&gt;节点:</span><span class="w"></span>
<span class="c1">// &lt;p id=&quot;p-id&quot;&gt;&amp;lt;script&amp;gt;alert(&quot;Hi&quot;)&amp;lt;/script&amp;gt;&lt;/p&gt;</span><span class="w"></span>

<span class="c1">// CSS</span><span class="w"></span>
<span class="c1">// 获取&lt;p id=&quot;p-id&quot;&gt;...&lt;/p&gt;</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;p-id&#39;</span><span class="p">);</span><span class="w"></span>
<span class="c1">// 设置CSS:</span><span class="w"></span>
<span class="nx">p</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;#ff0000&#39;</span><span class="p">;</span><span class="w"></span>
<span class="nx">p</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">fontSize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;20px&#39;</span><span class="p">;</span><span class="w"></span>
<span class="nx">p</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">paddingTop</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;2em&#39;</span><span class="p">;</span><span class="w"></span>
</code></pre></div>
<h4 id="dom_2">插入 DOM<a class="headerlink" href="#dom_2" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="c1">// 1. 这里的 js 节点是原本 DOM 就有的, 这样会将其移动到 list 节点下</span><span class="w"></span>
<span class="kd">var</span><span class="w"></span>
<span class="w"> </span><span class="nx">js</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;js&#39;</span><span class="p">),</span><span class="w"></span>
<span class="w"> </span><span class="nx">list</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;list&#39;</span><span class="p">);</span><span class="w"></span>
<span class="nx">list</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">js</span><span class="p">);</span><span class="w"></span>
<span class="c1">// 2. 新建节点</span><span class="w"></span>
<span class="kd">var</span><span class="w"></span>
<span class="w"> </span><span class="nx">list</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;list&#39;</span><span class="p">),</span><span class="w"></span>
<span class="w"> </span><span class="nx">haskell</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;p&#39;</span><span class="p">);</span><span class="w"></span>
<span class="nx">haskell</span><span class="p">.</span><span class="nx">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;haskell&#39;</span><span class="p">;</span><span class="w"></span>
<span class="nx">haskell</span><span class="p">.</span><span class="nx">innerText</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Haskell&#39;</span><span class="p">;</span><span class="w"></span>
<span class="nx">list</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">haskell</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p>动态创建一个节点然后添加到DOM树中，可以实现很多功能。举个例子，下面的代码动态创建了一个<code>&lt;style&gt;</code>节点，然后把它添加到<code>&lt;head&gt;</code>节点的末尾，这样就动态地给文档添加了新的CSS定义</p>
<div class="highlight"><pre><span></span><code><span class="kd">var</span><span class="w"> </span><span class="nx">d</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;style&#39;</span><span class="p">);</span><span class="w"></span>
<span class="nx">d</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s1">&#39;type&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;text/css&#39;</span><span class="p">);</span><span class="w"></span>
<span class="nx">d</span><span class="p">.</span><span class="nx">innerHTML</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;p { color: red }&#39;</span><span class="p">;</span><span class="w"></span>
<span class="nb">document</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="s1">&#39;head&#39;</span><span class="p">)[</span><span class="mf">0</span><span class="p">].</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">d</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<h4 id="dom_3">删除 DOM<a class="headerlink" href="#dom_3" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="c1">// 拿到待删除节点:</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">self</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;to-be-removed&#39;</span><span class="p">);</span><span class="w"></span>
<span class="c1">// 拿到父节点:</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">parent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">self</span><span class="p">.</span><span class="nx">parentElement</span><span class="p">;</span><span class="w"></span>
<span class="c1">// 删除:</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">removed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">parent</span><span class="p">.</span><span class="nx">removeChild</span><span class="p">(</span><span class="nx">self</span><span class="p">);</span><span class="w"></span>
<span class="nx">removed</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="nx">self</span><span class="p">;</span><span class="w"> </span><span class="c1">// true</span><span class="w"></span>
</code></pre></div>
<h3 id="_40">操作表单<a class="headerlink" href="#_40" title="Permanent link">&para;</a></h3>
<ul>
<li>TODO:, see <a href="https://www.liaoxuefeng.com/wiki/1022910821149312/1023022460826944">here</a></li>
<li>先去看看 HTML</li>
</ul>
<p>HTML表单的输入控件主要有以下几种：</p>
<ul>
<li>文本框，对应的<code>&lt;input type="text"&gt;</code>，用于输入文本；</li>
<li>口令框，对应的<code>&lt;input type="password"&gt;</code>，用于输入口令；</li>
<li>单选框，对应的<code>&lt;input type="radio"&gt;</code>，用于选择一项；</li>
<li>复选框，对应的<code>&lt;input type="checkbox"&gt;</code>，用于选择多项；</li>
<li>下拉框，对应的<code>&lt;select&gt;</code>，用于选择一项；</li>
<li>隐藏文本，对应的<code>&lt;input type="hidden"&gt;</code>，用户不可见，但表单提交时会把隐藏文本发送到服务器。</li>
</ul>
<h3 id="_41">操作文件<a class="headerlink" href="#_41" title="Permanent link">&para;</a></h3>
<ul>
<li>在HTML表单中，可以上传文件的唯一控件就是<code>&lt;input type="file"&gt;</code><ul>
<li>当一个表单包含<code>&lt;input type="file"&gt;</code>时，表单的<code>enctype</code>必须指定为<code>multipart/form-data</code>，<code>method</code>必须指定为<code>post</code>，浏览器才能正确编码并以<code>multipart/form-data</code>格式发送表单的数据</li>
</ul>
</li>
<li>File API<ul>
<li>HTML5的File API提供了<code>File</code>和<code>FileReader</code>两个主要对象，可以获得文件信息并读取文件</li>
</ul>
</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="kd">var</span><span class="w"></span>
<span class="w"> </span><span class="nx">fileInput</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;test-image-file&#39;</span><span class="p">),</span><span class="w"></span>
<span class="w"> </span><span class="nx">info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;test-file-info&#39;</span><span class="p">),</span><span class="w"></span>
<span class="w"> </span><span class="nx">preview</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;test-image-preview&#39;</span><span class="p">);</span><span class="w"></span>
<span class="c1">// 监听change事件:</span><span class="w"></span>
<span class="nx">fileInput</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">&#39;change&#39;</span><span class="p">,</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="c1">// 清除背景图片:</span><span class="w"></span>
<span class="w"> </span><span class="nx">preview</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">backgroundImage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">;</span><span class="w"></span>
<span class="w"> </span><span class="c1">// 检查文件是否选择:</span><span class="w"></span>
<span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">fileInput</span><span class="p">.</span><span class="nx">value</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="nx">info</span><span class="p">.</span><span class="nx">innerHTML</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;没有选择文件&#39;</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="k">return</span><span class="p">;</span><span class="w"></span>
<span class="w"> </span><span class="p">}</span><span class="w"></span>
<span class="w"> </span><span class="c1">// 获取File引用:</span><span class="w"></span>
<span class="w"> </span><span class="kd">var</span><span class="w"> </span><span class="nx">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">fileInput</span><span class="p">.</span><span class="nx">files</span><span class="p">[</span><span class="mf">0</span><span class="p">];</span><span class="w"></span>
<span class="w"> </span><span class="c1">// 获取File信息:</span><span class="w"></span>
<span class="w"> </span><span class="nx">info</span><span class="p">.</span><span class="nx">innerHTML</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;文件: &#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">file</span><span class="p">.</span><span class="nx">name</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;&lt;br&gt;&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"></span>
<span class="w">      </span><span class="s1">&#39;大小: &#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">file</span><span class="p">.</span><span class="nx">size</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;&lt;br&gt;&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"></span>
<span class="w">      </span><span class="s1">&#39;修改: &#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">file</span><span class="p">.</span><span class="nx">lastModified</span><span class="p">;</span><span class="w"></span>
<span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">file</span><span class="p">.</span><span class="nx">type</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="s1">&#39;image/jpeg&#39;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">file</span><span class="p">.</span><span class="nx">type</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="s1">&#39;image/png&#39;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">file</span><span class="p">.</span><span class="nx">type</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="s1">&#39;image/gif&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="nx">alert</span><span class="p">(</span><span class="s1">&#39;不是有效的图片文件!&#39;</span><span class="p">);</span><span class="w"></span>
<span class="w">  </span><span class="k">return</span><span class="p">;</span><span class="w"></span>
<span class="w"> </span><span class="p">}</span><span class="w"></span>
<span class="w"> </span><span class="c1">// 读取文件:</span><span class="w"></span>
<span class="w"> </span><span class="kd">var</span><span class="w"> </span><span class="nx">reader</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">FileReader</span><span class="p">();</span><span class="w"></span>
<span class="w"> </span><span class="nx">reader</span><span class="p">.</span><span class="nx">onload</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="kd">var</span><span class="w"></span>
<span class="w">   </span><span class="nx">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">result</span><span class="p">;</span><span class="w"> </span><span class="c1">// &#39;data:image/jpeg;base64,/9j/4AAQSk...(base64编码)...&#39;            </span><span class="w"></span>
<span class="w">  </span><span class="nx">preview</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">backgroundImage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;url(&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">data</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;)&#39;</span><span class="p">;</span><span class="w"></span>
<span class="w"> </span><span class="p">};</span><span class="w"></span>
<span class="w"> </span><span class="c1">// 以DataURL的形式读取文件:</span><span class="w"></span>
<span class="w"> </span><span class="nx">reader</span><span class="p">.</span><span class="nx">readAsDataURL</span><span class="p">(</span><span class="nx">file</span><span class="p">);</span><span class="w"></span>
<span class="p">});</span><span class="w"></span>
</code></pre></div>
<p>上面的代码演示了如何通过HTML5的File API读取文件内容。以DataURL的形式读取到的文件是一个字符串，类似于<code>data:image/jpeg;base64,/9j/4AAQSk...(base64编码)...</code>，常用于设置图像。如果需要服务器端处理，把字符串<code>base64,</code>后面的字符发送给服务器并用Base64解码就可以得到原始文件的二进制内容。</p>
<h3 id="ajax">AJAX<a class="headerlink" href="#ajax" title="Permanent link">&para;</a></h3>
<p><a href="https://www.liaoxuefeng.com/wiki/1022910821149312/1023022332902400">here</a></p>
<ul>
<li>AJAX不是JavaScript的规范，它只是一个哥们“发明”的缩写：Asynchronous JavaScript and XML，意思就是用JavaScript执行异步网络请求。<ul>
<li>如果仔细观察一个Form的提交，你就会发现，一旦用户点击“Submit”按钮，表单开始提交，浏览器就会刷新页面，然后在新页面里告诉你操作是成功了还是失败了。如果不幸由于网络太慢或者其他原因，就会得到一个404页面。</li>
<li>这就是Web的运作原理：一次HTTP请求对应一个页面。</li>
<li>如果要让用户留在当前页面中，同时发出新的HTTP请求，就必须用JavaScript发送这个新请求，接收到数据后，再用JavaScript更新页面，这样一来，用户就感觉自己仍然停留在当前页面，但是数据却可以不断地更新。</li>
<li>用JavaScript写一个完整的AJAX代码并不复杂，但是需要注意：AJAX请求是异步执行的，也就是说，要通过回调函数获得响应。</li>
</ul>
</li>
<li>在现代浏览器上写AJAX主要依靠 <code>XMLHttpRequest</code> 对象<ul>
<li>新建 <code>XMLHttpRequest()</code> 对象</li>
<li>当创建了<code>XMLHttpRequest</code>对象后，要先设置<code>onreadystatechange</code>的回调函数。在回调函数中，通常我们只需通过<code>readyState === 4</code>判断请求是否完成，如果已完成，再根据<code>status === 200</code>判断是否是一个成功的响应。</li>
<li><code>XMLHttpRequest</code>对象的<code>open()</code>方法有3个参数，第一个参数指定是<code>GET</code>还是<code>POST</code>，第二个参数指定URL地址，第三个参数指定是否使用异步，默认是<code>true</code>，所以不用写。<ul>
<li>注意，千万不要把第三个参数指定为<code>false</code>，否则浏览器将停止响应，直到AJAX请求完成。如果这个请求耗时10秒，那么10秒内你会发现浏览器处于“假死”状态。</li>
</ul>
</li>
<li>后调用<code>send()</code>方法才真正发送请求。<code>GET</code>请求不需要参数，<code>POST</code>请求需要把body部分以字符串或者<code>FormData</code>对象传进去。</li>
</ul>
</li>
<li>安全限制<ul>
<li><strong>浏览器的同源策略</strong>: 默认情况下，JavaScript在发送AJAX请求时，URL的域名必须和当前页面完全一致。(域名、协议、端口号)</li>
<li>用 JavaScript 请求外域 URL 的方法<ul>
<li>通过Flash插件发送HTTP请求, 弃之</li>
<li>通过在同源域名下架设一个代理服务器来转发, 也即 js 将请求发送到 <code>'/proxy?url=http://www.sina.com.cn'</code> 由服务器代理</li>
<li>称为 <code>JSONP</code>，它有个限制，只能用GET请求，并且要求返回JavaScript. 利用了浏览器允许跨域引用JavaScript资源, 在 head 中添加一个 script 节点, 然后事先要在 HTML 中预留好位置, 以及写好回调函数.<ul>
<li>参见 <a href="https://www.cnblogs.com/dowinning/archive/2012/04/19/json-jsonp-jquery.html">说说JSON和JSONP，也许你会豁然开朗，含jQuery用例</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>CORS<ul>
<li>CORS全称 <code>Cross-Origin Resource Sharing</code> ，是HTML5规范定义的如何跨域访问资源。</li>
<li>Origin表示本域，也就是浏览器当前页面的域。当JavaScript向外域（如sina.com）发起请求后，浏览器收到响应后，首先检查 <code>Access-Control-Allow-Origin</code> 是否包含本域，如果是，则此次跨域请求成功，如果不是，则请求失败，JavaScript将无法获取到响应的任何数据。</li>
<li>假设本域是<code>my.com</code>，外域是<code>sina.com</code>，只要响应头<code>Access-Control-Allow-Origin</code>为<code>http://my.com</code>，或者是<code>*</code>，本次请求就可以成功。</li>
<li>可见，跨域能否成功，取决于对方服务器是否愿意给你设置一个正确的<code>Access-Control-Allow-Origin</code>，决定权始终在对方手中。</li>
<li>上面这种跨域请求，称之为“简单请求”。简单请求包括GET、HEAD和POST（POST的Content-Type类型 仅限<code>application/x-www-form-urlencoded</code>、<code>multipart/form-data</code>和<code>text/plain</code>），并且不能出现任何自定义头（例如，<code>X-Custom: 12345</code>），通常能满足90%的需求。</li>
<li>对于PUT、DELETE以及其他类型如<code>application/json</code>的POST请求，在发送AJAX请求之前，浏览器会先发送一个<code>OPTIONS</code>请求（称为preflighted请求）到这个URL上，询问目标服务器是否接受</li>
</ul>
</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="kd">function</span><span class="w"> </span><span class="nx">success</span><span class="p">(</span><span class="nx">text</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="kd">var</span><span class="w"> </span><span class="nx">textarea</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;test-response-text&#39;</span><span class="p">);</span><span class="w"></span>
<span class="w"> </span><span class="nx">textarea</span><span class="p">.</span><span class="nx">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">text</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kd">function</span><span class="w"> </span><span class="nx">fail</span><span class="p">(</span><span class="nx">code</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="kd">var</span><span class="w"> </span><span class="nx">textarea</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;test-response-text&#39;</span><span class="p">);</span><span class="w"></span>
<span class="w"> </span><span class="nx">textarea</span><span class="p">.</span><span class="nx">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Error code: &#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">code</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kd">var</span><span class="w"> </span><span class="nx">request</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">XMLHttpRequest</span><span class="p">();</span><span class="w"> </span><span class="c1">// 新建XMLHttpRequest对象</span><span class="w"></span>

<span class="nx">request</span><span class="p">.</span><span class="nx">onreadystatechange</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">// 状态发生变化时，函数被回调</span><span class="w"></span>
<span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">request</span><span class="p">.</span><span class="nx">readyState</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="mf">4</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">// 成功完成</span><span class="w"></span>
<span class="w">  </span><span class="c1">// 判断响应结果:</span><span class="w"></span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">request</span><span class="p">.</span><span class="nx">status</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="mf">200</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">   </span><span class="c1">// 成功，通过responseText拿到响应的文本:</span><span class="w"></span>
<span class="w">   </span><span class="k">return</span><span class="w"> </span><span class="nx">success</span><span class="p">(</span><span class="nx">request</span><span class="p">.</span><span class="nx">responseText</span><span class="p">);</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">   </span><span class="c1">// 失败，根据响应码判断失败原因:</span><span class="w"></span>
<span class="w">   </span><span class="k">return</span><span class="w"> </span><span class="nx">fail</span><span class="p">(</span><span class="nx">request</span><span class="p">.</span><span class="nx">status</span><span class="p">);</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="c1">// HTTP请求还在继续...</span><span class="w"></span>
<span class="w"> </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// 发送请求:</span><span class="w"></span>
<span class="nx">request</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="s1">&#39;GET&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;/api/categories&#39;</span><span class="p">);</span><span class="w"></span>
<span class="nx">request</span><span class="p">.</span><span class="nx">send</span><span class="p">();</span><span class="w"></span>

<span class="nx">alert</span><span class="p">(</span><span class="s1">&#39;请求已发送，请等待响应...&#39;</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<h4 id="cors">CORS<a class="headerlink" href="#cors" title="Permanent link">&para;</a></h4>
<p>对于PUT、DELETE以及其他类型如<code>application/json</code>的POST请求，在发送AJAX请求之前，浏览器会先发送一个<code>OPTIONS</code>请求（称为preflighted请求）到这个URL上，询问目标服务器是否接受：</p>
<div class="highlight"><pre><span></span><code><span class="nx">OPTIONS</span><span class="w"> </span><span class="o">/</span><span class="nx">path</span><span class="o">/</span><span class="nx">to</span><span class="o">/</span><span class="nx">resource</span><span class="w"> </span><span class="nx">HTTP</span><span class="o">/</span><span class="mf">1.1</span><span class="w"></span>
<span class="nx">Host</span><span class="o">:</span><span class="w"> </span><span class="nx">bar</span><span class="p">.</span><span class="nx">com</span><span class="w"></span>
<span class="nx">Origin</span><span class="o">:</span><span class="w"> </span><span class="nx">http</span><span class="o">:</span><span class="c1">//my.com</span><span class="w"></span>
<span class="nx">Access</span><span class="o">-</span><span class="nx">Control</span><span class="o">-</span><span class="nx">Request</span><span class="o">-</span><span class="nx">Method</span><span class="o">:</span><span class="w"> </span><span class="nx">POST</span><span class="w"></span>
</code></pre></div>
<p>服务器必须响应并明确指出允许的Method：</p>
<div class="highlight"><pre><span></span><code><span class="nx">HTTP</span><span class="o">/</span><span class="mf">1.1</span><span class="w"> </span><span class="mf">200</span><span class="w"> </span><span class="nx">OK</span><span class="w"></span>
<span class="nx">Access</span><span class="o">-</span><span class="nx">Control</span><span class="o">-</span><span class="nx">Allow</span><span class="o">-</span><span class="nx">Origin</span><span class="o">:</span><span class="w"> </span><span class="nx">http</span><span class="o">:</span><span class="c1">//my.com</span><span class="w"></span>
<span class="nx">Access</span><span class="o">-</span><span class="nx">Control</span><span class="o">-</span><span class="nx">Allow</span><span class="o">-</span><span class="nx">Methods</span><span class="o">:</span><span class="w"> </span><span class="nx">POST</span><span class="p">,</span><span class="w"> </span><span class="nx">GET</span><span class="p">,</span><span class="w"> </span><span class="nx">PUT</span><span class="p">,</span><span class="w"> </span><span class="nx">OPTIONS</span><span class="w"></span>
<span class="nx">Access</span><span class="o">-</span><span class="nx">Control</span><span class="o">-</span><span class="nx">Max</span><span class="o">-</span><span class="nx">Age</span><span class="o">:</span><span class="w"> </span><span class="mf">86400</span><span class="w"></span>
</code></pre></div>
<p>浏览器确认服务器响应的<code>Access-Control-Allow-Methods</code>头确实包含将要发送的AJAX请求的Method，才会继续发送AJAX，否则，抛出一个错误。</p>
<p>由于以<code>POST</code>、<code>PUT</code>方式传送JSON格式的数据在REST中很常见，所以要跨域正确处理<code>POST</code>和<code>PUT</code>请求，服务器端必须正确响应<code>OPTIONS</code>请求。</p>
<p>需要深入了解CORS的童鞋请移步<a href="http://www.w3.org/TR/cors/">W3C文档</a>。</p>
<h3 id="promise">Promise<a class="headerlink" href="#promise" title="Permanent link">&para;</a></h3>
<ul>
<li>在JavaScript的世界中，所有代码都是单线程执行的<ul>
<li>因此JavaScript的所有网络操作，浏览器事件，都必须是异步执行</li>
<li>异步操作会在将来的某个时间点触发一个函数调用<ul>
<li><code>setTimeout(callback, 1000);</code></li>
</ul>
</li>
</ul>
</li>
<li>Promise<ul>
<li>语法:<ul>
<li><code>var p1 = new Promise(test);</code> 新建 Promise 对象, 其中回调函数 <code>function test(resolve, reject) {}</code> 是我们主要关心的函数逻辑,<ul>
<li>其中 resolve, reject 分别是执行成功或失败之后的操作, 不关心</li>
</ul>
</li>
<li><code>var p2 = p1.then(function (result) {})</code>. 这里 <code>then</code> 中传入的就是上面的 resolve</li>
<li><code>var p3 = p2.catch(function (reason) {})</code>. 其中 <code>catch</code> 传入的是 reject</li>
<li>可以串联写成 <code>new Promise(test).then(resolve).catch(reject)</code> 的形式</li>
</ul>
</li>
<li>作用: Promise最大的好处是在异步执行的流程中，把执行代码和处理结果的代码清晰地分离了</li>
</ul>
</li>
<li>例子: 将上一节 AJAX 异步执行函数转换为 Promise 对象, 从而简化代码逻辑</li>
<li>串行<ul>
<li><code>job1.then(job2).then(job3).catch(handleError);</code></li>
<li>其中，<code>job1</code>、<code>job2</code>和<code>job3</code>都是Promise对象。</li>
<li>job2 的输入是 job1 的输出</li>
</ul>
</li>
<li>并行执行<ul>
<li><code>Promise.all([p1, p2])</code> 全部执行, 输出(then 的输入) 也是一个 Array</li>
<li><code>Promise.race([p1, p2])</code> 哪个先返回就执行哪个</li>
</ul>
</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="c1">// 回调函数</span><span class="w"></span>
<span class="kd">function</span><span class="w"> </span><span class="nx">callback</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Done&#39;</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;before setTimeout()&#39;</span><span class="p">);</span><span class="w"></span>
<span class="nx">setTimeout</span><span class="p">(</span><span class="nx">callback</span><span class="p">,</span><span class="w"> </span><span class="mf">1000</span><span class="p">);</span><span class="w"> </span><span class="c1">// 1秒钟后调用callback函数</span><span class="w"></span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;after setTimeout()&#39;</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="cm">/* 我们把上一节的AJAX异步执行函数转换为Promise对象，看看用Promise如何简化异步处理 */</span><span class="w"></span>
<span class="c1">// ajax函数将返回Promise对象:</span><span class="w"></span>
<span class="kd">function</span><span class="w"> </span><span class="nx">ajax</span><span class="p">(</span><span class="nx">method</span><span class="p">,</span><span class="w"> </span><span class="nx">url</span><span class="p">,</span><span class="w"> </span><span class="nx">data</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="kd">var</span><span class="w"> </span><span class="nx">request</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">XMLHttpRequest</span><span class="p">();</span><span class="w"></span>
<span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Promise</span><span class="p">(</span><span class="kd">function</span><span class="w"> </span><span class="p">(</span><span class="nx">resolve</span><span class="p">,</span><span class="w"> </span><span class="nx">reject</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="nx">request</span><span class="p">.</span><span class="nx">onreadystatechange</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">request</span><span class="p">.</span><span class="nx">readyState</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="mf">4</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">request</span><span class="p">.</span><span class="nx">status</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="mf">200</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">     </span><span class="nx">resolve</span><span class="p">(</span><span class="nx">request</span><span class="p">.</span><span class="nx">responseText</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">     </span><span class="nx">reject</span><span class="p">(</span><span class="nx">request</span><span class="p">.</span><span class="nx">status</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">   </span><span class="p">}</span><span class="w"></span>
<span class="w">  </span><span class="p">};</span><span class="w"></span>
<span class="w">  </span><span class="nx">request</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="nx">method</span><span class="p">,</span><span class="w"> </span><span class="nx">url</span><span class="p">);</span><span class="w"></span>
<span class="w">  </span><span class="nx">request</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span><span class="w"></span>
<span class="w"> </span><span class="p">});</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
<span class="kd">function</span><span class="w"> </span><span class="nx">testAJAX</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="kd">var</span><span class="w"> </span><span class="nx">log</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&quot;test-promise-ajax-result&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w"> </span><span class="kd">var</span><span class="w"> </span><span class="nx">p</span><span class="p">;</span><span class="w"></span>
<span class="w"> </span><span class="c1">// p = ajax(&quot;GET&quot;, &quot;http://www.baidu.com&quot;);</span><span class="w"></span>
<span class="w"> </span><span class="nx">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">ajax</span><span class="p">(</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;/test.json&quot;</span><span class="p">);</span><span class="w"></span>

<span class="w"> </span><span class="nx">p</span><span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="w"> </span><span class="p">(</span><span class="nx">text</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="nx">log</span><span class="p">.</span><span class="nx">innerText</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">text</span><span class="p">;</span><span class="w"></span>
<span class="w"> </span><span class="p">}).</span><span class="k">catch</span><span class="p">(</span><span class="kd">function</span><span class="w"> </span><span class="p">(</span><span class="nx">status</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="nx">log</span><span class="p">.</span><span class="nx">innerText</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sb">`Error: </span><span class="si">${</span><span class="nx">status</span><span class="si">}</span><span class="sb">`</span><span class="p">;</span><span class="w"></span>
<span class="w"> </span><span class="p">});</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<h4 id="all-race">all, race<a class="headerlink" href="#all-race" title="Permanent link">&para;</a></h4>
<ul>
<li>并行执行<ul>
<li>试想一个页面聊天系统，我们需要从两个不同的URL分别获得用户的个人信息和好友列表，这两个任务是可以并行执行的，用<code>Promise.all()</code>实现</li>
<li>有些时候，多个异步任务是为了容错。比如，同时向两个URL读取用户的个人信息，只需要获得先返回的结果即可。这种情况下，用<code>Promise.race()</code>实现</li>
</ul>
</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="cm">/* Promise.all */</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">p1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Promise</span><span class="p">(</span><span class="kd">function</span><span class="w"> </span><span class="p">(</span><span class="nx">resolve</span><span class="p">,</span><span class="w"> </span><span class="nx">reject</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="nx">setTimeout</span><span class="p">(</span><span class="nx">resolve</span><span class="p">,</span><span class="w"> </span><span class="mf">500</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;P1&#39;</span><span class="p">);</span><span class="w"></span>
<span class="p">});</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">p2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Promise</span><span class="p">(</span><span class="kd">function</span><span class="w"> </span><span class="p">(</span><span class="nx">resolve</span><span class="p">,</span><span class="w"> </span><span class="nx">reject</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="nx">setTimeout</span><span class="p">(</span><span class="nx">resolve</span><span class="p">,</span><span class="w"> </span><span class="mf">600</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;P2&#39;</span><span class="p">);</span><span class="w"></span>
<span class="p">});</span><span class="w"></span>
<span class="c1">// 同时执行p1和p2，并在它们都完成后执行then:</span><span class="w"></span>
<span class="nb">Promise</span><span class="p">.</span><span class="nx">all</span><span class="p">([</span><span class="nx">p1</span><span class="p">,</span><span class="w"> </span><span class="nx">p2</span><span class="p">]).</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="w"> </span><span class="p">(</span><span class="nx">results</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">results</span><span class="p">);</span><span class="w"> </span><span class="c1">// 获得一个Array: [&#39;P1&#39;, &#39;P2&#39;]</span><span class="w"></span>
<span class="p">});</span><span class="w"></span>

<span class="cm">/* Promise.race */</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">p1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Promise</span><span class="p">(</span><span class="kd">function</span><span class="w"> </span><span class="p">(</span><span class="nx">resolve</span><span class="p">,</span><span class="w"> </span><span class="nx">reject</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="nx">setTimeout</span><span class="p">(</span><span class="nx">resolve</span><span class="p">,</span><span class="w"> </span><span class="mf">500</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;P1&#39;</span><span class="p">);</span><span class="w"></span>
<span class="p">});</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">p2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Promise</span><span class="p">(</span><span class="kd">function</span><span class="w"> </span><span class="p">(</span><span class="nx">resolve</span><span class="p">,</span><span class="w"> </span><span class="nx">reject</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="nx">setTimeout</span><span class="p">(</span><span class="nx">resolve</span><span class="p">,</span><span class="w"> </span><span class="mf">600</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;P2&#39;</span><span class="p">);</span><span class="w"></span>
<span class="p">});</span><span class="w"></span>
<span class="nb">Promise</span><span class="p">.</span><span class="nx">race</span><span class="p">([</span><span class="nx">p1</span><span class="p">,</span><span class="w"> </span><span class="nx">p2</span><span class="p">]).</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="w"> </span><span class="p">(</span><span class="nx">result</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">result</span><span class="p">);</span><span class="w"> </span><span class="c1">// &#39;P1&#39;</span><span class="w"></span>
<span class="p">});</span><span class="w"></span>
</code></pre></div>
<h3 id="canvas">Canvas<a class="headerlink" href="#canvas" title="Permanent link">&para;</a></h3>
<ul>
<li>Canvas<ul>
<li>Canvas是HTML5新增的组件，它就像一块幕布，可以用JavaScript在上面绘制各种图表、动画等。</li>
<li>没有 Canvas 之前, 要用 Flash</li>
<li><code>&lt;canvas id="test-canvas" width="300" height="200"&gt;&lt;/canvas&gt;</code></li>
</ul>
</li>
<li><code>getContext('2d')</code>方法让我们拿到一个 <code>CanvasRenderingContext2D</code> 对象，所有的绘图操作都需要通过这个对象完成。<ul>
<li>3D 用 <code>"webgl"</code></li>
</ul>
</li>
<li>坐标<ul>
<li>Canvas的坐标以左上角为原点，水平向右为X轴，垂直向下为Y轴，以像素为单位，所以每个点都是非负整数。</li>
</ul>
</li>
<li>绘制形状</li>
<li>绘制文字</li>
</ul>
<h2 id="_42">错误处理<a class="headerlink" href="#_42" title="Permanent link">&para;</a></h2>
<ul>
<li><code>try ... catch(e) ... finally</code></li>
<li>JavaScript有一个标准的<code>Error</code>对象表示错误，还有从<code>Error</code>派生的<code>TypeError</code>、<code>ReferenceError</code>等错误对象。我们在处理错误时，可以通过<code>catch(e)</code>捕获的变量<code>e</code>访问错误对象<ul>
<li><code>e instanceof TypeError</code> 判断错误类型</li>
<li><code>e.message</code></li>
</ul>
</li>
<li>抛出错误使用<code>throw</code>语句<ul>
<li><code>throw new Error('输入错误');</code></li>
</ul>
</li>
<li>错误传播<ul>
<li>如果在一个函数内部发生了错误，它自身没有捕获，错误就会被抛到外层调用函数，如果外层函数也没有捕获，该错误会一直沿着函数调用链向上抛出，直到被JavaScript引擎捕获，代码终止执行。</li>
</ul>
</li>
<li>异步错误处理<ul>
<li>编写JavaScript代码时，我们要时刻牢记，JavaScript引擎是一个事件驱动的执行引擎，代码总是以单线程执行，而回调函数的执行需要等到下一个满足条件的事件出现后，才会被执行。</li>
<li>因此, 对于异步代码, 对于其的错误的处理应该在回调函数内部实现!</li>
</ul>
</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="kd">var</span><span class="w"> </span><span class="nx">r1</span><span class="p">,</span><span class="w"> </span><span class="nx">r2</span><span class="p">,</span><span class="w"> </span><span class="nx">s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span><span class="w"></span>
<span class="k">try</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="nx">r2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1</span><span class="w"></span>
<span class="w"> </span><span class="nx">r1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">s</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="w"> </span><span class="c1">// 此处应产生错误</span><span class="w"></span>
<span class="w"> </span><span class="nx">r2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">100</span><span class="p">;</span><span class="w"> </span><span class="c1">// 该语句不会执行</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;出错了：&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">e</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="k">finally</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;finally&#39;</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;r1 = &#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">r1</span><span class="p">);</span><span class="w"> </span><span class="c1">// r1应为undefined</span><span class="w"></span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;r2 = &#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">r2</span><span class="p">);</span><span class="w"> </span><span class="c1">// r2应为undefined</span><span class="w"></span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1">// 访问 Error对象</span><span class="w"></span>
<span class="k">try</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="p">...</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">e</span><span class="w"> </span><span class="ow">instanceof</span><span class="w"> </span><span class="ne">TypeError</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="nx">alert</span><span class="p">(</span><span class="s1">&#39;Type error!&#39;</span><span class="p">);</span><span class="w"></span>
<span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">e</span><span class="w"> </span><span class="ow">instanceof</span><span class="w"> </span><span class="ne">Error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="nx">alert</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">message</span><span class="p">);</span><span class="w"></span>
<span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="nx">alert</span><span class="p">(</span><span class="s1">&#39;Error: &#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">e</span><span class="p">);</span><span class="w"></span>
<span class="w"> </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// 抛出错误</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">r</span><span class="p">,</span><span class="w"> </span><span class="nx">n</span><span class="p">,</span><span class="w"> </span><span class="nx">s</span><span class="p">;</span><span class="w"></span>
<span class="k">try</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="nx">s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">prompt</span><span class="p">(</span><span class="s1">&#39;请输入一个数字&#39;</span><span class="p">);</span><span class="w"></span>
<span class="w"> </span><span class="nx">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">parseInt</span><span class="p">(</span><span class="nx">s</span><span class="p">);</span><span class="w"></span>
<span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">isNaN</span><span class="p">(</span><span class="nx">n</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="s1">&#39;输入错误&#39;</span><span class="p">);</span><span class="w"></span>
<span class="w"> </span><span class="p">}</span><span class="w"></span>
<span class="w"> </span><span class="c1">// 计算平方:</span><span class="w"></span>
<span class="w"> </span><span class="nx">r</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">n</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">n</span><span class="p">;</span><span class="w"></span>
<span class="w"> </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">n</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39; * &#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">n</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39; = &#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">r</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;出错了：&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">e</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<h2 id="underscore">underscore<a class="headerlink" href="#underscore" title="Permanent link">&para;</a></h2>
<ul>
<li>underscore<ul>
<li>JavaScript是函数式编程语言，支持高阶函数和闭包。函数式编程非常强大，可以写出非常简洁的代码。例如<code>Array</code>的<code>map()</code>和<code>filter()</code>方法</li>
<li>可是Object没有这些方法, 如何解决?</li>
<li>除了自己实现, 可以直接找一个成熟可靠的第三方开源库，使用统一的函数来实现<code>map()</code>、<code>filter()</code>这些操作 —— <code>underscore</code></li>
</ul>
</li>
<li>特点<ul>
<li>正如jQuery统一了不同浏览器之间的DOM操作的差异，让我们可以简单地对DOM进行操作，underscore则提供了一套完善的函数式编程的接口，让我们更方便地在JavaScript中实现函数式编程。</li>
<li>jQuery在加载时，会把自身绑定到唯一的全局变量<code>$</code>上，underscore与其类似，会把自身绑定到唯一的全局变量<code>_</code>上，这也是为啥它的名字叫underscore的原因。</li>
</ul>
</li>
</ul>
<h3 id="collections">Collections<a class="headerlink" href="#collections" title="Permanent link">&para;</a></h3>
<ul>
<li>underscore为集合类对象提供了一致的接口。集合类是指Array和Object<ul>
<li>当作用于Object时，传入的函数为<code>function (value, key)</code></li>
</ul>
</li>
<li><code>map, mapObject, filter</code><ul>
<li>注意, map 虽然回调函数接受 <code>value, key</code>, 返回的仅仅是回调函数处理结果的 Array; 要想得到 key 不变的对象, 应该用 <code>mapObject</code></li>
<li><code>_.map(obj, (value, key) =&gt; value.toUpperCase())</code> 返回 toUpperCase 后的 value 列表</li>
</ul>
</li>
<li><code>every, some</code><ul>
<li>当集合的所有元素都满足条件时，<code>_.every()</code>函数返回<code>true</code>，当集合的至少一个元素满足条件时，<code>_.some()</code>函数返回<code>true</code></li>
<li><code>_.every([1, 4, 7, -3, -9], (x) =&gt; x &gt; 0); // false</code></li>
</ul>
</li>
<li><code>max, min</code><ul>
<li>直接返回集合中最大和最小的数</li>
<li><code>_.max([3,9]); // 9</code></li>
<li>对于 object, 只作用 value, 例如 <code>_.max({ a: 1, b: 2, c: 3 }); // 3</code></li>
</ul>
</li>
<li><code>groupBy</code><ul>
<li><code>groupBy()</code>把集合的元素按照key归类，key由传入的函数返回：</li>
</ul>
</li>
<li><code>shuffle, sample</code><ul>
<li><code>shuffle()</code>用洗牌算法随机打乱一个集合</li>
<li><code>sample()</code>则是随机选择一个或多个元素</li>
</ul>
</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="c1">// groupBy</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">scores</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">20</span><span class="p">,</span><span class="w"> </span><span class="mf">81</span><span class="p">,</span><span class="w"> </span><span class="mf">75</span><span class="p">,</span><span class="w"> </span><span class="mf">40</span><span class="p">,</span><span class="w"> </span><span class="mf">91</span><span class="p">,</span><span class="w"> </span><span class="mf">59</span><span class="p">,</span><span class="w"> </span><span class="mf">77</span><span class="p">,</span><span class="w"> </span><span class="mf">66</span><span class="p">,</span><span class="w"> </span><span class="mf">72</span><span class="p">,</span><span class="w"> </span><span class="mf">88</span><span class="p">,</span><span class="w"> </span><span class="mf">99</span><span class="p">];</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">groups</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">_</span><span class="p">.</span><span class="nx">groupBy</span><span class="p">(</span><span class="nx">scores</span><span class="p">,</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="p">(</span><span class="nx">x</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">x</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">60</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="s1">&#39;C&#39;</span><span class="p">;</span><span class="w"></span>
<span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">x</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">80</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="s1">&#39;B&#39;</span><span class="p">;</span><span class="w"></span>
<span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="s1">&#39;A&#39;</span><span class="p">;</span><span class="w"></span>
<span class="w"> </span><span class="p">}</span><span class="w"></span>
<span class="p">});</span><span class="w"></span>
<span class="c1">// 结果:</span><span class="w"></span>
<span class="c1">// {</span><span class="w"></span>
<span class="c1">//   A: [81, 91, 88, 99],</span><span class="w"></span>
<span class="c1">//   B: [75, 77, 66, 72],</span><span class="w"></span>
<span class="c1">//   C: [20, 40, 59]</span><span class="w"></span>
<span class="c1">// }</span><span class="w"></span>
</code></pre></div>
<h3 id="arrays">Arrays<a class="headerlink" href="#arrays" title="Permanent link">&para;</a></h3>
<p>underscore为<code>Array</code>提供了许多工具类方法，可以更方便快捷地操作<code>Array</code>。(类比 Python)</p>
<ul>
<li>first, last</li>
<li>flatten</li>
<li>zip, unzip</li>
<li>object<ul>
<li><code>_.object(names, scores);</code> 以 names 数组作为key scores 数组作为value</li>
</ul>
</li>
<li>range<ul>
<li><code>_.range(0, 30, 5);</code> 从0开始小于30，步长5</li>
</ul>
</li>
</ul>
<h3 id="functions">Functions<a class="headerlink" href="#functions" title="Permanent link">&para;</a></h3>
<p>因为underscore本来就是为了充分发挥JavaScript的函数式编程特性，所以也提供了大量JavaScript本身没有的高阶函数。</p>
<ul>
<li>bind<ul>
<li>当用一个变量<code>fn</code>指向一个对象的方法时，直接调用<code>fn()</code>是不行的，因为丢失了<code>this</code>对象的引用。用<code>bind</code>可以修复这个问题。</li>
</ul>
</li>
<li>partial<ul>
<li><code>partial()</code>就是为一个函数创建偏函数。</li>
<li>例如 <code>var cube = _.partial(Math.pow, _, 3);</code> 计算三次方</li>
<li><code>_</code> 用作占位符</li>
</ul>
</li>
<li>memorize<ul>
<li>如果一个函数调用开销很大，我们就可能希望能把结果缓存下来，以便后续调用时直接获得结果。</li>
<li>用<code>memoize()</code>就可以自动缓存函数计算的结果</li>
</ul>
</li>
<li>once<ul>
<li><code>once()</code>保证某个函数执行且仅执行一次。如果你有一个方法叫<code>register()</code>，用户在页面上点两个按钮的任何一个都可以执行的话，就可以用<code>once()</code>保证函数仅调用一次，无论用户点击多少次</li>
</ul>
</li>
<li>delay<ul>
<li><code>delay()</code>可以让一个函数延迟执行，效果和<code>setTimeout()</code>是一样的，但是代码明显简单了</li>
<li>例如, <code>_.delay(console.log, 2000, 'Hello,', 'world!');</code></li>
</ul>
</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="c1">// bind</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39; Hello  &#39;</span><span class="p">;</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">fn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">_</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="nx">s</span><span class="p">.</span><span class="nx">trim</span><span class="p">,</span><span class="w"> </span><span class="nx">s</span><span class="p">);</span><span class="w"> </span><span class="c1">// 将 s.trim 函数绑定在 s 对象上 (固定this指向)</span><span class="w"></span>
<span class="nx">fn</span><span class="p">();</span><span class="w"> </span><span class="c1">// 然后就可以直接调用了</span><span class="w"></span>
<span class="c1">// 输出Hello</span><span class="w"></span>

<span class="c1">// partial</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">cube</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">_</span><span class="p">.</span><span class="nx">partial</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">pow</span><span class="p">,</span><span class="w"> </span><span class="nx">_</span><span class="p">,</span><span class="w"> </span><span class="mf">3</span><span class="p">);</span><span class="w"></span>
<span class="nx">cube</span><span class="p">(</span><span class="mf">3</span><span class="p">);</span><span class="w"> </span><span class="c1">// 27</span><span class="w"></span>
<span class="nx">cube</span><span class="p">(</span><span class="mf">5</span><span class="p">);</span><span class="w"> </span><span class="c1">// 125</span><span class="w"></span>
<span class="nx">cube</span><span class="p">(</span><span class="mf">10</span><span class="p">);</span><span class="w"> </span><span class="c1">// 1000</span><span class="w"></span>

<span class="c1">// memorize</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">factorial</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">_</span><span class="p">.</span><span class="nx">memoize</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">n</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;start calculate &#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">n</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;!...&#39;</span><span class="p">);</span><span class="w"></span>
<span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">n</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="mf">1</span><span class="p">;</span><span class="w"></span>
<span class="w"> </span><span class="p">}</span><span class="w"></span>
<span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="nx">n</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">factorial</span><span class="p">(</span><span class="nx">n</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">1</span><span class="p">);</span><span class="w"></span>
<span class="p">});</span><span class="w"></span>

<span class="nx">factorial</span><span class="p">(</span><span class="mf">10</span><span class="p">);</span><span class="w"> </span><span class="c1">// 3628800</span><span class="w"></span>
<span class="c1">// 输出结果说明factorial(1)~factorial(10)都已经缓存了:</span><span class="w"></span>
<span class="c1">// start calculate 10!...</span><span class="w"></span>
<span class="c1">// start calculate 9!...</span><span class="w"></span>
<span class="c1">// start calculate 8!...</span><span class="w"></span>
<span class="c1">// start calculate 7!...</span><span class="w"></span>
<span class="c1">// start calculate 6!...</span><span class="w"></span>
<span class="c1">// start calculate 5!...</span><span class="w"></span>
<span class="c1">// start calculate 4!...</span><span class="w"></span>
<span class="c1">// start calculate 3!...</span><span class="w"></span>
<span class="c1">// start calculate 2!...</span><span class="w"></span>
<span class="c1">// start calculate 1!...</span><span class="w"></span>

<span class="nx">factorial</span><span class="p">(</span><span class="mf">9</span><span class="p">);</span><span class="w"> </span><span class="c1">// 362880</span><span class="w"></span>
<span class="c1">// console无输出</span><span class="w"></span>

<span class="c1">// delay</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">log</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">_</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">,</span><span class="w"> </span><span class="nx">console</span><span class="p">);</span><span class="w"></span>
<span class="nx">_</span><span class="p">.</span><span class="nx">delay</span><span class="p">(</span><span class="nx">log</span><span class="p">,</span><span class="w"> </span><span class="mf">2000</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Hello,&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;world!&#39;</span><span class="p">);</span><span class="w"></span>
<span class="c1">// 2秒后打印&#39;Hello, world!&#39;:</span><span class="w"></span>
</code></pre></div>
<h3 id="object">Object<a class="headerlink" href="#object" title="Permanent link">&para;</a></h3>
<ul>
<li><code>keys, allKeys</code><ul>
<li><code>keys()</code>可以非常方便地返回一个object自身所有的key，但不包含从原型链继承下来的</li>
<li><code>allKeys()</code>除了object自身的key，还包含从原型链继承下来的</li>
</ul>
</li>
<li><code>values</code><ul>
<li>和<code>keys()</code>类似，<code>values()</code>返回object自身但不包含原型链继承的所有值</li>
</ul>
</li>
<li><code>mapObject</code><ul>
<li><code>mapObject()</code>就是针对object的map版本</li>
</ul>
</li>
<li>invert<ul>
<li><code>invert()</code>把object的每个key-value来个交换，key变成value，value变成key</li>
</ul>
</li>
<li>extend, extendOwn<ul>
<li><code>extend()</code>把多个object的key-value合并到第一个object并返回</li>
<li><code>extendOwn()</code>和<code>extend()</code>类似，但获取属性时忽略从原型链继承下来的属性</li>
</ul>
</li>
<li>clone<ul>
<li>如果我们要复制一个object对象，就可以用<code>clone()</code>方法，它会把原有对象的所有属性都复制到新的对象中</li>
<li>注意，<code>clone()</code>是“浅复制”。所谓“浅复制”就是说，两个对象相同的key所引用的value其实是同一对象</li>
</ul>
</li>
<li>isEqual<ul>
<li><code>isEqual()</code>对两个object进行深度比较，如果内容完全相同，则返回<code>true</code></li>
<li><code>isEqual()</code>其实对<code>Array</code>也可以比较：</li>
</ul>
</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="kd">function</span><span class="w"> </span><span class="nx">Student</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span><span class="w"> </span><span class="nx">age</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">name</span><span class="p">;</span><span class="w"></span>
<span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">age</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">age</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
<span class="nx">Student</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">school</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;No.1 Middle School&#39;</span><span class="p">;</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">xiaoming</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">Student</span><span class="p">(</span><span class="s1">&#39;小明&#39;</span><span class="p">,</span><span class="w"> </span><span class="mf">20</span><span class="p">);</span><span class="w"></span>
<span class="nx">_</span><span class="p">.</span><span class="nx">allKeys</span><span class="p">(</span><span class="nx">xiaoming</span><span class="p">);</span><span class="w"> </span><span class="c1">// [&#39;name&#39;, &#39;age&#39;, &#39;school&#39;]</span><span class="w"></span>

<span class="kd">var</span><span class="w"> </span><span class="nx">obj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">a</span><span class="o">:</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="nx">b</span><span class="o">:</span><span class="w"> </span><span class="mf">2</span><span class="p">,</span><span class="w"> </span><span class="nx">c</span><span class="o">:</span><span class="w"> </span><span class="mf">3</span><span class="w"> </span><span class="p">};</span><span class="w"></span>
<span class="c1">// 注意传入的函数签名，value在前，key在后:</span><span class="w"></span>
<span class="nx">_</span><span class="p">.</span><span class="nx">mapObject</span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="nx">v</span><span class="p">,</span><span class="w"> </span><span class="nx">k</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="mf">100</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">v</span><span class="p">);</span><span class="w"> </span><span class="c1">// { a: 101, b: 102, c: 103 }</span><span class="w"></span>

<span class="kd">var</span><span class="w"> </span><span class="nx">obj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="nx">Adam</span><span class="o">:</span><span class="w"> </span><span class="mf">90</span><span class="p">,</span><span class="w"></span>
<span class="w"> </span><span class="nx">Lisa</span><span class="o">:</span><span class="w"> </span><span class="mf">85</span><span class="p">,</span><span class="w"></span>
<span class="w"> </span><span class="nx">Bart</span><span class="o">:</span><span class="w"> </span><span class="mf">59</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>
<span class="nx">_</span><span class="p">.</span><span class="nx">invert</span><span class="p">(</span><span class="nx">obj</span><span class="p">);</span><span class="w"> </span><span class="c1">// { &#39;59&#39;: &#39;Bart&#39;, &#39;85&#39;: &#39;Lisa&#39;, &#39;90&#39;: &#39;Adam&#39; }</span><span class="w"></span>

<span class="cm">/* extend */</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Bob&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">age</span><span class="o">:</span><span class="w"> </span><span class="mf">20</span><span class="p">};</span><span class="w"></span>
<span class="nx">_</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="nx">age</span><span class="o">:</span><span class="w"> </span><span class="mf">15</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="nx">age</span><span class="o">:</span><span class="w"> </span><span class="mf">88</span><span class="p">,</span><span class="w"> </span><span class="nx">city</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Beijing&#39;</span><span class="p">});</span><span class="w"> </span><span class="c1">// {name: &#39;Bob&#39;, age: 88, city: &#39;Beijing&#39;}</span><span class="w"></span>
<span class="c1">// 变量a的内容也改变了：</span><span class="w"></span>
<span class="nx">a</span><span class="p">;</span><span class="w"> </span><span class="c1">// {name: &#39;Bob&#39;, age: 88, city: &#39;Beijing&#39;}</span><span class="w"></span>

<span class="cm">/* clone */</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">source</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;小明&#39;</span><span class="p">,</span><span class="w"></span>
<span class="w"> </span><span class="nx">age</span><span class="o">:</span><span class="w"> </span><span class="mf">20</span><span class="p">,</span><span class="w"></span>
<span class="w"> </span><span class="nx">skills</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s1">&#39;JavaScript&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;CSS&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;HTML&#39;</span><span class="p">]</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">copied</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">_</span><span class="p">.</span><span class="nx">clone</span><span class="p">(</span><span class="nx">source</span><span class="p">);</span><span class="w"></span>
<span class="nx">source</span><span class="p">.</span><span class="nx">skills</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="nx">copied</span><span class="p">.</span><span class="nx">skills</span><span class="p">;</span><span class="w"> </span><span class="c1">// true</span><span class="w"></span>

<span class="cm">/* isEqual */</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">o1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s1">&#39;Bob&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">skills</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s1">&#39;Java&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;JavaScript&#39;</span><span class="p">]</span><span class="w"> </span><span class="p">}];</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">o2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s1">&#39;Bob&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">skills</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s1">&#39;Java&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;JavaScript&#39;</span><span class="p">]</span><span class="w"> </span><span class="p">}];</span><span class="w"></span>

<span class="nx">o1</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="nx">o2</span><span class="p">;</span><span class="w"> </span><span class="c1">// false</span><span class="w"></span>
<span class="nx">_</span><span class="p">.</span><span class="nx">isEqual</span><span class="p">(</span><span class="nx">o1</span><span class="p">,</span><span class="w"> </span><span class="nx">o2</span><span class="p">);</span><span class="w"> </span><span class="c1">// true</span><span class="w"></span>
</code></pre></div>
<h3 id="chaining">Chaining<a class="headerlink" href="#chaining" title="Permanent link">&para;</a></h3>
<ul>
<li>把对象包装成能进行链式调用的方法，就是<code>chain()</code>函数</li>
<li>联系 jQuery 的链式调用</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="cm">/* jQuery支持链式调用 */</span><span class="w"></span>
<span class="nx">$</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;target&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;_blank&#39;</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">&#39; &lt;i class=&quot;uk-icon-external-link&quot;&gt;&lt;/i&gt;&#39;</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="p">.</span><span class="nx">click</span><span class="p">(</span><span class="kd">function</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{});</span><span class="w"></span>

<span class="cm">/* chain */</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="nx">r</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">_</span><span class="p">.</span><span class="nx">chain</span><span class="p">([</span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="mf">4</span><span class="p">,</span><span class="w"> </span><span class="mf">9</span><span class="p">,</span><span class="w"> </span><span class="mf">16</span><span class="p">,</span><span class="w"> </span><span class="mf">25</span><span class="p">])</span><span class="w"></span>
<span class="w">   </span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">sqrt</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nx">x</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">x</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="mf">2</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="mf">1</span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="p">.</span><span class="nx">value</span><span class="p">();</span><span class="w"></span>
</code></pre></div>





                
              </article>
            </div>
          
          
        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </a>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Footer" >
      
        
        <a href="../js-mindmap/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Mindmap" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Mindmap
            </div>
          </div>
        </a>
      
      
        
        <a href="../jQuery-note/" class="md-footer__link md-footer__link--next" aria-label="Next: jQuery" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              jQuery
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2021-2022 Easonshi
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
      
      
    
    <a href="https://github.com/Lightblues" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"/></svg>
    </a>
  
    
    
      
      
    
    <a href="https://lightblues.github.io/" target="_blank" rel="noopener" title="lightblues.github.io" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M575.8 255.5c0 18-15 32.1-32 32.1h-32l.7 160.2c0 2.7-.2 5.4-.5 8.1V472c0 22.1-17.9 40-40 40h-16c-1.1 0-2.2 0-3.3-.1-1.4.1-2.8.1-4.2.1H392c-22.1 0-40-17.9-40-40v-88c0-17.7-14.3-32-32-32h-64c-17.7 0-32 14.3-32 32v88c0 22.1-17.9 40-40 40h-55.9c-1.5 0-3-.1-4.5-.2-1.2.1-2.4.2-3.6.2h-16c-22.1 0-40-17.9-40-40V360c0-.9 0-1.9.1-2.8v-69.6H32c-18 0-32-14-32-32.1 0-9 3-17 10-24L266.4 8c7-7 15-8 22-8s15 2 21 7l255.4 224.5c8 7 12 15 11 24z"/></svg>
    </a>
  
    
    
    <a href="mailto:oldcitystal@gmail.com" target="_blank" rel="noopener" title="" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M0 128c0-35.35 28.65-64 64-64h384c35.3 0 64 28.65 64 64v256c0 35.3-28.7 64-64 64H64c-35.35 0-64-28.7-64-64V128zm48 0v22.1l172.5 141.6c20.6 17 50.4 17 71 0L464 150.1v-23c0-7.9-7.2-16-16-16H64c-8.84 0-16 8.1-16 16v.9zm0 84.2V384c0 8.8 7.16 16 16 16h384c8.8 0 16-7.2 16-16V212.2L322 328.8c-38.4 31.5-93.6 31.5-132.9 0L48 212.2z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.tabs", "navigation.sections", "navigation.top"], "search": "../../../assets/javascripts/workers/search.5bf1dace.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.078830c0.min.js"></script>
      
        <script src="../../../js/baidu-tongji.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script>
      
    
  </body>
</html>